var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){"use strict";function n(e,n){var r=t.extend(!0,{},e,n);return delete r.constructor,r}var t=jQuery;e.extendWidgetOptions=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){"use strict";var t=jQuery,n=function(n){function r(){n.apply(this,arguments),this._dataOffset=0,this._scrollingState={x:null,y:null,index:0},this._windowResizeTimer=0}return __extends(r,n),r.prototype._createWidget=function(t,r){var i=t&&e.data.util.isClassInstance(t.data)&&!(typeof wijdatasource=="function"&&t.data instanceof wijdatasource)&&t.data;i&&delete t.data,n.prototype._createWidget.apply(this,arguments),i&&this.option("data",i)},r.prototype._create=function(){var n=this;if(!this.element.is("table"))throw"invalid markup";this._windowResizeTimer=0,this._dataOffset=0,this._scrollingState={x:null,y:null,index:0},this._initialized=!1,this._destroyed=!1,this._rendered=!1,this._eventUID=undefined,this._dataViewWrapper=undefined,this._originalHtml=undefined,this._originalAttr=undefined,this._originalCssText=undefined,this._autoHeight=undefined,this._autoWidth=undefined,this._renderCounter=0,this.$superPanelHeader=undefined,this.$topPagerDiv=undefined,this.$bottomPagerDiv=undefined,this.$groupArea=undefined,this.__uid=undefined,this._wijDataView=undefined,this.outerDiv=undefined,this.sketchTable=undefined,this.cellFormatter=undefined,this.rowStyleFormatter=undefined,this.cellStyleFormatter=undefined,this._eventUID=e.grid.getUID(),this._spinnerIsActivated=!1,this.options=t.extend(!0,{},this.options),window.wijmoApplyWijTouchUtilEvents&&(t=window.wijmoApplyWijTouchUtilEvents(t)),t.isFunction(window.wijmoASPNetParseOptions)&&window.wijmoASPNetParseOptions(this.options),this._initialized=!1,this._destroyed=!1;var r=this.element[0].style.height,i=this.element[0].style.width;this._dataViewWrapper=new e.grid.dataViewWrapper(this),this._originalHtml=this.element.html(),this._originalAttr={},this._originalCssText=this.element[0].style.cssText,this.element.addClass("wijmo-wijgrid-root"),this.element.wrap('<div class="'+this.options.wijCSS.widget+" wijmo-wijgrid "+this.options.wijCSS.content+" "+this.options.wijCSS.cornerAll+'"></div>'),this.outerDiv=this.element.parent(),r&&this.outerDiv.css("height",this.element[0].style.height),r!==""&&r!=="auto"?this._autoHeight=!1:this._autoHeight=!0,i&&this.outerDiv.css("width",this.element[0].style.width),i!==""&&i!=="auto"?this._autoWidth=!1:this._autoWidth=!0,this.element.css({height:"",width:""}),this.options.disabled&&this.disable(),this.cellFormatter=new e.grid.cellFormatterHelper,this.rowStyleFormatter=new e.grid.rowStyleFormatterHelper(this),this.cellStyleFormatter=new e.grid.cellStyleFormatterHelper(this),this._field("viewRenderBounds",{start:0,end:0}),this._allowVirtualScrolling()&&(this._field("viewRenderBounds").start=this._scrollingState.index,this._serverSideVirtualScrolling()&&(this._dataOffset=this._scrollingState.index)),this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(){n._initialized&&!n._destroyed&&n.setSize()},"wijgrid"),this._renderCounter=0},r.prototype._destroy=function(){var n,r=this;try{this._view().dispose(),this._detachEvents(!0),(n=this._field("resizer"))&&n.dispose(),(n=this._field("frozener"))&&n.dispose(),(n=this._field("selectionui"))&&n.dispose(),(n=this._field("dragndrop"))&&n.dispose(),this._dataViewWrapper.dispose(),e.grid.remove$dataByPrefix(this.element,this._data$prefix),this.element.wijRemoveVisibilityObserver&&this.element.wijRemoveVisibilityObserver(),this.element.insertBefore(this.outerDiv),this.outerDiv.remove(),this.element.html(this._originalHtml),t.each(this._originalAttr,function(e,t){t===undefined?r.element.removeAttr(e):r.element.attr(e,t)}),this.element.removeClass("wijmo-wijgrid-root"),this.element[0].style.cssText=this._originalCssText}finally{this._destroyed=!0}},r.prototype._init=function(){this.$superPanelHeader=null,this.$topPagerDiv=null,this.$bottomPagerDiv=null,this.$groupArea=null,this._field("closestCulture",Globalize.findClosestCulture(this.options.culture)||Globalize.findClosestCulture("default")),this.options.data||(this._field("thead")||this._field("thead",e.grid.readTableSection(this.element,1)),this._field("tfoot")||this._field("tfoot",e.grid.readTableSection(this.element,3))),this._initialized=this._initialized||!1,this.ensureControl(!0)},r.prototype._setOption=function(e,t){var r=this["_preset_"+e],i=this.options[e],s,o;r!==undefined&&(t=r.apply(this,[t,i])),s=t!==i,n.prototype._setOption.apply(this,[e,t]),s&&(o=this["_postset_"+e],o!==undefined&&o.apply(this,[t,i]))},r.prototype.columns=function(){return this._field("columns")||[]},r.prototype.currentCell=function(t,n){var r,i=this._view(),s=this._rows();if(arguments.length===0)return r=this._field("currentCell"),r||this._field("currentCell",r=e.grid.cellInfo.outsideValue),r;r=arguments.length===1?t._clone():new e.grid.cellInfo(t,n);if(!r.isEqual(e.grid.cellInfo.outsideValue)){if(!r._isValid())throw"invalid arguments";r._clip(this._getDataCellsRange());if(r.rowIndex()>=0&&!(i._getRowInfo(s.item(r.rowIndex())).type&e.grid.rowType.data))return}return r._setGridView(this),this._changeCurrentCell(null,r),this._field("currentCell")},r.prototype.data=function(){return this._dataViewWrapper.dataView().getSource()},r.prototype.dataView=function(){return this._dataViewWrapper.dataView()},r.prototype.doRefresh=function(n){t.isPlainObject(n)||(n={});var r,i=this,s=e.grid.EXPANDO,o=n&&n.virtualScrollData;if(!this._initialized)try{this._prepareColumnOptions(!0,!0)}catch(u){throw u}finally{this._ownerise(!0),this._initialized=!0}if(!o){this._rebuildLeaves();var a=this._dataViewWrapper.data(),f=this._dataViewWrapper.dataView();t.each(this._field("leaves"),function(){this._totalsValue=a.totals?a.totals[this.dataKey]:undefined}),this.sketchTable=[],a.data&&a.data.length?(r=this._field("leaves"),t.each(a.data,function(e,t){i.sketchTable.push(i._buildSketchRow(t,r))})):a.emptyData&&(r=this._field("visibleLeaves"),t.each(a.emptyData,function(e,t){i.sketchTable.push(i._buildSketchRowEmptyDataItem(t,r,e===a.emptyData.length-1))}))}this._onRendering(n),o?this._refreshVirtual(n):this._refresh(n),this._onRendered(n),n&&t.isFunction(n.afterRefresh)&&n.afterRefresh.apply(this,[n])},r.prototype.beginEdit=function(){return this._beginEditInternal(null)},r.prototype.endEdit=function(){return this._endEditInternal(null)},r.prototype.ensureControl=function(n,r){this._loading(),t.isPlainObject(r)||(r={data:null,afterRefresh:null,beforeRefresh:null}),r._wijgridMarker=!0,this._initialized?this._convertWidgetsToOptions():(this._prepareColumnOptions(this._dataViewWrapper.isDataLoaded(),!1),this._dataViewWrapper.isOwnDataView()||(new e.grid.settingsManager(this)).MapDVToWG()),this._ownerise(!0),this._initialized&&r&&t.isFunction(r.beforeRefresh)&&r.beforeRefresh.apply(this),this._field("allowVirtualScrolling",null),n===!0?this._dataViewWrapper.load(r):(this.doRefresh(r),this._loaded())},r.prototype.getCellInfo=function(e){var t=null;return e&&(e=this._findUntilOuterDiv(e,{td:!0,th:!0}))&&(t=this._view().getAbsoluteCellInfo(e)),t},r.prototype.getFilterOperatorsByDataType=function(t){return(new e.grid.filterOperatorsCache(this)).getByDataType(t||"string")},r.prototype.pageCount=function(){return this._customPagingEnabled()?Math.ceil(this.options.totalRows/this.options.pageSize)||1:this.options.allowPaging?this._dataViewWrapper.dataView().pageCount():1},r.prototype._serverShaping=function(){return!1},r.prototype._pageIndexForDataView=function(){return this.options.pageIndex},r.prototype.setSize=function(e,n){var r=this._view(),i={type:"",hScrollValue:null,vScrollValue:null},s=this.outerDiv,o=this._field("frozener"),u=this._field("visibleLeaves"),a=[];r&&r.getScrollValue&&(i=r.getScrollValue());if(e||e===0)this._autoWidth=!1,s.width(e);if(n||n===0)this._autoHeight=!1,s.height(n);t.each(u,function(e,n){var i=r.getHeaderCell(e),s=r.getJoinedCols(e);t(i).css("width",""),t.each(s,function(e,n){t(n).css("width","")})}),this._view().updateSplits(i),o&&o.refresh()},r.prototype.selection=function(){var t=this._field("selection");return t||this._field("selection",t=new e.grid.selection(this)),t},r.prototype._onDataViewCurrentPositionChanged=function(t,n){var r=this._dataViewWrapper.currentPosition(),i=new e.grid.cellInfo(this.currentCell().cellIndex(),this._dataViewDataRowIndexToGrid(r),null),s=this.selection();i.rowIndex()<0?i.cellIndex(-1):i.cellIndex()<0&&i.cellIndex(0),i=this.currentCell(i),s.beginUpdate(),s.clear(),i&&i._isValid()&&s._selectRange(new e.grid.cellInfoRange(i,i),!1,!1,0,null),s.endUpdate()},r.prototype._resetDataProperties=function(){this.options.pageIndex=0;var e=this._field("viewRenderBounds");e.start=e.end=0},r.prototype._onDataViewLoading=function(){this._activateSpinner(),this._trigger("dataLoading")},r.prototype._onDataViewReset=function(t){(new e.grid.settingsManager(this)).MapDVToWG(),this._trigger("dataLoaded"),this.doRefresh(t),this._loaded()},r.prototype._onDataViewLoaded=function(){},r.prototype._loading=function(){this._activateSpinner(),this._trigger("loading")},r.prototype._loaded=function(){this._deactivateSpinner(),this._trigger("loaded")},r.prototype._buildSketchRow=function(t,n){var r,i,s,o,u,a,f=[],l=e.data.Expando.getFrom(t.values,!1),c=l?l[e.grid.EXPANDO]:null;for(r=0,i=n.length;r<i;r++)s=n[r],e.grid.validDataKey(s.dataKey)&&(o=c&&c.cellsAttributes?c.cellsAttributes[s.dataKey]:{},u=this._dataViewWrapper.getValue(t.values,s.dataKey),f.push({value:this._parse(s,u),__attr:o||{},__style:{}}));return f.originalRowIndex=t.originalRowIndex,f.rowType=e.grid.rowType.data,t.originalRowIndex%2!==0&&(f.rowType|=e.grid.rowType.dataAlt),f.__style={},f.__attr=c&&c.rowAttributes?c.rowAttributes:{},f},r.prototype._buildSketchRowEmptyDataItem=function(t,n,r){var i,s,o=[],u=n.length;for(i=0,s=t.length;i<s;i++)o.push({html:t[i],__attr:{colSpan:u>0&&r?u:1},__style:{}});return o.rowType=e.grid.rowType.emptyDataRow,o.__style={},o.__attr={},o},r.prototype._prepareColumnOptions=function(n,r){e.grid.traverse(this.options.columns,function(e){e.isBand=t.isArray(e.columns)||e.clientType==="c1band",e._originalDataKey=e.dataKey,e._originalHeaderText=e.headerText}),(new e.grid.bandProcessor).getVisibleHeight(this.options.columns,!0);var i=[],s=this._originalHeaderRowData(),o=this._originalFooterRowData(),u=(this.options.columnsAutogenerationMode||"").toLowerCase();n&&e.grid.columnsGenerator.generate(u,this._dataViewWrapper.getFieldsInfo(),this.options.columns),e.grid.setTraverseIndex(this.options.columns),e.grid.traverse(this.options.columns,function(n){n.isBand=t.isArray(n.columns)||n.clientType==="c1band",e.grid.shallowMerge(n,e.c1basefield.prototype.options),n.isBand?n.clientType="c1band":(e.grid.shallowMerge(n,e.c1field.prototype.options),n.groupInfo=n.groupInfo||{},e.grid.shallowMerge(n.groupInfo,e.c1field.prototype.options.groupInfo),n.clientType||(n.clientType="c1field")),n.isLeaf&&!n.isBand&&i.push(n)}),this._field("leaves",i),n&&t.each(i,t.proxy(function(n,r){var i=typeof r.dataKey=="number"?r.dataKey:n;(u==="merge"||r.dynamic===!0)&&r.headerText===undefined&&(this._dataViewWrapper.isBoundedToDOM()&&s&&i<s.length?r.headerText=t.trim(s[i]):e.grid.validDataKey(r.dataKey)&&(r.headerText=""+r.dataKey)),this._dataViewWrapper.isBoundedToDOM()&&o&&i<o.length&&(r._footerTextDOM=t.trim(o[i]))},this))},r.prototype._rebuildLeaves=function(){var n=[],r=[],i;this.options.showRowHeader&&(i=e.grid.createDynamicField({clientType:"c1basefield",dataIndex:-1,travIdx:-1,parentVis:!0,allowMoving:!1,allowSizing:!1,allowSort:!1,isRowHeader:!0}),i.owner=this,n.push(i)),t.each(this.options.columns,function(e,t){n.push(t)}),this._columnsHeadersTable((new e.grid.bandProcessor).generateSpanTable(n,r)),this._field("leaves",r),this._onLeavesCreated()},r.prototype._onLeavesCreated=function(){var n=this._field("leaves"),r=this._dataViewWrapper.getFieldsInfo(),i,s=0,o=0,u=this;this._field("visibleLeaves",t.grep(n,function(n,u){return n.leavesIdx=u,e.grid.validDataKey(n.dataKey)?n.dataIndex=s++:n.dataIndex=-1,n.isBand||(i=r[n.dataKey],i&&(n._underlyingDataType=i.type,n._underlyingDataFormatString=i.format),t.isFunction(n.dataParser)&&(n.dataParser=new n.dataParser)),n.parentVis?(n.visLeavesIdx=o++,!0):!1}))},r.prototype._allowVirtualScrolling=function(){var e=this._field("allowVirtualScrolling");return e||(e=this._field("allowVirtualScrolling",!this.options.allowPaging&&this.options.allowVirtualScrolling&&this.options.staticRowIndex<0&&this.options.scrollMode!=="none"&&!this._hasMerging())),e},r.prototype._dragndrop=function(t){typeof t=="undefined"&&(t=!1);var n=this._field("dragndrop");return!n&&t&&this._field("dragndrop",n=new e.grid.uiDragndrop(this)),n},r.prototype._headerRows=function(){return this._view().headerRows()},r.prototype._filterRow=function(){return this._view().filterRow()},r.prototype._rows=function(){return this._view().bodyRows()},r.prototype._localizeFilterOperators=function(n){var r=this,i=new e.grid.filterOperatorsCache(this);t.each(n,function(e,t){if(t.name){var n=i.getByName(t.name);n&&(n.displayName=t.displayName)}})},r.prototype._selectionui=function(t){var n=this._field("selectionui");return!n&&t&&this._field("selectionui",n=new e.grid.uiSelection(this)),n},r.prototype._postset_allowColMoving=function(e,n){var r=this;t.each(this.columns(),function(t,n){e?r._dragndrop(!0).attach(n):r._dragndrop(!0).detach(n)}),t.each(this._field("groupedWidgets"),function(t,n){e?r._dragndrop(!0).attach(n):r._dragndrop(!0).detach(n)})},r.prototype._postset_allowSorting=function(e,t){this.ensureControl(!1)},r.prototype._postset_columns=function(e,t){this._initialized=!1,this.ensureControl(!0)},r.prototype._postset_allowPaging=function(e,t){this.ensureControl(!0)},r.prototype._postset_culture=function(e,t){throw"read-only"},r.prototype._postset_customFilterOperators=function(e,t){var n=this._dataViewWrapper.dataView()},r.prototype._postset_data=function(n,r){this._ownerise(!1),e.grid.traverse(this.options.columns,function(e,n){if(e.dynamic){var r=t.inArray(e,n);r>=0&&n.splice(r,1)}else e.dataKey=e._originalDataKey,e.headerText=e._originalHeaderText}),this._initialized=!1,this._dataViewWrapper&&this._dataViewWrapper.dispose(),this._dataViewWrapper=new e.grid.dataViewWrapper(this),this.ensureControl(!0)},r.prototype._postset_disabled=function(t,n){var r=this,i=this._view();e.grid.iterateChildrenWidgets(this.outerDiv,function(e,n){n!==r&&n.option("disabled",t)}),i&&i.ensureDisabledState()},r.prototype._postset_groupIndent=function(e,t){this.ensureControl(!1)},r.prototype._postset_groupAreaCaption=function(e,t){var n=this._field("groupedColumns");this.$groupArea&&(!n||!n.length)&&this.$groupArea.html(e||"&nbsp;")},r.prototype._postset_highlightCurrentCell=function(e,t){var n=this.currentCell();n&&n._isValid()&&this._highlightCellPosition(n,e)},r.prototype._preset_pageIndex=function(e,t){if(isNaN(e))throw"out of range";var n=this.pageCount(),r=function(e){return e>n-1&&(e=n-1),e<0&&(e=0),e},i;return e=r(e),this.options.allowPaging&&e!==t&&(i={newPageIndex:e},this._onPageIndexChanging(i)?e=r(i.newPageIndex):e=t),e},r.prototype._postset_pageIndex=function(e,t){if(this.options.allowPaging){var n={newPageIndex:e};this._customPagingEnabled()?(this._convertWidgetsToOptions(),this._onPageIndexChanged(n)):this.ensureControl(!0,{afterRefresh:function(){this._onPageIndexChanged(n)}})}},r.prototype._preset_pageSize=function(e,t){if(isNaN(e))throw"out of range";return e<=0&&(e=1),e},r.prototype._postset_pageSize=function(e,t){this._resetDataProperties(),this.options.allowPaging&&!this._customPagingEnabled()&&this.ensureControl(!0)},r.prototype._postset_pagerSettings=function(e,t){this.ensureControl(!1)},r.prototype._postset_scrollMode=function(e,t){this.ensureControl(!1)},r.prototype._postset_selectionMode=function(t,n){var r=this.selection(),i=this.currentCell(),s=this.selection().selectedCells().length();r.beginUpdate(),r.clear(),i&&i._isValid()&&s&&r._selectRange(new e.grid.cellInfoRange(i,i),!1,!1,0,null),r.endUpdate(),this._view().toggleDOMSelection(t==="none")},r.prototype._postset_showFilter=function(e,t){this.ensureControl(!1)},r.prototype._postset_showGroupArea=function(e,t){this.ensureControl(!1)},r.prototype._postset_showRowHeader=function(e,t){this.ensureControl(!1)},r.prototype._postset_staticRowIndex=function(){this.options.scrollMode!=="none"&&this.ensureControl(!1)},r.prototype._postset_staticColumnIndex=function(){this.options.scrollMode!=="none"&&this.ensureControl(!1)},r.prototype._postset_allowVirtualScrolling=function(e,t){this.ensureControl(!1)},r.prototype._preset_allowVirtualScrolling=function(e,t){if(isNaN(e)||e<0)throw"out of range";return e},r.prototype._activateSpinner=function(){if(!this._spinnerIsActivated){var e=this.options.wijCSS,t=this.outerDiv.append('<div class="wijmo-wijgrid-overlay '+e.overlay+'"></div>'+'<span class="wijmo-wijgrid-loadingtext '+e.content+" "+e.cornerAll+'">'+'<span class="'+e.icon+' ui-icon-clock"></span>'+this.options.loadingText+"</span>").find("> .wijmo-wijgrid-loadingtext");t.position({my:"center",at:"center center",of:this.outerDiv,collision:"none"}),this._spinnerIsActivated=!0}},r.prototype._customPagingEnabled=function(){return this.options.allowPaging&&this.options.totalRows>=0},r.prototype._deactivateSpinner=function(){if(this._spinnerIsActivated)try{this.outerDiv.find("> .wijmo-wijgrid-overlay, > .wijmo-wijgrid-loadingtext").remove()}finally{this._spinnerIsActivated=!1}},r.prototype._columnWidgetsFactory=function(e,n){var r,i=n.clientType;!i&&n.isBand&&(i="c1band"),n=t.extend({},n,{disabled:this.options.disabled});try{t.data(e[0],"wijgridowner",this);switch(i){case"c1basefield":r=e.c1basefield(n);break;case"c1band":r=e.c1band(n);break;default:r=e.c1field(n)}}finally{t.removeData(e[0],"wijgridowner")}return r},r.prototype._convertWidgetsToOptions=function(){this._initialized&&this._mergeWidgetsWithOptions&&(this._ownerise(!1),this._widgetsToOptions(),this._ownerise(!0))},r.prototype._field=function(t,n){return e.grid.dataPrefix(this.element,this._data$prefix,t,n)},r.prototype._removeField=function(e){var t=this._data$prefix+e;this.element.removeData(t)},r.prototype._prepareTotalsRequest=function(n){var r=this._field("leaves"),i,s;return!r||!this.options.showFooter?[]:(i=t.map(r,function(t,r){return!t.isBand&&e.grid.validDataKey(t.dataKey)&&t.aggregate&&t.aggregate!=="none"?n?[{column:t,aggregate:t.aggregate}]:[{dataKey:t.dataKey,aggregate:t.aggregate}]:null}),i)},r.prototype._widgetsToOptions=function(){var n=e.grid.flatten(this.options.columns);t.each(this.columns(),function(e,r){delete r.options.columns;var i=n[r.options.travIdx];t.extend(!0,i,r.options),i.filterValue=r.options.filterValue,i.filterOperator=r.options.filterOperator})},r.prototype._recreateColumnWidgets=function(){t.each(this.columns(),function(e,t){t.destroy()});var n=[],r=this._headerRows(),i,s,o,u,a,f,l;if(r&&r.length()){i=[],e.grid.traverse(this.options.columns,function(e){e.parentVis&&i.push(e)});for(s=0,o=i.length;s<o;s++)u=i[s],a=r.item(u.thY),f=e.grid.rowAccessor.getCell(a,u.thX),l=this._columnWidgetsFactory(t(f),u),n.push(l.data(e.grid.widgetName(l)))}this._field("columns",n)},r.prototype._ownerise=function(t){if(t){var n=this;e.grid.traverse(this.options.columns,function(e){e.owner=n;var t,r,i;if(t=e.groupInfo){t.owner=e;if(t.expandInfo)for(r=0,i=t.expandInfo.length;r<i;r++)t.expandInfo[r].owner=t}})}else e.grid.traverse(this.options.columns,function(e){delete e.owner;var t,n,r;if(t=e.groupInfo){delete t.owner;if(t.expandInfo)for(n=0,r=t.expandInfo.length;n<r;n++)delete t.expandInfo[n].owner}})},r.prototype._ensureRenderBounds=function(e){var t=this._totalRowsCount();return e.start<0&&(e.start=0),e.start=Math.min(e.start,t-1),e.end<0&&(e.end=0),e.end=Math.min(e.end,t-1),e},r.prototype._refresh=function(t){(new e.grid.grouper).group(this,this.sketchTable,this._field("leaves")),(new e.grid.merger).merge(this.sketchTable,this._field("visibleLeaves"));var n=this._field("viewRenderBounds");this._ensureRenderBounds(n),this.options.scrollMode!=="none"?this._field("view",new e.grid.fixedView(this,this._field("viewRenderBounds"))):this._field("view",new e.grid.flatView(this,this._field("viewRenderBounds"))),this._render(),this._ownerise(!1),this._recreateColumnWidgets(),this._ownerise(!0),this.options.allowPaging&&(this.$topPagerDiv&&this.$topPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5),this.$bottomPagerDiv&&this.$bottomPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5))},r.prototype._refreshVirtual=function(e){var t=e.virtualScrollData,n={top:0,bottom:0};t.data&&(n=this._processVirtualData(t)),this._updateRowInfos(t,n),this._renderVirtualIntoView(t)},r.prototype._updateRowInfos=function(e,t){var n=this._field("viewRenderBounds"),r=this._view(),i=e.newBounds,s=this._view().bodyRows(),o,u,a,f;switch(e.mode){case"reset":break;case"overlapBottom":o={start:i.start-n.start,end:n.end-n.start},a=i.start-n.start;for(u=o.start;u<=o.end;u++)f=r._getRowInfo(s.item(u)),f.sectionRowIndex-=a,f.dataItemIndex+=t.top,r._setRowInfo(f.$rows,f);break;case"overlapTop":o={start:n.start-n.start,end:i.end-n.start},a=n.start-i.start;for(u=o.start;u<=o.end;u++)f=r._getRowInfo(s.item(u)),f.sectionRowIndex+=a,f.dataItemIndex+=t.top,r._setRowInfo(f.$rows,f)}},r.prototype._renderVirtualIntoView=function(t){var n=this._field("viewRenderBounds"),r=this._view(),i=function(t){return t.rowType&e.grid.rowType.data?t.originalRowIndex:-1},s,o,u,a;switch(t.mode){case"reset":r._clearBody();for(o=t.newBounds.start;o<=t.newBounds.end;o++)u=this.sketchTable[o-this._dataOffset],r._insertBodyRow(u,-1,i(u),o);r._rebuildOffsets();break;case"overlapBottom":s={start:t.newBounds.start,end:n.end};for(o=0;o<s.start-n.start;o++)r._removeBodyRow(0,!1);for(o=s.end+1;o<=t.newBounds.end;o++)u=this.sketchTable[o-this._dataOffset],r._insertBodyRow(u,-1,i(u),o);break;case"overlapTop":s={start:n.start,end:t.newBounds.end};for(o=0;o<n.end-t.newBounds.end;o++)r._removeBodyRow(s.end-s.start+1,!1);a=0;for(o=t.newBounds.start;o<n.start;o++)u=this.sketchTable[o-this._dataOffset],r._insertBodyRow(u,a++,i(u),o);break;default:}},r.prototype._processVirtualData=function(e){var t=this._dataViewWrapper,n=t.dataView().getSource(),r,i=this._field("leaves"),s,o,u,a=0,f={top:0,bottom:0},l,c=this._serverSideVirtualScrollingMargin();switch(e.mode){case"reset":this.sketchTable.splice(0,this.sketchTable.length),t._unsafeSplice(0,n.length),this._dataOffset=e.request.index;for(s=0;s<e.data.length;s++)t._unsafePush(r=e.data[s]),this.sketchTable.push(this._buildSketchRow(t._wrapDataItem(r,s),i));break;case"overlapBottom":for(s=0;s<e.data.length;s++)t._unsafePush(r=e.data[s]),this.sketchTable.push(this._buildSketchRow(t._wrapDataItem(r,n.length-1),i));f.bottom=e.data.length;break;case"overlapTop":for(s=e.data.length-1;s>=0;s--)t._unsafeSplice(0,0,r=e.data[s]),this.sketchTable.splice(0,0,this._buildSketchRow(t._wrapDataItem(r,s),i));this._dataOffset=e.request.index,f.top=e.data.length}o=this._ensureRenderBounds({start:e.newBounds.start,end:e.newBounds.end}),u={start:this._dataOffset,end:this._dataOffset+n.length-1},a=u.end-o.end-c,a>0&&(f.bottom-=a,t._unsafeSplice(n.length-a,a),this.sketchTable.splice(this.sketchTable.length-a,a)),a=o.start-u.start-c,a>0&&(f.top-=a,t._unsafeSplice(0,a),this.sketchTable.splice(0,a),this._dataOffset+=a);for(s=0;s<this.sketchTable.length;s++)this.sketchTable[s].originalRowIndex=s;return t._refreshSilent(),f},r.prototype._needToCreatePagerItem=function(){return this.options.allowPaging===!0},r.prototype._render=function(){var e=this._view(),n=this.options,r=this.options.wijCSS,i;e.render(),i=this.outerDiv,n.scrollMode!=="none"&&(i=this.outerDiv.find("div.wijmo-wijgrid-scroller:first")),this.$superPanelHeader=null,this.$topPagerDiv&&(this.$topPagerDiv.data("wijmo-wijpager")&&this.$topPagerDiv.wijpager("destroy"),this.$topPagerDiv.remove()),this.$topPagerDiv=null,this._needToCreatePagerItem()&&(n.pagerSettings.position==="top"||n.pagerSettings.position==="topAndBottom")&&(this.$topPagerDiv||(i.prepend(this.$superPanelHeader=t('<div class="wijmo-wijsuperpanel-header"></div>')),this.$superPanelHeader.prepend(this.$topPagerDiv=t('<div class="wijmo-wijgrid-header '+r.header+" "+r.cornerTop+'"></div>')))),n.showGroupArea?this._processGroupArea(i):this.$groupArea=null,this.$bottomPagerDiv&&(this.$bottomPagerDiv.data("wijmo-wijpager")&&this.$bottomPagerDiv.wijpager("destroy"),this.$bottomPagerDiv.remove()),this.$bottomPagerDiv=null,this._needToCreatePagerItem()&&(n.pagerSettings.position==="bottom"||n.pagerSettings.position==="topAndBottom")&&(this.$bottomPagerDiv||i.append(this.$bottomPagerDiv=t('<div class="wijmo-wijgrid-footer wijmo-wijsuperpanel-footer '+r.stateDefault+" "+r.cornerBottom+'"></div>')))},r.prototype._processGroupArea=function(e){var n=this,r=this._field("groupedColumns"),i=[];this.$groupArea=t('<div class="'+this.options.wijCSS.content+" "+this.options.wijCSS.helperClearFix+'"></div>'),r.length>0?t.each(r,function(e,r){var s=t('<a href="#"></a>').appendTo(n.$groupArea);try{t.data(s[0],"wijgridowner",n),s.c1groupedfield(t.extend({},{allowMoving:r.allowMoving,allowSort:r.allowSort,dataIndex:r.dataIndex,headerText:r.headerText,isBand:r.isBand,isLeaf:r.isLeaf,linearIdx:r.linearIdx,parentIdx:r.parentIdx,sortDirection:r.sortDirection,travIdx:r.travIdx,groupedIndex:r.groupedIndex},{disabled:n.options.disabled}))}finally{t.removeData(s[0],"wijgridowner")}i.push(s.data("wijmo-c1groupedfield"))}):this.$groupArea.addClass("wijmo-wijgrid-group-area").css("padding",0).html(this.options.groupAreaCaption||"&nbsp;"),this._field("groupedWidgets",i),this.$superPanelHeader||e.prepend(this.$superPanelHeader=t('<div class="wijmo-wijsuperpanel-header"></div>')),this.$superPanelHeader.prepend(this.$groupArea),this._dragndrop(!0).attachGroupArea(this.$groupArea)},r.prototype._attachEvents=function(){var e=this._view(),n=e.focusableElement(),r=this;n.bind("keydown."+this.widgetName,t.proxy(this._onKeyDown,this)),n.bind("keypress."+this.widgetName,t.proxy(this._onKeyPress,this)),t.each(e.subTables(),function(e,n){var i=n.element();i&&(i.tHead&&t(i.tHead).bind("click."+r.widgetName,t.proxy(r._onClick,r)),i.tBodies.length&&t(i.tBodies[0]).bind("click."+r.widgetName,t.proxy(r._onClick,r)).bind("dblclick."+r.widgetName,t.proxy(r._onDblClick,r)).bind("mousemove."+r.widgetName,t.proxy(r._onMouseMove,r)).bind("mouseout."+r.widgetName,t.proxy(r._onMouseOut,r)))}),t(window).bind("resize."+this.widgetName+"."+this._eventUID,t.proxy(this._onWindowResize,this))},r.prototype._detachEvents=function(e){var n=this._view(),r=this,i;this._windowResizeTimer=0,t(window).unbind("resize."+this.widgetName+"."+this._eventUID),n&&(i=n.focusableElement(),i.unbind("keydown."+this.widgetName),i.unbind("keypress."+this.widgetName),t.each(n.subTables(),function(){var e=this.element();e&&(e.tHead&&t(e.tHead).unbind("."+r.widgetName),e.tBodies.length&&t(e.tBodies[0]).unbind("."+r.widgetName))}))},r.prototype._handleSort=function(n,r){var i=this.options.columns,s=n.travIdx,o,u;n&&this.options.allowSorting&&(o=n.sortDirection==="none"?"ascending":n.sortDirection==="ascending"?"descending":"ascending",u={column:n,sortDirection:o,sortCommand:n.dataKey+" "+(o==="ascending"?"asc":"desc")},this._onColumnSorting(u)&&(n.sortDirection=u.sortDirection,r?n.sortOrder=this._customSortOrder++:(this._customSortOrder=1e3,t.each(this.columns(),function(e,t){t.options.sortOrder=0,t.options.travIdx!==s&&(!t.options.groupInfo||t.options.groupInfo.position==="none")&&(t.options.sortDirection="none")}),e.grid.traverse(i,function(e){e.sortOrder=0,e.travIdx!==s&&(!e.groupInfo||e.groupInfo.position==="none")&&(e.sortDirection="none")})),u={column:n,sortDirection:n.sortDirection,sortCommand:n.dataKey+" "+(n.sortDirection==="ascending"?"asc":"desc")},this._customPagingEnabled()?(this._convertWidgetsToOptions(),this._onColumnSorted(u)):this.ensureControl(!0,{afterRefresh:function(){this._onColumnSorted(u)}})))},r.prototype._pagerSettings2PagerWidgetSettings=function(){return t.extend({},this.options.pagerSettings,{disabled:this.options.disabled,pageCount:this.pageCount(),pageIndex:this.options.pageIndex,pageIndexChanging:t.proxy(this._onPagerWidgetPageIndexChanging,this),pageIndexChanged:t.proxy(this._onPagerWidgetPageIndexChanged,this)})},r.prototype._handleDragnDrop=function(n,r,i,s,o){var u=e.grid.getColumnByTravIdx(this.options.columns,n),a=e.grid.getColumnByTravIdx(this.options.columns,r),f=s?"groupArea":"columns",l=o?"groupArea":"columns";o?this._onColumnGrouping({drag:u.found,drop:a?a.found:null,dragSource:f,dropSource:l,at:i})&&this.ensureControl(!0,{beforeRefresh:function(){if(!a)u.found.groupedIndex=0;else switch(i){case"left":u.found.groupedIndex=a.found.groupedIndex-.5;break;case"right":u.found.groupedIndex=a.found.groupedIndex+.5}s||t.extend(!0,u.found,{groupInfo:{position:"header"}})},afterRefresh:function(){this._onColumnGrouped({drag:u.found,drop:a?a.found:null,dragSource:f,dropSource:l,at:i})}}):this._onColumnDropping({drag:u.found,drop:a.found,at:i})&&this.ensureControl(!1,{beforeRefresh:function(){u.at.splice(u.found.linearIdx,1);switch(i){case"left":u.at===a.at&&u.found.linearIdx<a.found.linearIdx?a.at.splice(a.found.linearIdx-1,0,u.found):a.at.splice(a.found.linearIdx,0,u.found);break;case"right":u.at===a.at&&u.found.linearIdx<a.found.linearIdx?a.at.splice(a.found.linearIdx,0,u.found):a.at.splice(a.found.linearIdx+1,0,u.found);break;case"center":a.found.columns.push(u.found)}e.grid.setTraverseIndex(this.options.columns)},afterRefresh:function(){this._onColumnDropped({drag:u.found,drop:a.found,at:i})}})},r.prototype._handleFilter=function(t,n,r){var i=(new e.grid.filterOperatorsCache(this)).getByName(n),s,o,u;i&&(i.arity>1?(s=this._parse(t.options,r),o=s!==null&&(e.grid.getDataType(t.options)==="string"||!isNaN(s))):o=!0,o&&(u={column:t.options,operator:i.name,value:s},this._onColumnFiltering(u)&&(t.options.filterValue=u.value,t.options.filterOperator=u.operator,this._resetDataProperties(),this._customPagingEnabled()?(this._convertWidgetsToOptions(),this._onColumnFiltered({column:t.options})):this.ensureControl(!0,{afterRefresh:function(){this._onColumnFiltered({column:t.options})}}))))},r.prototype._handleUngroup=function(n){var r=e.grid.getColumnByTravIdx(this.options.columns,n),i;r&&r.found&&(i=r.found,this._onColumnUngrouping({column:i})&&this.ensureControl(!1,{beforeRefresh:function(){delete i.groupedIndex,t.extend(!0,i,{groupInfo:{position:"none"}})},afterRefresh:function(){this._onColumnUngrouped({column:i})}}))},r.prototype._onVirtualScrolling=function(e,n,r,i,s,o){this.ensureControl(!0,{virtualScrollData:{newBounds:e,request:n,mode:r,data:o},afterRefresh:function(e){var n=this._field("viewRenderBounds");t.extend(n,e.virtualScrollData.newBounds),this._view()._adjustRowsHeights(),s(i)}})},r.prototype._handleVirtualScrolling=function(e,t){var n=this._field("viewRenderBounds"),r=this._ensureRenderBounds({start:e,end:e+this.options.pageSize-1}),i=this._ensureRenderBounds({start:this._dataOffset,end:this._dataOffset+this._dataViewWrapper.dataView().count()-1}),s=null,o;r.start>n.end||r.end<n.start?o="reset":r.start>n.start?o="overlapBottom":r.start<n.start&&(o="overlapTop");if(this._serverSideVirtualScrolling())switch(o){case"reset":s={index:e,maxCount:this.options.pageSize};break;case"overlapBottom":r.end>i.end&&(s={index:i.end+1,maxCount:this.options.pageSize});break;case"overlapTop":r.start<i.start&&(s={index:Math.max(0,i.start-this.options.pageSize),maxCount:0},s.maxCount=i.start-s.index)}o!=="none"&&this._onVirtualScrolling(r,s,o,e,t)},r.prototype._serverSideVirtualScrolling=function(){return!1},r.prototype._serverSideVirtualScrollingMargin=function(){return this.options.pageSize*2},r.prototype._onColumnDropping=function(e){return this._trigger("columnDropping",null,e)},r.prototype._onColumnDropped=function(e){this._trigger("columnDropped",null,e)},r.prototype._onColumnGrouping=function(e){return this._trigger("columnGrouping",null,e)},r.prototype._onColumnGrouped=function(e){this._trigger("columnGrouped",null,e)},r.prototype._onColumnUngrouping=function(e){return this._trigger("columnUngrouping",null,e)},r.prototype._onColumnUngrouped=function(e){this._trigger("columnUngrouped",null,e)},r.prototype._onColumnFiltering=function(e){return this._trigger("filtering",null,e)},r.prototype._onColumnFiltered=function(e){this._trigger("filtered",null,e)},r.prototype._onFilterOperatorsListShowing=function(e){this._trigger("filterOperatorsListShowing",null,e)},r.prototype._onColumnSorting=function(e){return this._trigger("sorting",null,e)},r.prototype._onColumnSorted=function(e){this._trigger("sorted",null,e)},r.prototype._onCurrentCellChanged=function(t){var n=this.options,r=this._field("currentCell");this._dataViewWrapper.currentPosition(this._gridDataRowIndexToDataView(r.rowIndex())),n.scrollMode!=="none"&&r&&!r.isEqual(e.grid.cellInfo.outsideValue)&&this._view().scrollTo(r),this._trigger("currentCellChanged"),t&&(t.type||"").toLowerCase()==="click"&&this._editBySingleClick()&&this._beginEditInternal(t)},r.prototype._onPageIndexChanging=function(e){return this._trigger("pageIndexChanging",null,e)},r.prototype._onPageIndexChanged=function(e){this._trigger("pageIndexChanged",null,e)},r.prototype._onPagerWidgetPageIndexChanging=function(e,t){t.handled=!0},r.prototype._onPagerWidgetPageIndexChanged=function(e,t){this._setOption("pageIndex",t.newPageIndex)},r.prototype._onRendering=function(e){var t=this._view();this._rendered=!1,e.virtualScrollData?(this.selection().clear(),this.options.highlightCurrentCell&&this._highlightCellPosition(this.currentCell(),!1)):(t&&t.dispose(),this._detachEvents(!1),this.element.detach(),this.element.empty(),this.outerDiv.empty(),this.outerDiv.append(this.element),this._field("selectionui")&&(this._field("selectionui").dispose(),this._field("selectionui",null)),this._field("resizer")&&(this._field("resizer").dispose(),this._field("resizer",null)),this._field("frozener")&&(this._field("frozener").dispose(),this._field("frozener",null))),this._trigger("rendering")},r.prototype._onRendered=function(n){var r=this._view(),i,s,o=this.selection().selectedCells().length()>0;this._rendered=!0,this._setAttr(r.focusableElement(),"tabIndex",0),i=this.currentCell(),i._isValid()&&(i=this.currentCell(i))?i._isEdit(!1):i=this.currentCell(this._getFirstDataRowCell(0)),this._field("selection",null),i=this.currentCell(),i._isValid()&&(o||this.options.showSelectionOnRender)&&(this.selection()._startNewTransaction(i),this.selection()._selectRange(new e.grid.cellInfoRange(i,i),!1,!1,0,null)),n.virtualScrollData||(this._attachEvents(),this._selectionui(!0),s=new e.grid.uiResizer(this),t.each(this.columns(),function(e,t){var n=t.options;n.visible&&n.parentVis&&n.isLeaf&&s.addElement(t)}),this._field("resizer",s),r.updateSplits(this._scrollingState),this.options.scrollMode!=="none"&&this._field("frozener",new e.grid.uiFrozener(this))),this._renderCounter++,this._trigger("rendered")},r.prototype._onClick=function(n){if(!this._canInteract()||!n.target)return;var r=this._view(),i=this._findUntilOuterDiv(n.target,{td:!0,th:!0}),s,o,u=0,a,f;if(i){if(t(n.target).hasClass("wijmo-wijgrid-grouptogglebtn"))return this._onGroupBtnClick(n),n.stopPropagation(),!1;s=t(i).closest("tr");if(!s.length)return;o=r.getAbsoluteCellInfo(i);if(s.hasClass("wijmo-wijgrid-datarow")||s.hasClass("wijmo-wijgrid-headerrow")){if(o.cellIndex()<0||o.rowIndex()<0)o.rowIndex()>=0?(o=new e.grid.cellInfo(0,o.rowIndex()),u=2):(o=this._getFirstDataRowCell(o.cellIndex()),u=1);this._changeCurrentCell(n,o,!t(n.target).is(":focus")),a=this.currentCell(),f=this.selection(),(!n.shiftKey||!f._multipleRangesAllowed()&&this.options.selectionMode.toLowerCase()!=="singlerange")&&f._startNewTransaction(a),f.beginUpdate(),n.shiftKey&&n.ctrlKey?f._clearRange(new e.grid.cellInfoRange(a,a),u):f._selectRange(new e.grid.cellInfoRange(f._anchorCell(),a),n.ctrlKey,n.shiftKey,u,null),f.endUpdate()}var l={cell:o};this._trigger("cellClicked",null,l)}},r.prototype._onDblClick=function(e){this._editBySingleClick()||this._beginEditInternal(e)},r.prototype._onGroupBtnClick=function(n){if(!this._canInteract())return;var r=t(n.target).closest("tr"),i=e.grid.groupHelper,s=i.getGroupInfo(r[0]),o,u;s&&(o=i.getColumnByGroupLevel(this._field("leaves"),s.level),o&&(u=o.groupInfo.expandInfo[s.index],u.isExpanded?u.collapse():u.expand(n.shiftKey),this._view().ensureHeight()))},r.prototype._onKeyDown=function(n){if(!this._canInteract())return!0;var r=n.target.tagName.toLowerCase(),i=!1,s,o,u,a=e.grid.getKeyCodeEnum();if(r!=="input"&&r!=="option"&&r!=="select"&&r!=="textarea"||t(n.target).closest("tr.wijmo-wijgrid-datarow").length!==0){if(this.options.allowEditing){if((n.which===a.ESCAPE||n.which===113)&&this.currentCell()._isValid()&&this.currentCell()._isEdit())return this._endEditInternal(n),!1;if(n.which===113)return this._beginEditInternal(n),!1}if(!this.options.allowKeyboardNavigation||n.which===a.TAB)return!0;switch(n.which){case a.LEFT:case a.RIGHT:case a.DOWN:case a.UP:case a.PAGE_DOWN:case a.PAGE_UP:case a.HOME:case a.END:case a.TAB:s=this._getNextCurrencyPos(this._getDataCellsRange(),this.currentCell(),n.keyCode,n.shiftKey),i=this._canMoveToAnotherCell(n.target,n.which)}return i?(this._changeCurrentCell(n,new e.grid.cellInfo(s.cellIndex,s.rowIndex),!0),o=this.currentCell(),u=this.selection(),(!n.shiftKey||!u._multipleRangesAllowed()&&this.options.selectionMode.toLowerCase()!=="singlerange")&&u._startNewTransaction(o),u.beginUpdate(),u._selectRange(new e.grid.cellInfoRange(u._anchorCell(),o),!1,n.shiftKey,0,null),u.endUpdate(),!1):!0}return!0},r.prototype._onKeyPress=function(e){if(this._canInteract()&&this.options.allowEditing){var n=e.which,r=this.currentCell(),i,s,o;if(n&&r._isValid()&&!r._isEdit()){i=e.target.tagName.toLowerCase();if(i!=="input"&&i!=="option"&&i!=="select"&&i!=="textarea"){s=t(e.target).closest(".wijmo-wijgrid-table");if(s.length){o=t.map(this._view().subTables(),function(e,t){return e.element()});if(t.inArray(s[0],o)>=0&&t.wij.charValidator.isPrintableChar(String.fromCharCode(n)))return this._beginEditInternal(e),!1}}}}},r.prototype._onMouseMove=function(n){var r=this._view(),i=this._field("frozener"),s,o,u,a,f,l,c=e.grid.renderState;if(!this.options.highlightOnHover||!this._canInteract()||i&&i.inProgress())return;s=this._findUntilOuterDiv(n.target,{td:!0,th:!0});if(s){o=t(s).closest("tr");if(!o.length||!o.hasClass("wijmo-wijgrid-datarow")&&!o.hasClass("wijmo-wijgrid-headerrow"))return;u=r.getAbsoluteCellInfo(s),a=this._field("hoveredRow"),u.rowIndex()!==a&&(a!==undefined&&(f=this._rows().item(a),f&&(l=r._getRowInfo(f),r._changeRowRenderState(l,c.hovered,!1),this.rowStyleFormatter.format(l))),a=u.rowIndex(),this._field("hoveredRow",a),a>=0&&(f=this._rows().item(a),f&&(l=r._getRowInfo(f),r._changeRowRenderState(l,c.hovered,!0),this.rowStyleFormatter.format(l))))}},r.prototype._onMouseOut=function(n){if(!this._canInteract())return;if(t(n.relatedTarget).closest(".wijmo-wijgrid-data").length===0){var r=this._field("hoveredRow"),i,s,o=this._view();r>=0&&(i=this._rows().item(r),i&&(s=o._getRowInfo(i),o._changeRowRenderState(s,e.grid.renderState.hovered,!1),this.rowStyleFormatter.format(s)))}},r.prototype._onWindowResize=function(e){var t=this;this._windowResizeTimer>0&&(window.clearTimeout(this._windowResizeTimer),this._windowResizeTimer=0),this._windowResizeTimer!==-1&&(this._windowResizeTimer=window.setTimeout(function(){t._windowResizeTimer=-1;try{!t._destroyed&&t._initialized&&t.element.parent().length&&t.setSize()}finally{t._windowResizeTimer=0}},50))},r.prototype._fieldResized=function(e,t,n){t<0&&(t=0),n<=0&&(n=1);var r={column:e.options,oldWidth:t,newWidth:n};if(this._trigger("columnResizing",null,r)!==!1){if(isNaN(r.newWidth)||r.newWidth<0)r.newWidth=1;e.option("width",r.newWidth);var i={column:e.options};this._trigger("columnResized",null,i)}},r.prototype._changeCurrentCell=function(n,r,i){var s=this.currentCell(),o=this._getDataCellsRange(),u,a,f=this.options.highlightCurrentCell,l;if(o._isValid()&&o._containsCellInfo(r)||r.isEqual(e.grid.cellInfo.outsideValue))if(s.cellIndex()!==r.cellIndex()||s.rowIndex()!==r.rowIndex()){u={cellIndex:r.cellIndex(),rowIndex:r.rowIndex(),oldCellIndex:s.cellIndex(),oldRowIndex:s.rowIndex()};if(this._trigger("currentCellChanging",null,u)){a=!1;if(!this.options.allowEditing||!s._isEdit()||(a=this._endEditInternal(null))){o._containsCellInfo(s)&&(f&&this._highlightCellPosition(s,!1),(l=s.tableCell())&&t(l).removeAttr("tabIndex")),s=r._clone(),s._setGridView(this),f&&this._highlightCellPosition(s,!0);if(l=s.tableCell())t(l).attr("tabIndex",0),i&&!s._isEdit()&&t(l).focus();this._field("currentCell",s),this._onCurrentCellChanged(n)}}}else f&&this._highlightCellPosition(s,!0),(l=s.tableCell())&&t(l).attr("tabIndex",0)},r.prototype._highlightCellPosition=function(n,r){if(n&&n._isValid()){var i=n.cellIndexAbs(),s=n.rowIndexAbs(),o=e.grid.renderState,u=this._view(),a,f,l;f=u.getHeaderCell(i),f&&(a=u._getRowInfo(this._headerRows().item(n.column().thY)),f=t(f),l=u._changeCellRenderState(f,o.current,r),this.cellStyleFormatter.format(f,i,n.column(),a,l)),f=u.getJoinedRows(s,0),f&&(a=u._getRowInfo(f),u._changeRowRenderState(a,o.current,r),this.rowStyleFormatter.format(a)),f=u.getCell(i,s),f&&(f=t(f),l=u._changeCellRenderState(f,o.current,r),this.cellStyleFormatter.format(f,i,n.column(),a,l))}},r.prototype._beginEditInternal=function(t){if(this._canInteract()&&this.options.allowEditing){var n=this.currentCell().column(),r;if(n&&!n.readOnly)return r=(new e.grid.cellEditorHelper).currentCellEditStart(this,t),r,r}return!1},r.prototype._endEditInternal=function(t){if(this._canInteract()&&this.options.allowEditing){var n=(new e.grid.cellEditorHelper).currentCellEditEnd(this,t);return n&&!this._allowVirtualScrolling()&&this._view().ensureHeight(this.currentCell().rowIndex()),n}return!1},r.prototype._onViewInsertEmptyRow=function(e,t,n,r,i){return null},r.prototype._onViewCreateEmptyCell=function(e,t,n){return null},r.prototype._onViewCellRendered=function(e,t,n,r){},r.prototype._onViewRowRendered=function(e){},r.prototype._getDataParser=function(t){return t.dataParser||e.data.defaultParsers[t.dataType]||e.data.defaultParsers.string},r.prototype._parse=function(n,r){var i=this._dataViewWrapper.dataView(),s=e.grid.getDataType(n),o=e.grid.getDataType(n);return t.isFunction(r)&&(r=r()),r=e.data.convert(r,s,o,{culture:this._field("closestCulture"),format:n.dataFormatString||n._underlyingDataFormatString,nullString:this.options.nullString,parser:n.dataParser}),r},r.prototype._toStr=function(t,n){var r=this._dataViewWrapper.dataView(),i=e.grid.getDataType(t),s="string";return n=e.data.convert(n,i,s,{culture:this._field("closestCulture"),format:t.dataFormatString||t._underlyingDataFormatString,nullString:this.options.nullString,parser:t.dataParser}),n},r.prototype._funcOptions=function(){return["cellStyleFormatter","rowStyleFormatter","afterCellEdit","afterCellUpdate","beforeCellEdit","beforeCellUpdate","cellClicked","columnDragging","columnDragged","columnDropping","columnDropped","columnResizing","columnResized","columnGrouping","columnGrouped","columnUngrouping","columnUngrouped","currentCellChanging","currentCellChanged","filtering","filtered","filterOperatorsListShowing","groupAggregate","groupText","invalidCellValue","pageIndexChanging","pageIndexChanged","selectionChanged","sorting","sorted","dataLoading","dataLoaded","loading","loaded","rendering","rendered"]},r.prototype._canInteract=function(){return!this.options.disabled},r.prototype._canMoveToAnotherCell=function(n,r){var i=n.tagName.toLowerCase(),s,o,u,a;switch(i){case"input":if(t(n).hasClass("wijgridinput")){var f=n;return f.type==="text"?(s=f.value.length,o=(new e.grid.domSelection(f)).getSelection(),u=e.grid.getKeyCodeEnum(),a=r===u.UP||r===u.DOWN||r===u.PAGE_DOWN||r===u.PAGE_UP||o.length===0&&(o.start===0&&(r===u.LEFT||r===u.HOME)||o.end>=s&&(r===u.RIGHT||r===u.END)),a):!0}return!1;case"textarea":case"select":return!1}return!0},r.prototype._editBySingleClick=function(){var e=(this.options.editingInitOption||"").toLowerCase();switch(e){case"click":case"doubleclick":break;case"auto":default:e=this._isMobile?"click":"doubleclick"}return e==="click"},r.prototype._getDataToAbsOffset=function(){var e=0,t=0,n=this._headerRows();return this.options.showRowHeader&&e++,n&&(t+=n.length()),this._filterRow()&&t++,{x:e,y:t}},r.prototype._gridDataRowIndexToDataView=function(t){var n=-1,r=e.grid.rowType,i;return t<0?n:(i=this._view()._getRowInfo(this._rows().item(t)),i.type&e.grid.rowType.data?i.dataItemIndex:-1)},r.prototype._dataViewDataRowIndexToGrid=function(t){var n=e.grid.rowType,r=this._view(),i=this._rows(),s,o,u;if(t<0)return-1;for(s=0,o=i.length();s<o;s++){u=r._getRowInfo(i.item(s));if(u.type&n.data&&u.dataItemIndex===t)return u.sectionRowIndex}return-1},r.prototype._getDataCellsRange=function(){var t=0,n=0,r=this._field("visibleLeaves").length-1,i=this._rendered?this._rows().length()-1:this.sketchTable.length-1;this.options.showRowHeader&&r--;if(r<0||i<0)t=n=r=i=-1;return new e.grid.cellInfoRange(new e.grid.cellInfo(t,n,null),new e.grid.cellInfo(r,i,null))},r.prototype._getDataItem=function(e){return this.dataView().item(e)},r.prototype._getFirstDataRowCell=function(t){var n,r,i,s=this._view(),o=this._rows(),u=e.grid.rowType;for(n=0,r=o.length();n<r;n++){i=s._getRowInfo(o.item(n));if(i.type&u.data)return new e.grid.cellInfo(t,n)}return e.grid.cellInfo.outsideValue},r.prototype._getNextCurrencyPos=function(t,n,r,i){var s=n.cellIndex(),o=n.rowIndex(),u,a=e.grid.getKeyCodeEnum();switch(r){case a.PAGE_UP:this._reverseKey&&o===t.topLeft().rowIndex()?o=t.bottomRight().rowIndex():(o-=this._pageSizeKey,o<(u=t.topLeft().rowIndex())&&(o=u));break;case a.PAGE_DOWN:this._reverseKey&&o===t.bottomRight().rowIndex()?o=t.topLeft().rowIndex():(o+=this._pageSizeKey,o>(u=t.bottomRight().rowIndex())&&(o=u));break;case a.END:s=this._reverseKey&&s===t.bottomRight().cellIndex()?t.topLeft().cellIndex():t.bottomRight().cellIndex();break;case a.HOME:s=this._reverseKey&&s===t.topLeft().cellIndex()?t.bottomRight().cellIndex():t.topLeft().cellIndex();break;case a.LEFT:s>t.topLeft().cellIndex()?s--:this._reverseKey&&(s=t.bottomRight().cellIndex());break;case a.UP:o>t.topLeft().rowIndex()?o--:this._reverseKey&&(o=t.bottomRight().rowIndex());break;case a.RIGHT:s<t.bottomRight().cellIndex()?s++:this._reverseKey&&(s=t.topLeft().cellIndex());break;case a.ENTER:case a.DOWN:o<t.bottomRight().rowIndex()?o++:this._reverseKey&&(o=t.topLeft().rowIndex());break;case a.TAB:}return{cellIndex:s,rowIndex:o}},r.prototype._findUntilOuterDiv=function(e,t){var n=e,r,i,s=null;for(;n;n=n.parentNode){i=n.nodeName.toLowerCase();if(i){if(n===this.outerDiv[0]){r=n;break}t[i]&&(s=n)}}return r?s:null},r.prototype._getStaticIndex=function(e){var t,n=this._getDataCellsRange();return this._hasSpannedCells()?-1:(e?t=Math.min(this.options.staticRowIndex,n.bottomRight().rowIndex()):t=Math.min(this.options.staticColumnIndex,n.bottomRight().cellIndex()),t<-1&&(t=-1),t)},r.prototype._getStaticOffsetIndex=function(e){var t=0;return e?this.options.showRowHeader===!0&&t++:(t=this._columnsHeadersTable().length,this.options.showFilter&&t++),t},r.prototype._getRealStaticColumnIndex=function(){var e,t,n=this._getStaticOffsetIndex(!0),r=this._getStaticIndex(!1),i,s;i=r+n;if(r>=0){e=this._field("visibleLeaves"),t=e.length,s=i;for(;i<t;i++)if(e[i].parentIdx===-1){i>s&&i--;break}i>=t&&(i=t-1)}return i},r.prototype._getRealStaticRowIndex=function(){var e=this._getStaticOffsetIndex(!1);return this._getStaticIndex(!0)+e},r.prototype._hasMerging=function(){var e=this._field("leaves"),t,n,r,i=!1;if(e)for(t=0,n=e.length;t<n&&!i;t++)r=e[t],i=i||r.parentVis&&r.rowMerge!=="none";return i},r.prototype._hasGrouping=function(){var e=this._field("leaves"),t,n,r,i=!1;for(t=0,n=e.length;t<n&&!i;t++)r=e[t],i=r.groupInfo&&r.groupInfo.position!=="none";return i},r.prototype._hasSpannedCells=function(){return this._hasGrouping()||this._hasMerging()},r.prototype._columnsHeadersTable=function(e){return arguments.length&&this._field("columnsHeadersTable",e),this._field("columnsHeadersTable")},r.prototype._view=function(){return this._field("view")},r.prototype._originalFooterRowData=function(){var e=this._field("tfoot");return e&&e.length?e[0]:null},r.prototype._originalHeaderRowData=function(){var e=this._field("thead");return e&&e.length?e[0]:null},r.prototype._setAttr=function(e,n,r){var i=this;return e===this.element?arguments.length===2?(t.each(n,function(t,n){t in i._originalAttr||(i._originalAttr[t]=e.attr(t))}),e.attr(n)):(n in this._originalAttr||(this._originalAttr[n]=e.attr(n)),e.attr(n,r)):arguments.length===3?e.attr(n,r):e.attr(n)},r.prototype._totalRowsCount=function(){return this.sketchTable.length},r.prototype._trackScrollingPosition=function(e,t){this._scrollingState.x=e,this._scrollingState.y=t},r.prototype._trackScrollingIndex=function(e){this._scrollingState.index=e},r.prototype._uid=function(){return this.__uid===undefined&&(this.__uid=e.grid.getUID()),"wijgrid"+this.__uid},r}(e.wijmoWidget);e.wijgrid=n,n.prototype.widgetEventPrefix="wijgrid",n.prototype._data$prefix="wijgrid",n.prototype._customSortOrder=1e3,n.prototype._reverseKey=!1,n.prototype._pageSizeKey=10,n.prototype._mergeWidgetsWithOptions=!0;var r=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-c"},this.allowColMoving=!1,this.allowColSizing=!1,this.allowEditing=!1,this.allowKeyboardNavigation=!0,this.allowPaging=!1,this.allowSorting=!1,this.allowVirtualScrolling=!1,this.cellStyleFormatter=undefined,this.columns=[],this.columnsAutogenerationMode="merge",this.culture="",this.customFilterOperators=[],this.data=null,this.editingInitOption="auto",this.ensureColumnsPxWidth=!1,this.filterOperatorsSortMode="alphabeticalCustomFirst",this.groupAreaCaption="Drag a column here to group by that column.",this.groupIndent=10,this.highlightCurrentCell=!1,this.highlightOnHover=!0,this.loadingText="Loading...",this.nullString="",this.pageIndex=0,this.pageSize=10,this.pagerSettings={mode:"numeric",pageButtonCount:10,position:"bottom"},this.readAttributesFromData=!1,this.rowStyleFormatter=undefined,this.scrollMode="none",this.selectionMode="singleRow",this.showFilter=!1,this.showFooter=!1,this.showGroupArea=!1,this.showSelectionOnRender=!0,this.showRowHeader=!1,this.staticColumnIndex=-1,this.staticRowIndex=-1,this.totalRows=-1,this.afterCellEdit=null,this.afterCellUpdate=null,this.beforeCellEdit=null,this.beforeCellUpdate=null,this.cellClicked=null,this.columnDragging=null,this.columnDragged=null,this.columnDropping=null,this.columnDropped=null,this.columnGrouping=null,this.columnGrouped=null,this.columnResizing=null,this.columnResized=null,this.columnUngrouping=null,this.columnUngrouped=null,this.currentCellChanging=null,this.currentCellChanged=null,this.filterOperatorsListShowing=null,this.filtering=null,this.filtered=null,this.groupAggregate=null,this.groupText=null,this.invalidCellValue=null,this.pageIndexChanging=null,this.pageIndexChanged=null,this.selectionChanged=null,this.sorting=null,this.sorted=null,this.dataLoading=null,this.dataLoaded=null,this.loading=null,this.loaded=null,this.rendering=null,this.rendered=null}return e}();n.prototype.options=e.grid.extendWidgetOptions(e.wijmoWidget.prototype.options,new r),t.wijmo.registerWidget("wijgrid",n.prototype)})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){"use strict";var t=jQuery,n=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype._create=function(){var n=t.data(this.element[0],"wijgridowner");this._field("owner",n),e.grid.widgetName(this.element[0],this.widgetFullName),this._destroyed=!1,this.element.addClass(n.options.wijCSS.widget+" wijmo-c1basefield "+n.options.wijCSS.stateDefault),this.options.disabled&&this.disable(),n.options.allowColMoving&&n._dragndrop(!0).attach(this)},r.prototype._init=function(){this.element.wrapInner("<div class='wijmo-wijgrid-innercell'></div>"),this._refreshHeaderCell()},r.prototype.destroy=function(){try{n.prototype.destroy.apply(this,arguments)}finally{this._destroyed=!0}},r.prototype._destroy=function(){if(this._isDestroyed())return;var t=this._owner();t&&t._dragndrop(!1)&&t._dragndrop(!1).detach(this),e.grid.remove$dataByPrefix(this.element,this._data$prefix),this.element.removeClass(t.options.wijCSS.widget+" wijmo-c1basefield "+t.options.wijCSS.stateDefault).html(this.element.find(".wijmo-wijgrid-headertext").html())},r.prototype._field=function(t,n){return e.grid.dataPrefix(this.element,this._data$prefix,t,n)},r.prototype._removeField=function(e){var t=this._data$prefix+e;this.element.removeData(t)},r.prototype._setOption=function(e,t){var r=this["_preset_"+e],i=this.options[e],s,o;r!==undefined&&(t=r.apply(this,[t,i])),s=t!==i,n.prototype._setOption.apply(this,[e,t]);if(s){if(this.options.groupedIndex!==undefined){var u=this._owner()._field("groupedWidgets")[this.options.groupedIndex];u&&e in u.options&&u._setOption(e,t)}o=this["_postset_"+e],o!==undefined&&o.apply(this,[t,i])}},r.prototype._postset_allowMoving=function(e,t){},r.prototype._preset_clientType=function(e,t){throw"read-only"},r.prototype._postset_headerText=function(e,t){this._refreshHeaderCell()},r.prototype._postset_visible=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_width=function(t,n){var r=this._owner();if(r){this.options.ensurePxWidth=!0;var i=e.grid.getColumnByTravIdx(r.options.columns,this.options.travIdx);i&&(i.found.width=t,i.found.ensurePxWidth=!0),r.setSize()}},r.prototype._owner=function(){return this._field("owner")},r.prototype._canSize=function(){return this.options.allowSizing&&this._owner().options.allowColSizing},r.prototype._canDrag=function(){return this.options.allowMoving===!0},r.prototype._canDropTo=function(t){return e.grid.isChildOf(this._owner().options.columns,t,this)?!1:!0},r.prototype._createHeaderContent=function(e){return e.html(this.options.headerText||"")},r.prototype._decorateHeaderContent=function(e){return e.wrapInner('<span class="wijmo-wijgrid-headertext" />')},r.prototype._refreshHeaderCell=function(){var e=this.element.children(".wijmo-wijgrid-innercell").empty();this._createHeaderContent(e),this._decorateHeaderContent(e)},r.prototype._isDestroyed=function(){return this._destroyed},r}(e.wijmoWidget);e.c1basefield=n,n.prototype._data$prefix="c1basefield";var r=function(){function e(){this.allowMoving=!0,this.allowSizing=!0,this.cellFormatter=undefined,this.dataKey=undefined,this.ensurePxWidth=undefined,this.footerText=undefined,this.headerText=undefined,this.textAlignment=undefined,this.visible=!0,this.width=undefined}return e}();e.c1basefield_options=r,n.prototype.options=e.grid.extendWidgetOptions(e.wijmoWidget.prototype.options,new r),t.wijmo.registerWidget("c1basefield",n.prototype)})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){"use strict";var t=jQuery,n=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype._create=function(){n.prototype._create.apply(this,arguments);var e=this._owner();this.element.addClass(e.options.wijCSS.widget+" wijmo-c1field")},r.prototype._destroy=function(){if(this._isDestroyed())return;var e=this._owner();this.element.find("*").unbind("."+this.widgetName);if(this.$filterEditor){this.$filterEditor.closest("td").find("*").unbind("."+this.widgetName);switch(this._getInputEditorType(this.options)){case"date":this.$filterEditor.data("wijmo-wijinputdate")&&this.$filterEditor.wijinputdate("destroy");break;case"mask":this.$filterEditor.data("wijmo-wijinputmask")&&this.$filterEditor.wijinputmask("destroy");break;case"numberCurrency":case"numberNumber":case"numberPercent":this.$filterEditor.data("wijmo-wijinputnumber")&&this.$filterEditor.wijinputnumber("destroy")}this.$filterEditor=null}this.element.removeClass(e.options.wijCSS.widget+" wijmo-c1field").find(".wijmo-wijgrid-headertext > span."+e.options.wijCSS.icon).remove(),this._removeDropDownFilterList(),n.prototype._destroy.apply(this,arguments)},r.prototype._init=function(){n.prototype._init.apply(this,arguments),this.$filterEditor=null;var e=this._owner();this.filterRow=e._filterRow(),e.options.showFilter&&this.options.showFilter&&this.options.dataIndex>=0&&this._prepareFilterCell()},r.prototype._postset_aggregate=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_allowSort=function(e,t){this._refreshHeaderCell()},r.prototype._postset_dataType=function(e,t){throw"read-only"},r.prototype._postset_dataParser=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_dataFormatString=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_filterOperator=function(e,t){this._owner().ensureControl(!0)},r.prototype._postset_filterValue=function(e,t){this._owner().ensureControl(!0)},r.prototype._postset_groupInfo=function(e,t){this._owner().ensureControl(!0)},r.prototype._postset_rowMerge=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_showFilter=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_sortDirection=function(e,t){this.options.sortOrder=0,this._owner().ensureControl(!0)},r.prototype._postset_width=function(e,t){n.prototype._postset_width.apply(this,arguments)},r.prototype._canDropTo=function(e){return n.prototype._canDropTo.apply(this,arguments)?this.options.groupedIndex!==undefined&&e instanceof t.wijmo.c1groupedfield?!1:!0:!1},r.prototype._canSort=function(){var e=this._owner();return e&&e.options.allowSorting&&this.options.allowSort&&this.options.dataIndex>=0},r.prototype._decorateHeaderContent=function(e){if(this._canSort()){var r=this._owner(),i=e.wrapInner('<a class="wijmo-wijgrid-headertext" href="#" role="button" />').children("a");i.bind("click."+this.widgetName,this,t.proxy(this._onHrefClick,this));switch(this.options.sortDirection){case"ascending":i.append(t('<span class="'+r.options.wijCSS.icon+" "+r.options.wijCSS.iconArrowUp+'">ascending</span>'));break;case"descending":i.append(t('<span class="'+r.options.wijCSS.icon+" "+r.options.wijCSS.iconArrowDown+'">descending</span>'))}}else n.prototype._decorateHeaderContent.apply(this,arguments)},r.prototype._prepareFilterCell=function(){var n=this.options.visLeavesIdx,r=null,i=null,s,o,u=this,a;if(n>=0){r=this._owner();if(!this.filterRow)throw"exception";i=t(e.grid.rowAccessor.getCell(this.filterRow,n)),this.$filterEditor=i.find("input"),i.bind(t.support.selectstart?"selectstart":"mousedown",function(e){e.stopPropagation()}),s=r._parse(this.options,e.grid.filterHelper.getSingleValue(this.options.filterValue));if(s===null||s==="undefined")switch(e.grid.getDataType(this.options)){case"boolean":s=!1;break;case"number":case"currency":case"datetime":s=0;break;default:s=""}o={culture:r.options.culture,disabled:r.options.disabled,decimalPlaces:function(e){var t=/^(n|p|c){1}(\d*)$/.exec(e);return t&&t[2]?parseInt(t[2],10):2}(this.options.dataFormatString)};switch(a=this._getInputEditorType(this.options)){case"date":this.$filterEditor.wijinputdate(t.extend(o,{date:s,dateFormat:this.options.dataFormatString||undefined}));break;case"mask":this.$filterEditor.wijinputmask({text:s+""});break;case"numberCurrency":this.$filterEditor.wijinputnumber(t.extend(o,{type:"currency",value:s}));break;case"numberNumber":this.$filterEditor.wijinputnumber(t.extend(o,{value:s}));break;case"numberPercent":this.$filterEditor.wijinputnumber(t.extend(o,{type:"percent",value:s*100}));break;default:throw e.grid.stringFormat('Unsupported editor type: "{0}"',a)}i.find(".wijmo-wijgrid-filter-trigger").attr({role:"button","aria-haspopup":"true"}).bind("mouseenter."+this.widgetName,function(e){u.options.disabled||t(this).addClass(r.options.wijCSS.stateHover)}).bind("mouseleave."+this.widgetName,function(e){u.options.disabled||t(this).removeClass(r.options.wijCSS.stateHover+" "+r.options.wijCSS.stateActive)}).bind("mouseup."+this.widgetName,this,function(e){u.options.disabled||t(this).removeClass(r.options.wijCSS.stateActive)}).bind("mousedown."+this.widgetName,{column:this},this._onFilterBtnClick).bind("click."+this.widgetName,function(e){e.preventDefault()})}},r.prototype._onFilterBtnClick=function(n){var r=n.data.column,i=8,s,o,u,a,f,l,c,h,p,d;if(r.options.disabled)return!1;if(r.$dropDownFilterList)return r._removeDropDownFilterList(),!1;n.target.focus(),s=r._owner(),o=e.grid.filterHelper.getSingleOperatorName(r.options.filterOperator).toLowerCase(),u=s.getFilterOperatorsByDataType(e.grid.getDataType(r.options)),a={operators:u,column:r.options},s._onFilterOperatorsListShowing(t.extend(!0,{},a)),f=[],a.operators&&t.each(a.operators,function(e,t){f.push({label:t.displayName||t.name,value:t.name,selected:t.name.toLowerCase()===o})}),r.$dropDownFilterList=t('<div class="wijmo-wijgrid-filterlist"></div').appendTo(document.body).wijlist({autoSize:!0,maxItemsCount:i,selected:function(e,t){var n,i;switch(i=r._getInputEditorType(r.options)){case"date":n=r.$filterEditor.wijinputdate("option","date")||new Date;break;case"mask":n=r.$filterEditor.wijinputmask("option","text");break;case"numberCurrency":case"numberNumber":case"numberPercent":n=r.$filterEditor.wijinputnumber("option","value"),i==="numberPercent"&&(n/=100)}r._removeDropDownFilterList(),s._handleFilter(r,t.item.value,n)}}),t.ui&&t.fn.zIndex&&(d=s.outerDiv.zIndex(),d&&d++),r.$dropDownFilterList.css("z-index",Math.max(d||0,9999)),r.$dropDownFilterList.wijlist("setItems",f).wijlist("renderList"),h=r.$dropDownFilterList.width()|150,r.$dropDownFilterList.width(f.length>i?h+20:h).wijlist("refreshSuperPanel").position({of:t(this),my:"left top",at:"left bottom"}),r.$dropDownFilterList.$button=t(this),p=r.$dropDownFilterList.eventUID=e.grid.getUID(),t(document).bind("mousedown."+r.widgetName+"."+p,{column:r},r._onDocMouseDown)},r.prototype._onDocMouseDown=function(e){var n=t(e.target),r=n.parents(".wijmo-wijgrid-filterlist:first"),i=n.is(".wijmo-wijgrid-filter-trigger")?n:n.parents(".wijmo-wijgrid-filter-trigger:first");i.length&&i[0]===e.data.column.$dropDownFilterList.$button[0]||r.length&&r[0]===e.data.column.$dropDownFilterList[0]||e.data.column._removeDropDownFilterList()},r.prototype._onHrefClick=function(e){return e.data.options.disabled?!1:(e.data.options.allowSort&&e.data._owner()._handleSort(e.data.options,e.ctrlKey),!1)},r.prototype._removeDropDownFilterList=function(){if(this.$dropDownFilterList){var e=this.$dropDownFilterList.eventUID;this.$dropDownFilterList.remove(),this.$dropDownFilterList=null,t(document).unbind("mousedown."+this.widgetName+"."+e,this._onDocMouseDown)}},r.prototype._getInputEditorType=function(t){switch(e.grid.getDataType(t)){case"number":return t.dataFormatString&&t.dataFormatString.indexOf("p")===0?"numberPercent":"numberNumber";case"currency":return"numberCurrency";case"datetime":return"date";default:return"mask"}},r}(e.c1basefield);e.c1field=n;var r=function(e){function n(){e.apply(this,arguments),this.aggregate="none",this.allowSort=!0,this.dataType=undefined,this.dataParser=undefined,this.dataFormatString=undefined,this.filterOperator="nofilter",this.filterValue=undefined,this.groupInfo={expandInfo:[],level:undefined,groupSingleRow:!0,collapsedImageClass:t.wijmo.wijCSS.iconArrowRight,expandedImageClass:t.wijmo.wijCSS.iconArrowRightDown,position:"none",outlineMode:"startExpanded",headerText:undefined,footerText:undefined},this.readOnly=!1,this.rowMerge="none",this.showFilter=!0,this.sortDirection="none",this.valueRequired=!1}return __extends(n,e),n}(e.c1basefield_options);e.c1field_options=r,n.prototype.options=e.grid.extendWidgetOptions(e.c1basefield.prototype.options,new r),t.wijmo.registerWidget("c1field",t.wijmo.c1basefield,n.prototype)})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){"use strict";var t=jQuery,n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype._create=function(){e.prototype._create.apply(this,arguments);var t=this._owner();this.element.addClass(t.options.wijCSS.widget+" wijmo-c1band")},n.prototype._canDropTo=function(n){return e.prototype._canDropTo.apply(this,arguments)?!(n instanceof t.wijmo.c1groupedfield):!1},n}(e.c1basefield);e.c1band=n;var r=function(e){function t(){e.apply(this,arguments),this.columns=[]}return __extends(t,e),t}(e.c1field_options);n.prototype.options=e.grid.extendWidgetOptions(e.c1basefield.prototype.options,new r),t.wijmo.registerWidget("c1band",t.wijmo.c1basefield,n.prototype)})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){"use strict";var t=jQuery,n=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype._create=function(){var n=t.data(this.element[0],"wijgridowner");this._field("owner",n),e.grid.widgetName(this.element[0],this.widgetFullName),this._destroyed=!1,this.element.addClass("wijmo-wijgrid-group-button "+n.options.wijCSS.stateDefault+" "+n.options.wijCSS.cornerAll),this.options.disabled&&this.disable(),n.options.allowColMoving&&n._dragndrop(!0).attach(this)},r.prototype._init=function(){this._refreshHeaderCell()},r.prototype.destroy=function(){try{n.prototype.destroy.apply(this,arguments)}finally{this._destroyed=!0}},r.prototype._destroy=function(){if(this._isDestroyed())return;this.element.find("*").unbind("."+this.widgetName);var t=this._owner();t&&t._dragndrop(!1)&&t._dragndrop(!1).detach(this),e.grid.remove$dataByPrefix(this.element,this._data$prefix)},r.prototype._field=function(t,n){return e.grid.dataPrefix(this.element,this._data$prefix,t,n)},r.prototype._removeField=function(e){var t=this._data$prefix+e;this.element.removeData(t)},r.prototype._setOption=function(e,t){var r=this["_preset_"+e],i=this.options[e],s,o;r!==undefined&&(t=r.apply(this,[t,i])),s=t!==i,n.prototype._setOption.apply(this,[e,t]),s&&(o=this["_postset_"+e],o!==undefined&&o.apply(this,[t,i]))},r.prototype._postset_headerText=function(e,t,n){this._refreshHeaderCell()},r.prototype._postset_allowSort=function(e,t,n){this._refreshHeaderCell()},r.prototype._owner=function(){return this._field("owner")},r.prototype._canSize=function(){return this.options.allowSizing&&this._owner().options.allowColSizing},r.prototype._canDrag=function(){return this.options.allowMoving===!0},r.prototype._canDropTo=function(n){return n instanceof t.wijmo.c1groupedfield?e.grid.isChildOf(this._owner().options.columns,n,this)?!1:!0:!1},r.prototype._canSort=function(){var e=this._owner();return e&&e.options.allowSorting&&this.options.allowSort&&this.options.dataIndex>=0},r.prototype._refreshHeaderCell=function(){var e=this._owner().options.wijCSS,n=t('<span class="wijmo-wijgrid-group-button-close '+e.stateDefault+" "+e.cornerAll+'"><span class="'+e.icon+" "+e.iconClose+'"></span></span>').bind("click."+this.widgetName,this,this._onCloseClick);this.element.html(this.options.headerText||"").prepend(n).bind("click."+this.widgetName,this,t.proxy(this._onHrefClick,this));if(this._canSort())switch(this.options.sortDirection){case"ascending":this.element.append(t('<span class="wijmo-wijgrid-group-button-sort '+e.icon+" "+e.iconArrowUp+'"></span>'));break;case"descending":this.element.append(t('<span class="wijmo-wijgrid-group-button-sort '+e.icon+" "+e.iconArrowDown+'"></span>'))}},r.prototype._onCloseClick=function(e){var t=e.data.options;return t.disabled||e.data._owner()._handleUngroup(e.data.options.travIdx),!1},r.prototype._onHrefClick=function(t){var n=t.data._owner(),r=t.data.options,i;return!r.disabled&&r.allowSort&&(i=e.grid.search(n.columns(),function(e){return e.options.travIdx===r.travIdx}),i=i.found?i.found.options:e.grid.getColumnByTravIdx(n.options.columns,r.travIdx).found,i&&n._handleSort(i,t.ctrlKey)),!1},r.prototype._isDestroyed=function(){return this._destroyed},r}(e.wijmoWidget);e.c1groupedfield=n,n.prototype._data$prefix="c1groupedfield",n.prototype.options=t.extend(!0,{},e.wijmoWidget.prototype.options,{wijMobileCSS:{header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-c",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-c"},allowMoving:!0,allowSort:!0,headerText:undefined,sortDirection:"none"}),t.wijmo.registerWidget("c1groupedfield",n.prototype)})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function i(e){var t=[];return s(e,t),t}function s(e,t){var n,r,i,o;if(e)for(n=0,r=e.length;n<r;n++)i=e[n],i.options&&(i=i.options),o=i.columns,o&&o.length?s(o,t):t.push(i)}function o(e,t){var n,r,i,s=null;if(e&&t>=0)for(n=0,r=e.length;n<r&&!s;n++){i=e[n],i.options&&(i=i.options);if(i.travIdx===t)return{found:i,at:e};i.columns&&(s=this.getColumnByTravIdx(i.columns,t))}return s}function u(e,t,n){t.options&&(t=t.options),n.options&&(n=n.options);if(n.isBand&&t.parentIdx>=0){if(t.parentIdx===n.travIdx)return!0;if(t.parentIdx>n.travIdx){var r=this.flatten(e);for(;;){t=r[t.parentIdx];if(t.travIdx===n.travIdx)return!0;if(t.parentIdx===-1)break}}}return!1}function a(e){var t=[];return f(e,t),t}function f(e,t){var n,r,i;if(e)for(n=0,r=e.length;n<r;n++)i=e[n],i.isLeaf&&t.push(i),i.columns&&f(i.columns,t)}function l(e){return c(e,0,-1)}function c(e,t,n){var r,i,s;if(e)for(r=0,i=e.length;r<i;r++)s=e[r],s.options&&(s=s.options),s.linearIdx=r,s.travIdx=t++,s.parentIdx=n,s.columns&&(t=c(s.columns,t,t-1));return t}function h(t){var n=[];return e.grid.traverse(t,function(e){n.push(e)}),n}function p(t,r){var i,s,o;if(t&&n.isFunction(r))for(i=0;i<t.length;i++){o=t[i],o.options&&(o=o.options),s=t.length,r(o,t);if(t.length!==s){i--;continue}o.columns&&e.grid.traverse(o.columns,r)}}var n=jQuery,r=function(){function t(){}return t.prototype.generateSpanTable=function(e,t){this._height=this._width=this._inc=this._shift=0,this._table=[],this._traverseList=[],this._savedXPos=[];var n=this._generateSpanTable(e,t,!0);return n},t.prototype._generateSpanTable=function(t,n,r){var i,s,o=this;this._height=this.getVisibleHeight(t,r),n=n||[],e.grid.traverse(t,function(e){e.isLeaf&&n.push(e),o._traverseList.push(e)}),this._width=n.length;for(i=0;i<this._height;i++){this._table[i]=[];for(s=0;s<this._width;s++)this._table[i][s]={column:null,colSpan:0,rowSpan:0}}return this._setTableValues(t,0,0),this._table},t.prototype.getVisibleHeight=function(e,t){var r,i,s,o,u=0;if(n.isArray(e))for(r=0,i=e.length;r<i;r++)o=this.getVisibleHeight(e[r],t),u=Math.max(u,o);else{s=e.visible===undefined?!0:e.visible,e.parentVis=s&&t;if(e.isBand){for(r=0,i=e.columns.length;r<i;r++)o=this.getVisibleHeight(e.columns[r],e.parentVis),u=Math.max(u,o);if(!e.parentVis)return u;e.isLeaf=u===0,u++}else e.isLeaf=!0,e.parentVis&&(u=1)}return u},t.prototype._getVisibleParent=function(e){while(e){e=this._traverseList[e.parentIdx];if(e&&(e.parentVis||e.parentVis===undefined))return e}return null},t.prototype._setTableValues=function(e,t,r){var i,s,o,u,a,f;if(n.isArray(e))for(i=0,s=e.length;i<s;i++)this._setTableValues(e[i],t,r);else{if(e.travIdx===undefined)throw"undefined travIdx";o=r+this._shift,e.parentVis&&(u=o+this._inc,this._table[t][u].column=e,this._savedXPos[e.travIdx]=u);if(e.isBand)for(i=0,s=e.columns.length;i<s;i++)this._setTableValues(e.columns[i],t+1,r);e.parentVis?this._shift-o===0?(this._table[t][this._savedXPos[e.travIdx]].rowSpan=this._height-t,this._shift++):this._table[t][this._savedXPos[e.travIdx]].colSpan=this._shift-o:!e.isBand&&this._height>0&&(f=this._getVisibleParent(e),a=f?f.isLeaf:!1,a&&this._inc++,t>=this._height&&(t=this._height-1),u=r+this._shift+this._inc,this._table[t][u].column=e,a||(f&&this._savedXPos[f.travIdx]===u&&this._shiftTableElements(u,t),this._inc++))}},t.prototype._shiftTableElements=function(e,t){var n;for(n=0;n<t;n++)this._table[n][e+1]=this._table[n][e],this._table[n][e]={column:null,colSpan:0,rowSpan:0},this._table[n][e+1].column&&this._savedXPos[this._table[n][e+1].column.travIdx]++},t}();t.bandProcessor=r,t.getAllLeaves=i,t.getColumnByTravIdx=o,t.isChildOf=u,t.getLeaves=a,t.setTraverseIndex=l,t.flatten=h,t.traverse=p})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(t){this._dvFilteringSettings=undefined,this._dvPagingSettings=undefined,this._dvSortingSettings=undefined,this._wgFilteringSettings=undefined,this._wgPagingSettings=undefined,this._wgSortingSettings=undefined;if(!t)throw"exception";this._wijgrid=t,this._dataView=t._dataViewWrapper.dataView(),this._filterCache=new e.grid.filterOperatorsCache(t)}return t.prototype.compareSettings=function(){var t=!0,n,r,i,s;t=(n=this.DVPagingSettings())===(r=this.WGPagingSettings()),!t&&n&&r&&(t=n.pageSize===r.pageSize&&n.pageIndex===r.pageIndex);if(t){t=(n=this.DVSortingSettings())===(r=this.WGSortingSettings());if(!t&&n&&r&&(s=n.length)===r.length){t=!0;for(i=0;i<s&&t;i++)t=n[i].dataKey===r[i].dataKey&&n[i].sortDirection===r[i].sortDirection}}return t&&(n=this.DVFilteringSettings(),r=this.WGFilteringSettings(),t=e.grid.compareObj(n,r)),t},t.prototype.DVFilteringSettings=function(){function e(t,r){var i;n.each(t,function(t,s){typeof s=="string"?i=s:n.isArray(s)?e(s,r):(r.filterValue.push(s.value),r.filterOperator.push({name:s.operator,condition:i}))})}if(this._dvFilteringSettings===undefined){var t=[],r=this._dataView.filter();r&&n.each(r,function(r,i){var s={dataKey:r};n.isArray(i)?(s.filterValue=[],s.filterOperator=[],e(i,s)):n.isPlainObject(i)?(s.filterValue=i.value,s.filterOperator=i.operator||"Equals"):(s.filterValue=i,s.filterOperator="Equals"),t.push(s)}),this._dvFilteringSettings=t.length?t:null}return this._dvFilteringSettings},t.prototype.DVPagingSettings=function(){if(this._dvPagingSettings===undefined){var t=e.grid.asPagedDataView(this._dataView);if(t){var n=t.pageSize();this._dvPagingSettings=n>0?{pageSize:t.pageSize(),pageIndex:t.pageIndex()}:null}}return this._dvPagingSettings},t.prototype.DVSortingSettings=function(){if(this._dvSortingSettings===undefined){var t=[],r=e.data.sorting.compile(this._dataView.sort()).normalized;r&&n.each(r,function(e,n){n!==null&&t.push({dataKey:typeof n=="string"?n:n.property,sortDirection:n.asc||n.asc===undefined?"ascending":"descending"})}),this._dvSortingSettings=t.length?t:null}return this._dvSortingSettings},t.prototype.WGFilteringSettings=function(){if(this._wgFilteringSettings===undefined){var t=[],r=this._wijgrid._field("leaves"),i=this;r&&n.each(r,function(n,r){if(e.grid.validDataKey(r.dataKey)&&r.filterOperator){var s=e.grid.deepExtend({},{foo:r.filterValue}).foo,o=e.grid.deepExtend({},{foo:r.filterOperator}).foo,u=e.grid.filterHelper.verify(o,s,r.dataType,i._filterCache);u&&t.push({dataKey:r.dataKey,filterValue:u.filterValue,filterOperator:u.filterOperator})}}),this._wgFilteringSettings=t.length?t:null}return this._wgFilteringSettings},t.prototype.WGPagingSettings=function(){return this._wgPagingSettings===undefined&&(this._wgPagingSettings=this._wijgrid.options.allowPaging?{pageSize:this._wijgrid.options.pageSize,pageIndex:this._wijgrid.options.pageIndex}:null),this._wgPagingSettings},t.prototype.WGSortingSettings=function(){if(this._wgSortingSettings===undefined){var t=[],r=this._wijgrid._field("leaves");this._wijgrid.options.allowSorting&&(r&&n.each(r,function(n,r){!r.isBand&&r.allowSort&&e.grid.validDataKey(r.dataKey)&&(r.groupInfo&&r.groupInfo.position!=="none"&&r.sortDirection==="none"&&(r.sortDirection="ascending"),(r.sortDirection==="ascending"||r.sortDirection==="descending")&&t.push({dataKey:r.dataKey,sortDirection:r.sortDirection,sortOrder:r.sortOrder||0}))}),t.length&&(t.sort(function(e,t){return e.sortOrder-t.sortOrder}),n.each(t,function(e,t){delete t.sortOrder}))),this._wgSortingSettings=t.length?t:null}return this._wgSortingSettings},t.prototype.MapWGToDV=function(){var e={},t,r;this._mapPagingParams()&&(t=this.WGPagingSettings())?(e.pageIndex=t.pageIndex,e.pageSize=t.pageSize):e.pageSize=-1;if(this._mapSortingParams()){e.sort=[];if(t=this.WGSortingSettings())e.sort=[],n.each(t,function(t,n){e.sort.push({property:n.dataKey,asc:n.sortDirection==="ascending"})})}if(this._mapFilteringParams()){e.filter={};if(t=this.WGFilteringSettings())e.filter=this._convertFilterToDV(t);n.isEmptyObject(e.filter)&&(e.filter=null)}return e},t.prototype.MapDVToWG=function(){var t,r={},i=this._mapSortingParams(),s=this._mapPagingParams(),o=this._mapFilteringParams(),u=e.grid.asPagedDataView(this._dataView);n.each(this._wijgrid._field("leaves"),function(e,t){i&&(t.sortOrder=0,t.sortDirection="none"),o&&(t.filterOperator="nofilter",t.filterValue=undefined),r[t.dataKey]=t}),s&&u&&(this._wijgrid.options.pageSize=u.pageSize(),this._wijgrid.options.pageIndex=u.pageIndex()),i&&(t=this.DVSortingSettings())&&n.each(t,function(e,t){var n;if(n=r[t.dataKey])n.sortDirection=t.sortDirection,n.sortOrder=e}),o&&(t=this.DVFilteringSettings())&&n.each(t,function(e,t){var i;if(i=r[t.dataKey])i.filterValue=t.filterValue,i.filterOperator=t.filterOperator,n.isPlainObject(i.filterOperator)&&(i.filterOperator=i.filterOperator.name)})},t.prototype._mapPagingParams=function(){return this._wijgrid.options.allowPaging&&!this._wijgrid._customPagingEnabled()&&!this._wijgrid._serverShaping()},t.prototype._mapSortingParams=function(){return this._wijgrid.options.allowSorting&&!this._wijgrid._serverShaping()},t.prototype._mapFilteringParams=function(){return!this._wijgrid._serverShaping()},t.prototype._convertFilterToDV=function(e){var t={},r=this;return n.each(e,function(e,i){var s=i.dataKey,o=[],u="and",a,f,l,c,h;if(!n.isPlainObject(i))return;f=i.filterOperator,l=i.filterValue;if(f==null)return;n.isArray(f)||(f=[f]),n.isArray(l)||(l=[l]);if(f.length!=l.length)throw"The number of filter operators must match the number of filter values";if(f.length==0)return;n.each(f,function(e,t){function i(){h.length>1?h.splice(0,0,"or"):h=h[0]}function f(){u==null&&(u=a,o.splice(0,0,a))}typeof t=="string"&&(t={name:t});if(!n.isPlainObject(t)||!t.name)throw"Invalid filter operator";c=l[e],n.isArray(c)||(c=[c]),h=n.map(c,function(e){var i={property:s,operator:t.name,value:e},o=r._filterCache.getByNameInt(t.name);if(o.isCustom){var u=n.extend(!0,{},o.op);n.isFunction(u.operator)&&(u.apply=u.operator),i.operator=u}return i}),u=null,a=t.condition||"or",o.length<=1||u==a?h.length==1||o.length<=1||u=="or"?(o=o.concat(h),f()):(i(),o.push(h),f()):(i(),o=[o,h],f())}),n.each(o,function(e,t){n.isArray(t)&&t.length==2&&(o[e]=t[1])}),o.length==2&&typeof (o[0]==="string")&&o.shift(),o.length==1&&(o=o[0]),t[s]=o}),t},t}();t.settingsManager=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function i(e){return e&&"pageCount"in e?e:null}function s(e){return e&&"commitEdit"in e?e:null}var n=jQuery,r=function(){function t(e){this._domSource=null,this._ignoreAllEvents=!1,this._ignoreChangeEvent=!1,this._ignoreCurrentChangedEvent=!1,this._sharedDataItems=null,this._userData=null,this._totals=null,this._changeTimer=0,this._toDispose=[],this._isOwnDataView=!1,this._isWijdatasource=!1,this._isDynamicWijdatasource=!1,this._wijgrid=e,this._createDataViewWrapper()}return t.prototype.data=function(){var t=this._getDataViewInst(),n=e.grid.asPagedDataView(t);return{data:this._getSharedDataItems(),totalRows:n!=null?n.totalItemCount():(t.getSource()||[]).length,totals:this._getTotals(),emptyData:this.isBoundedToDOM()?this._domSource.emptyData:null}},t.prototype.dataView=function(){return this._getDataViewInst()},t.prototype.dispose=function(){var e=this._getDataViewInst();this._propChangeListener.dispose(),n.each(this._toDispose,function(e,t){t.dispose()}),e&&this._isOwnDataView&&e.dispose(),this._wijgrid._wijDataView=null},t.prototype.ignoreChangeEvent=function(e){if(!arguments.length)return this._ignoreChangeEvent;this._ignoreChangeEvent=e===!0},t.prototype.ignoreCurrentChangedEvent=function(e){if(!arguments.length)return this._ignoreCurrentChangedEvent;this._ignoreCurrentChangedEvent=e===!0},t.prototype.isDataLoaded=function(){var e=this._getDataViewInst();return e.isLoaded()},t.prototype.isOwnDataView=function(){return this._isOwnDataView},t.prototype.getFieldsInfo=function(){var e=this._getDataViewInst(),t=e.getProperties(),r={};return n.each(t,function(e,t){r[t.name]={name:t.name,type:t.type||"string"}}),r},t.prototype.isBoundedToDOM=function(){return this._domSource!==null},t.prototype.load=function(t){this._userData=t;var n=this._getDataViewInst();n||(this._createDataViewWrapper(),n=this._getDataViewInst()),this._onDataViewLoading();var r=new e.grid.settingsManager(this._wijgrid);if(this._needToLoad(r)){var i=r.MapWGToDV(),s=!1;this._isWijdatasource&&!this._isDynamicWijdatasource&&n.isLoaded()&&(s=!0),n.refresh(i,s)}else this.isDataLoaded()&&(this._onDataViewLoaded(),this._onDataViewReset())},t.prototype.currentPosition=function(e){var t=this._getDataViewInst();if(!arguments.length)return t.currentPosition();this.ignoreCurrentChangedEvent(!0);try{t.currentPosition(e)}finally{this.ignoreCurrentChangedEvent(!1)}},t.prototype.getValue=function(e,t){var n=this._getDataViewInst();return typeof t=="number"&&(t+=""),n.getProperty(e,t)},t.prototype.setValue=function(e,t,n){var r=this._getDataViewInst();this.ignoreChangeEvent(!0);try{typeof t=="number"&&(t+=""),r.setProperty(e,t,n)}finally{this.ignoreChangeEvent(!1)}},t.prototype.makeDirty=function(){this._propChangeListener.removeAll(),this._totals=null,this._sharedDataItems=null},t.prototype._createDataViewWrapper=function(){var t,r=this._wijgrid.options.data,i=this._getDataViewInst(),s=!1;if(i)return;r||(this._domSource=this._processDOM(this._wijgrid.element,this._wijgrid.options.readAttributesFromData),r=this._domSource.items),s=typeof wijdatasource!="undefined"&&r instanceof wijdatasource,this._isOwnDataView=n.isArray(r)||s,this._isWijdatasource=!!this._isOwnDataView&&!!s,this._isDynamicWijdatasource=!!(this._isOwnDataView&&s&&r.dynamic),this._isOwnDataView?(!this._domSource&&this._wijgrid.options.readAttributesFromData&&this._moveAttributesToExpando(r),i=e.grid.GridDataView.create(e.data.asDataView(r))):i=r,this._wijgrid._wijDataView=i,this._toDispose.push(i.isLoading.subscribe(n.proxy(this._onDataViewLoadingInternal,this))),this._toDispose.push(i.isLoaded.subscribe(n.proxy(this._onDataViewLoadedInternal,this))),this._toDispose.push(i.subscribe(n.proxy(this._onDataViewChangeInternal,this))),this._toDispose.push(i.currentPosition.subscribe(n.proxy(this._onDataViewCurrentChangedInternal,this))),this._propChangeListener=new e.grid.propChangeListener(n.proxy(this._onPropertyChanged,this))},t.prototype._getDataViewInst=function(){return this._wijgrid._wijDataView},t.prototype._needToLoad=function(e){var t=this._getDataViewInst();return this._isDynamicWijdatasource||this._isWijdatasource&&!t.isLoaded()?!0:this._isOwnDataView&&!this._isWijdatasource&&this.isDataLoaded()?!0:this.isDataLoaded()||t.isLoading()?!e.compareSettings():!1},t.prototype._validateSettings=function(e){if(!this._isOwnDataView&&this._wijgrid.options.allowPaging&&(e.DVPagingSettings()||{}).pageSize!==(e.WGPagingSettings()||{}).pageSize)throw"The pageSize option of the external dataView can't be changed."},t.prototype._onDataViewLoadingInternal=function(e){if(this._ignoreAllEvents)return;e&&(this._userData||this._onDataViewLoading())},t.prototype._onDataViewLoadedInternal=function(e){if(this._ignoreAllEvents)return;e&&this._onDataViewLoaded()},t.prototype._onDataViewChangeInternal=function(e){var t=this;if(this._ignoreAllEvents||this._ignoreChangeEvent)return;if(e.changes){if(e.length&&e[0].entityState()==="detached")return;n.each(e.changes,function(e,n){switch(n.changeType){case"remove":t._propChangeListener.remove(n.index);break;case"add":t._propChangeListener.insert(n.index,n.element)}})}this._onDataViewChange.apply(this,arguments)},t.prototype._onDataViewCurrentChangedInternal=function(){if(this._ignoreAllEvents||this._ignoreCurrentChangedEvent)return;this._onDataViewCurrentChanged.apply(this,arguments)},t.prototype._onDataViewReset=function(){try{this.makeDirty(),this._wijgrid._onDataViewReset(this._userData)}finally{this._userData=null}},t.prototype._onPropertyChanged=function(e){var t=this;this._changeTimer>0&&(window.clearTimeout(this._changeTimer),this._changeTimer=0),this._changeTimer!=-1&&(this._changeTimer=window.setTimeout(function(){t._changeTimer=-1,t._wijgrid._destroyed||t._onDataViewChange(),t._changeTimer=0},100))},t.prototype._onDataViewChange=function(e){this._onDataViewReset()},t.prototype._onDataViewCurrentChanged=function(e,t){this._wijgrid._onDataViewCurrentPositionChanged(e,t)},t.prototype._onDataViewLoading=function(){this._wijgrid._onDataViewLoading()},t.prototype._onDataViewLoaded=function(){this._wijgrid._onDataViewLoaded()},t.prototype._getSharedDataItems=function(){if(!this._sharedDataItems){var e=this._getDataViewInst(),t=e.count();this._sharedDataItems=[];for(var n=0;n<t;n++){var r=e.item(n);this._propChangeListener.insert(n,r),this._sharedDataItems.push(this._wrapDataItem(r,n))}}return this._sharedDataItems||(this._sharedDataItems=[]),this._sharedDataItems},t.prototype._getTotals=function(){if(!this._totals){var e=this._getDataViewInst();this._totals=this._prepareTotals(e,this._wijgrid._prepareTotalsRequest(!0))}return this._totals||(this._totals={}),this._totals},t.prototype._prepareTotals=function(t,n){if(!n||n.length===0)return{};var r,i,s,o,u=[],a={};for(r=0,i=n.length;r<i;r++)u.push(new e.grid.tally);for(r=0,i=t.count();r<i;r++)for(s=0,o=u.length;s<o;s++)u[s].add(this._wijgrid._parse(n[s].column,this.getValue(r,n[s].column.dataKey)));for(r=0,i=u.length;r<i;r++)a[n[r].column.dataKey]=u[r].getValueString(n[r].column);return a},t.prototype._processDOM=function(t,r){var i={items:[],emptyData:[],header:e.grid.readTableSection(t,e.grid.rowScope.head)};return e.grid.getTableSectionLength(t,2)===1&&n(e.grid.getTableSectionRow(t,2,0)).hasClass("wijmo-wijgrid-emptydatarow")?i.emptyData=e.grid.readTableSection(t,e.grid.rowScope.body):i.items=e.grid.readTableSection(t,e.grid.rowScope.body,r),i},t.prototype._moveAttributesToExpando=function(t){n.each(t,function(t,r){var i=e.data.Expando.getFrom(r,!0),s;s=i[e.grid.EXPANDO]={cellsAttributes:{},rowAttributes:{}},r.rowAttributes&&(s.rowAttributes=r.rowAttributes,delete r.rowAttributes),n.each(r,function(e,t){n.isArray(t)&&(s.cellsAttributes[e]=t[1],r[e]=t[0])})})},t.prototype._wrapDataItem=function(e,t){return{values:e,originalRowIndex:t}},t.prototype._refreshSilent=function(){var e=this._getDataViewInst();if(e)try{this._ignoreAllEvents=!0,e.refresh()}finally{this._ignoreAllEvents=!1}},t.prototype._unsafeReplace=function(t,n){var r=this._getDataViewInst();r instanceof e.grid.GridDataView||"operation is not supported",r._unsafeReplace(t,n)},t.prototype._unsafeSplice=function(t,n,r){var i=this._getDataViewInst();i instanceof e.grid.GridDataView||"operation is not supported",arguments.length===2?i._unsafeSplice(t,n):i._unsafeSplice(t,n,r)},t.prototype._unsafePush=function(t){var n=this._getDataViewInst();n instanceof e.grid.GridDataView||"operation is not supported",n._unsafePush(t)},t}();t.dataViewWrapper=r,t.asPagedDataView=i,t.asEditableDataView=s;var o=function(){function e(e){this._subscriptions=[],this._callback=e}return e.prototype.insert=function(e,t){var r=[],i=this;this._subscriptions.splice(e,0,r),n.each(t,function(e,t){i._isValidPropName(e)&&t&&n.isFunction(t.subscribe)&&r.push(t.subscribe(i._callback))})},e.prototype.remove=function(e){var t=this._subscriptions[e];t&&n.each(t,function(e,n){n.dispose(),t[e]=null}),this._subscriptions[e]=null,this._subscriptions.splice(e,1)},e.prototype.removeAll=function(){var e,t;while(e=this._subscriptions.length)this.remove(e-1);this._subscriptions=[]},e.prototype.dispose=function(){this.removeAll()},e.prototype._isValidPropName=function(e){return e&&typeof e=="string"?e.match("^entityState|jQuery")===null:!0},e}();t.propChangeListener=o})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(t,n,r,i,s){this.cr=new e.grid.cellRange(-1,-1),this.isExpanded=!1,this._value=-1,this._sum=-1,this._position="none",this._hasHeaderOrFooter=!0,t!==undefined&&(this.isExpanded=t),n!==undefined&&(this.cr=n),r!==undefined&&(this._sum=r),i!==undefined&&(this._position=i),s!==undefined&&(this._hasHeaderOrFooter=s)}return t.prototype.isSubRange=function(e){return this.cr.r1>=e.cr.r1&&this.cr.r2<=e.cr.r2},t.prototype.toString=function(){return this.cr.r1+"-"+this.cr.r2},t.prototype.getHeaderImageClass=function(t){var n=this.owner;return n?t?n.expandedImageClass||e.c1field.prototype.options.groupInfo.expandedImageClass:n.collapsedImageClass||e.c1field.prototype.options.groupInfo.collapsedImageClass:null},t.prototype.collapse=function(){var t,n,r,i,s;(t=this.owner)&&(n=t.owner)&&(r=n.owner)&&(i=r._field("leaves"),e.grid.groupHelper.isParentExpanded(i,this.cr,t.level)&&t.position!=="footer"&&t.outlineMode!=="none"&&(s=e.grid.groupHelper.getGroupedColumnsCount(i),this._collapse(r._rows(),i,this,s,r._field("viewRenderBounds").start)))},t.prototype.expand=function(t){var n,r,i,s,o;(n=this.owner)&&(r=n.owner)&&(i=r.owner)&&(s=i._field("leaves"),e.grid.groupHelper.isParentExpanded(s,this.cr,n.level)&&(o=e.grid.groupHelper.getGroupedColumnsCount(s),this._expand(i._rows(),s,this,o,t,!0,i._field("viewRenderBounds").start)))},t.prototype._collapse=function(t,n,r,i,s){var o=r.owner,u=r.cr.r1,a=r.cr.r2,f,l,c,h,p;switch(o.position){case"header":case"headerAndFooter":this._toggleRowVisibility(t.item(r.cr.r1-s),undefined,!1),u++}for(f=u;f<=a;f++)this._toggleRowVisibility(t.item(f-s),!1);r.isExpanded=!1,this._updateHeaderIcon(t,r,s);for(f=o.level+1;f<=i;f++){c=e.grid.groupHelper.getChildGroupRanges(n,r.cr,f-1);for(p=0,l=c.length;p<l;p++){h=c[p],h.isExpanded=!1;switch(h.owner.position){case"header":case"headerAndFooter":this._toggleRowVisibility(t.item(h.cr.r1-s),undefined,!1)}this._updateHeaderIcon(t,h,s)}}},t.prototype._expand=function(t,n,r,i,s,o,u){var a=r.owner,f=r.cr.r1,l=r.cr.r2,c,h,p,d,v;switch(a.position){case"header":this._toggleRowVisibility(t.item(f-u),!0,o||s),f++;break;case"footer":this._toggleRowVisibility(t.item(l-u),!0),l--;break;case"headerAndFooter":this._toggleRowVisibility(t.item(f-u),!0,o||s),o&&this._toggleRowVisibility(t.item(l-u),!0),f++,l--}if(!o)return;r.isExpanded=!0,this._updateHeaderIcon(t,r,u);if(r.owner.level===i)for(c=f;c<=l;c++)this._toggleRowVisibility(t.item(c-u),!0);else{p=e.grid.groupHelper.getChildGroupRanges(n,r.cr,r.owner.level);if(p.length&&f!==p[0].cr.r1)for(c=f;c<p[0].cr.r1;c++)this._toggleRowVisibility(t.item(c-u),!0);if(s)for(c=0,h=p.length;c<h;c++)d=p[c],this._expand(t,n,d,i,s,!0,u);else for(c=0,h=p.length;c<h;c++)d=p[c],v=d.owner.position==="footer"||d.owner.outlineMode==="none"?!0:!1,this._expand(t,n,d,i,!1,v,u)}},t.prototype._toggleRowVisibility=function(e,t,n){e&&(e[0]&&(t!==undefined&&(e[0].style.display=t?"":"none",e[0]["aria-hidden"]=t?"false":"true"),n!==undefined&&(e[0]["aria-expanded"]=n?"true":"false")),e[1]&&(t!==undefined&&(e[1].style.display=t?"":"none",e[1]["aria-hidden"]=t?"false":"true"),n!==undefined&&(e[1]["aria-expanded"]=n?"true":"false")))},t.prototype._updateHeaderIcon=function(e,t,r){if(t.owner.position!=="footer"){var i,s=e.item(t.cr.r1-r);s&&s[0]&&(i=n(s[0]).find("div.wijmo-wijgrid-grouptogglebtn:first-child")),i&&i.length&&(i.toggleClass(t.getHeaderImageClass(!t.isExpanded),!1),i.toggleClass(t.getHeaderImageClass(t.isExpanded),!0))}},t}();t.groupRange=r;var i=function(){function t(){this._groupRowIdx=0}return t.prototype.group=function(e,t,r){this._grid=e,this._data=t,this._leaves=r,this._groupRowIdx=0;var i=1,s,o,u,a=[],f=!1,l=0;for(s=0,o=r.length;s<o;s++)u=r[s],u.groupInfo&&(delete u.groupInfo.level,delete u.groupInfo.expandInfo),u.groupInfo&&u.groupInfo.position&&u.groupInfo.position!=="none"&&u.dataIndex>=0?u.groupedIndex===undefined&&(f=!0):u.groupedIndex!==undefined&&delete u.groupedIndex;if(f)for(s=0,o=r.length;s<o;s++)u=r[s],u.groupInfo&&u.groupInfo.position&&u.groupInfo.position!=="none"&&u.dataIndex>=0&&(u.groupedIndex=l++,a.push(u));else a=n.map(r,function(e){return e.groupedIndex!==undefined?e:null}),a.sort(function(e,t){return e.groupedIndex-t.groupedIndex}),n.each(a,function(e,t){t.groupedIndex=e});e._field("groupedColumns",a);for(s=0,o=a.length;s<o;s++)u=a[s],this._groupRowIdx=0,u.groupInfo&&u.groupInfo.position&&u.groupInfo.position!=="none"&&u.dataIndex>=0&&(u.groupInfo.level=i,u.groupInfo.expandInfo=[],this._processRowGroup(u,i++));delete this._grid,delete this._data,delete this._leaves},t.prototype._processRowGroup=function(t,r){var i,s,o,u,a,f,l,c,h,p,d=0,v=!0;n.each(this._leaves,function(e,t){if(t.parentVis)return d=e,!1});for(i=0;i<this._data.length;i++){if(!(this._data[i].rowType&e.grid.rowType.data))continue;s=this._getGroupCellRange(i,t,r),o=!0,u=t.groupInfo.outlineMode==="startCollapsed";if(u||e.grid.groupHelper.isParentCollapsed(this._leaves,s,r)){if(t.groupInfo.groupSingleRow===!1&&s.r1===s.r2)continue;o=!1}if(r&&this._grid.options.groupIndent)for(a=s.r1;a<=s.r2;a++)this._addIndent(this._data[a][d],r);v=t.groupInfo.groupSingleRow!==!1||s.r1!==s.r2;switch(t.groupInfo.position){case"header":f=this._addGroupRange(t.groupInfo,s,o,v);for(p=s.r1;p<=s.r2;p++)this._data[p].__attr["aria-level"]=r+1,o||(this._data[p].__style.display="none",this._data[p].__attr["aria-hidden"]=!0);if(!v)break;this._updateByGroupRange(f,r),l=e.grid.groupHelper.isParentCollapsed(this._leaves,f.cr,r),c=this._buildGroupRow(f,s,!0,l),this._data.splice(s.r1,0,c),c.__attr["arial-level"]=r,c.__attr["aria-expanded"]=o,l&&(c.__style.display="none",c.__attr["aria-hidden"]=!0),i=s.r2+1;break;case"footer":f=this._addGroupRange(t.groupInfo,s,!0,v);if(!v)break;this._updateByGroupRange(f,r),h=this._buildGroupRow(f,s,!1,!1),h.__attr["aria-level"]=r,this._data.splice(s.r2+1,0,h),i=s.r2+1,l=e.grid.groupHelper.isParentCollapsed(this._leaves,f.cr,r),l&&(h.__style.display="none",h.__attr["aria-hidden"]=!0);break;case"headerAndFooter":f=this._addGroupRange(t.groupInfo,s,o,v);for(p=s.r1;p<=s.r2;p++)this._data[p].__attr["aria-level"]=r+1,o||(this._data[p].__style.display="none",this._data[p].__attr["aria-hidden"]=!0);if(!v)break;this._updateByGroupRange(f,r),l=e.grid.groupHelper.isParentCollapsed(this._leaves,f.cr,r),c=this._buildGroupRow(f,s,!0,l),h=this._buildGroupRow(f,s,!1,!1),this._data.splice(s.r2+1,0,h),h.__attr["aria-level"]=r;if(l||!o)h.__style.display="none",h.__attr["aria-hidden"]=!0;this._data.splice(s.r1,0,c),c.__attr["aria-level"]=r,c.__attr["aria-expanded"]=o,l&&(c.__style.display="none",c.__attr["aria-hidden"]=!0),i=s.r2+2;break;default:throw e.grid.stringFormat('Unknown Position value: "{0}"',t.groupInfo.position)}this._groupRowIdx++}},t.prototype._buildGroupRow=function(t,n,r,i){var s=t.owner,o=s.owner,u=o.owner,a=[],f="",l="",c,h,p,d,v,m,g,y;a.__style={},a.__attr={},a.__attr.id=(r?"GH":"GF")+this._groupRowIdx+"-"+s.level,a.rowType=r?e.grid.rowType.groupHeader:e.grid.rowType.groupFooter,o.dataIndex>=0&&(c=this._data[n.r1][o.dataIndex].value)!==null&&(f=u._toStr(o,c)),this._grid.options.showRowHeader&&a.push({html:"&nbsp;"}),h={html:"",__attr:{},__style:{}},r&&s.outlineMode!=="none"&&(t.isExpanded?h.html='<div class="'+u.options.wijCSS.icon+" "+t.getHeaderImageClass(!0)+' wijmo-wijgrid-grouptogglebtn">&nbsp;</div>':h.html='<div class="'+u.options.wijCSS.icon+" "+t.getHeaderImageClass(!1)+' wijmo-wijgrid-grouptogglebtn">&nbsp;</div>'),a.push(h),o.aggregate&&o.aggregate!=="none"&&(l=this._getAggregate(n,o,o,r,f)),p=r?s.headerText:s.footerText;if(p==="custom")d={data:this._data,column:o,groupByColumn:s.owner,groupText:f,text:"",groupingStart:n.r1,groupingEnd:n.r2,isGroupHeader:r,aggregate:l},this._grid._trigger("groupText",null,d)&&(p=d.text);else{if(p===undefined||p===null){r&&(p="{1}: {0}");if(l||l===0)p=p?p+" {2}":"{2}"}p=e.grid.stringFormat(p,f,o&&o.headerText?o.headerText:"",l.toString())}p||(p="&nbsp;"),h.html+="<span>"+p+"</span>",this._addIndent(h,s.level-1),v=1,m=this._grid.options.showRowHeader?1:0,g=!0;for(;m<this._leaves.length;m++){c=this._leaves[m];if(c.parentVis){if(g){g=!1;continue}if(c.dynamic!==!0&&c.aggregate&&c.aggregate!=="none")break;v++}}for(;m<this._leaves.length;m++)c=this._leaves[m],c.parentVis&&(y=this._getAggregate(n,c,s.owner,r,f),!y&&y!==0&&(y="&nbsp;"),a.push({html:y.toString(),__attr:{groupInfo:{leafIndex:c.leavesIdx,purpose:e.grid.groupRowCellPurpose.aggregateCell}}}));return h.__attr.colSpan=v,h.__attr.groupInfo={leafIndex:o.leavesIdx,purpose:e.grid.groupRowCellPurpose.groupCell},a},t.prototype._getAggregate=function(t,n,r,i,s){var o="",u,a,f;if(!n.aggregate||n.aggregate==="none")return o;if(n.aggregate==="custom")u={data:this._data,column:n,groupByColumn:r,groupText:s,text:"",groupingStart:t.r1,groupingEnd:t.r2,isGroupHeader:i},this._grid._trigger("groupAggregate",null,u)&&(o=u.text);else{a=new e.grid.tally;for(f=t.r1;f<=t.r2;f++)a.add(this._data[f][n.dataIndex].value);o=a.getValueString(n)}return o},t.prototype._getGroupCellRange=function(t,n,r){var i=n.leavesIdx,s=new e.grid.cellRange(t,i),o=e.grid.groupHelper.getParentGroupRange(this._leaves,s,r),u,a,f;if(this._data[t].rowType&e.grid.rowType.data){u=this._data[t][n.dataIndex].value,u instanceof Date&&(u=u.getTime());for(s.r2=t,f=this._data.length-1;s.r2<f;s.r2++){if(!(this._data[s.r2+1].rowType&e.grid.rowType.data)||o&&s.r2+1>o.cr.r2)break;a=this._data[s.r2+1][n.dataIndex].value,a instanceof Date&&(a=a.getTime());if(u!==a)break}}return s},t.prototype._addGroupRange=function(t,n,r,i){var s=null,o=e.grid.groupHelper.getChildGroupIndex(n,t.expandInfo),u,a,f,l;return o>=0&&o<t.expandInfo.length?s=t.expandInfo[o]:(u=new e.grid.cellRange(n.r1,n.r1,n.r2,n.r2),a=t.position==="footer"||!i?!0:r&&t.outlineMode!=="startCollapsed",s=new e.grid.groupRange(a,u,-1,t.position,i),s.owner=t,t.expandInfo.push(s)),s&&i&&(f=n.r1,l=n.r2,t.position==="headerAndFooter"&&(l+=2),t.position!=="headerAndFooter"&&l++,s.cr.r2=l),s},t.prototype._updateByGroupRange=function(e,t){var n,r,i,s,o,u,a;for(n=0,r=this._leaves.length;n<r;n++){i=this._leaves[n].groupInfo;if(i&&i.level<t){s=i.expandInfo?i.expandInfo.length:0;for(o=0;o<s;o++)u=i.expandInfo[o],a=e.position==="headerAndFooter"?2:1,u.cr.r1>=e.cr.r1&&(u.cr.r1!==e.cr.r1||u.position!=="footer")&&(u.cr.r1+=a),u.cr.r2>=e.cr.r1&&(u.cr.r2+=a)}}},t.prototype._addIndent=function(e,t){var n;t>0&&(n=this._grid.options.groupIndent)&&(e.__style.paddingLeft=n*t+"px")},t}();t.grouper=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(){}return t._getGroupInfoRegExp=new RegExp(".*G([HF]){1}(\\d+)-(\\d+)$"),t.getGroupInfo=function(n){if(n){var r=e.grid.groupHelper._getGroupInfoRegExp.exec(n.id),i,s,o;if(r)return i=parseInt(r[3],10),s=parseInt(r[2],10),o=r[1]==="H",{level:i,index:s,isHeader:o,toString:function(){return(o?"GH":"GF")+s+"-"+i}}}return null},t.getColumnByGroupLevel=function(t,n){var r,i,s;for(r=0,i=t.length;r<i;r++){s=t[r];if(s.groupInfo&&s.groupInfo.level===n)return s}return null},t.getGroupedColumnsCount=function(t){var n=0,r,i,s;for(r=0,i=t.length;r<i;r++)s=t[r].groupInfo,s&&(s.position==="header"||s.position==="headerAndFooter"||s.position==="footer")&&n++;return n},t.getChildGroupIndex=function(t,n){var r=0,i=n.length-1,s,o;while(r<=i){s=(i-r>>1)+r,o=n[s].cr.r1-t.r1;if(o===0)return s;o<0?r=s+1:i=s-1}return r},t.getParentGroupIndex=function(n,r){var i=e.grid.groupHelper.getChildGroupIndex(n,r);return i>0&&i--,i<r.length?i:-1},t.getChildGroupRanges=function(n,r,i){var s=[],o,u,a,f,l,c=e.grid.groupHelper.getColumnByGroupLevel(n,i+1);if(c){o=c.groupInfo.expandInfo,l=e.grid.groupHelper.getChildGroupIndex(r,o);for(a=l,f=o.length;a<f;a++){u=o[a];if(!(u.cr.r2<=r.r2))break;s.push(u)}}return s},t.getParentGroupRange=function(n,r,i){var s,o,u;i===undefined&&(i=65535);if(i-2>=0)for(s=n.length-1;s>=0;s--){o=n[s].groupInfo;if(!o||!o.expandInfo||o.level<0||o.level!==i-1)continue;u=e.grid.groupHelper.getParentGroupIndex(r,o.expandInfo);if(u>=0)return o.expandInfo[u]}return null},t.isParentCollapsed=function(n,r,i){var s,o;if(i===1)return!1;for(s=i;s>1;s--){o=e.grid.groupHelper.getParentGroupRange(n,r,s);if(o&&!o.isExpanded)return!0;r=o.cr}return!1},t.isParentExpanded=function(n,r,i){var s,o;if(i===1)return!0;for(s=i;s>1;s--){o=e.grid.groupHelper.getParentGroupRange(n,r,s);if(o&&o.isExpanded)return!0;r=o.cr}return!1},t}();t.groupHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function e(e,t,n,r){switch(arguments.length){case 2:this.r1=this.r2=e,this.c1=this.c2=t;break;case 4:this.r1=e,this.r2=n,this.c1=t,this.c2=r;break;default:this.r1=0,this.r2=0,this.c1=0,this.c2=0}}return e.prototype.isSingleCell=function(){return this.r1===this.r2&&this.c1===this.c2},e}();t.cellRange=r;var i=function(){function t(){}return t.prototype.merge=function(e,t){this._leaves=t,this._data=e;var n,r,i;for(n=0,r=this._leaves.length;n<r;n++)i=this._leaves[n],i.dataIndex>=0&&!i.isBand&&(i.rowMerge==="free"||i.rowMerge==="restricted")&&this._mergeColumn(i);delete this._data,delete this._leaves},t.prototype._mergeColumn=function(t){var n=t.dataIndex,r,i,s,o,u;for(r=0,i=this._data.length;r<i;r++){if(!(this._data[r].rowType&e.grid.rowType.data))continue;s=this._getCellRange(r,t);if(s.r1!==s.r2){o=s.r2-s.r1+1,this._data[s.r1][n].__attr.rowSpan=o;for(u=s.r1+1;u<=s.r2;u++)this._data[u][n].visible=!1}r=s.r2}},t.prototype._getCellRange=function(t,n){var r=n.dataIndex,i=new e.grid.cellRange(t,r),s=(this._data[t][r].value||"").toString(),o=this._data.length,u,a,f,l;for(i.r2=t;i.r2<o-1;i.r2++){u=this._data[i.r2+1];if(!(u.rowType&e.grid.rowType.data)||(u[r].value||"").toString()!==s)break}return a=n.leavesIdx,a>0&&n.rowMerge==="restricted"&&(f=this._leaves[a-1],f.dataIndex>=0&&(l=this._getCellRange(t,f),i.r1=Math.max(i.r1,l.r1),i.r2=Math.min(i.r2,l.r2))),i},t}();t.merger=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function f(t,r){var i,s,o;if(n.isArray(t)&&n.isArray(r)){if(t.length===r.length){o=!0;for(i=0,s=t.length;i<s&&o;i++)o=e.grid.compareObj(t[i],r[i]);return o}}else{if(n.isPlainObject(t)&&n.isPlainObject(r)){for(i in t)if(t.hasOwnProperty(i)&&!e.grid.compareObj(t[i],r[i]))return!1;for(i in r)if(r.hasOwnProperty(i)&&!e.grid.compareObj(t[i],r[i]))return!1;return!0}t instanceof Date&&(t=t.getTime()),r instanceof Date&&(r=r.getTime())}return t===r}function l(e){var t=[];for(var n=0;n<arguments.length-1;n++)t[n]=arguments[n+1];var r,i;if(!e)return"";for(r=0,i=t.length;r<i;r++)e=e.replace(new RegExp("\\{"+r+"\\}","gm"),t[r]);return e}function c(e){return e&&!(e<0)||e===0}function h(e){return e.dataType||e._underlyingDataType||"string"}function p(e,t){e&&t&&e.find(".ui-widget").each(function(e,r){return n.each(n(r).data(),function(n,r){r.widgetName&&t(e,r)}),!0})}function d(e,t){var r=[];n.each(e.data(),function(e){e.indexOf(t)===0&&r.push(e)}),n.each(r,function(t,n){e.removeData(n)})}function m(t){return n.extend(!0,{},e.c1basefield.prototype.options,e.c1field.prototype.options,{dynamic:!0,isLeaf:!0,isBand:!1,parentIdx:-1},t)}function g(e,t){if(e){var r=e.nodeType?n(e):e,i=r.offset();if(i)return t?{top:i.top,left:i.left,width:r[0].clientWidth||0,height:r[0].clientHeight||0}:{top:i.top,left:i.left,width:r.outerWidth(),height:r.outerHeight()}}return null}function y(t,n,r){n===undefined&&(n=3);if(t&&n!==0){if(!r&&t.nodeType===3)return t.nodeValue;if(t.nodeType===1){switch(t.type){case"button":case"text":case"textarea":case"select-one":return t.value;case"checkbox":return t.checked.toString()}var i="",s=0,o;while(o=t.childNodes[s++])i+=e.grid._getDOMText(o,n-1);return i}}return""}function b(e,t,r,i){var s=e.jquery||n.isArray(e),o,u,a,f=t+r;if(arguments.length===3)return s?n.data(e[0],f):n.data(e,f);if(s){for(o=0,u=e.length;o<u;o++)a=n.data(e[o],f,i);return a}return n.data(e,f,i)}function w(e,t){if(t&&e){var n,r,i;for(n in t)t.hasOwnProperty(n)&&(r=t[n],i=typeof r,(i==="string"||i==="boolean"||i==="number")&&e[n]===undefined&&(e[n]=r))}}function E(e){return e&&typeof e=="object"&&!(e instanceof Date)}function S(e,t){var r,i,s=n.isFunction(t);for(r in e)if(e.hasOwnProperty(r)){i=s?t(e[r]):e[r]===t;if(i===!0)return{at:r,found:e[r]}}return{at:null,found:null}}function x(e,t){if(e){var n,r,i=0,s={},o,u;for(n=0,r=e.attributes.length;n<r;n++)u=e.attributes[n].name,u&&(!t||!t(u))&&(o=e.getAttribute(u),u==="style"&&(o=typeof o=="object"?o.cssText:o),!o&&u==="class"&&(o=e.getAttribute("className")),o&&typeof o!="function"&&(s[u]=o,i++));if(i)return s}return null}function T(t,r){var i,s,o,u,a;if(t){typeof r!="object"&&!n.isFunction(r)&&(r={});for(i in t){s=t[i],o=r[o];if(s===r)continue;s&&(n.isPlainObject(s)||(u=n.isArray(s)))?(u?(u=!1,a=o&&n.isArray(o)?o:[]):a=o&&n.isPlainObject(o)?o:{},r[i]=e.grid.deepExtend(s,a)):r[i]=s}}return r}function N(){if(n.ui&&n.ui.keyCode)return n.ui.keyCode;if(n.mobile&&n.mobile.keyCode)return n.mobile.keyCode;throw"keyCode object is not found"}function C(e,t){return e&&e.jquery&&(e=e[0]),e?arguments.length===1?n.data(e,"wijgridwidgetName"):n.data(e,"wijgridwidgetName",t):undefined}function k(e,t,n){return e>t&&e<t+n}function L(t,n,r,i,s,o){return e.grid.isOverAxis(t,r,s)&&e.grid.isOverAxis(n,i,o)}function O(){return"uid"+A++}var n=jQuery;t.EXPANDO="__wijgrid",function(e){e._map=[],e.header=1,e.data=2,e.dataAlt=4,e.filter=8,e.groupHeader=16,e.groupFooter=32,e.footer=64,e.emptyDataRow=128}(t.rowType||(t.rowType={}));var r=t.rowType;(function(e){e._map=[],e.none=0,e.rendering=1,e.current=2,e.hovered=4,e.selected=8})(t.renderState||(t.renderState={}));var i=t.renderState;(function(e){e._map=[],e.table=0,e.head=1,e.body=2,e.foot=3})(t.rowScope||(t.rowScope={}));var s=t.rowScope;(function(e){e._map=[],e.none=0,e.toColumn=1,e.toRow=2})(t.cellRangeExtendMode||(t.cellRangeExtendMode={}));var o=t.cellRangeExtendMode;(function(e){e._map=[],e.createIfNull=0,e.createAlways=1,e.dispose=2})(t.objectMode||(t.objectMode={}));var u=t.objectMode;(function(e){e._map=[],e.groupCell=0,e.aggregateCell=1})(t.groupRowCellPurpose||(t.groupRowCellPurpose={}));var a=t.groupRowCellPurpose;t.compareObj=f,t.stringFormat=l,t.validDataKey=c,t.getDataType=h,t.iterateChildrenWidgets=p,t.remove$dataByPrefix=d;var v=function(){function e(e){this._dom=e}return e.prototype.getSelection=function(){var e=0,t=0,n;return this._dom.selectionStart!==undefined?(e=this._dom.selectionStart,t=this._dom.selectionEnd):document.selection&&(n=document.selection.createRange().duplicate(),t=n.text.length,e=Math.abs(n.moveStart("character",-this._dom.value.length)),t+=e),{start:e,end:t,length:t-e}},e.prototype.setSelection=function(e){if(this._dom.selectionStart!==undefined)this._dom.setSelectionRange(e.start,e.end);else{var t=this._dom.createTextRange();t.collapse(!0),t.moveStart("character",e.start),t.moveEnd("character",e.end),t.select()}},e.prototype.toggleSelection=function(e){var t=n(this._dom),r="onselectstart"in this._dom;e?r?t.unbind(".wijgrid-disableSelection"):t.css({MozUserSelect:"",WebkitUserSelect:""}):r?t.bind("selectstart.wijgrid-disableSelection",function(e){e.preventDefault()}):t.css({MozUserSelect:"-moz-none",WebkitUserSelect:"none"})},e}();t.domSelection=v,t.createDynamicField=m,t.bounds=g,t._getDOMText=y,t.dataPrefix=b,t.shallowMerge=w,t.isCustomObject=E,t.search=S,t.getAttributes=x,t.deepExtend=T,t.getKeyCodeEnum=N,t.widgetName=C,t.isOverAxis=k,t.isOver=L;var A=0;t.getUID=O,n.extend(n.wijmo.wijgrid,{rowType:e.grid.rowType,renderState:e.grid.renderState,bounds:e.grid.bounds})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function e(){}return e.NoFilterOp={applicableTo:null,name:"NoFilter",arity:1,operator:function(){return!0}},e}(),i=function(){function t(t){this._cache={};var i=this;this._wijgrid=t,this._addOperator(null,r.NoFilterOp),n.each(e.data.filtering.ops,function(e,t){i._addOperator(e,t)}),n.each(t.options.customFilterOperators,function(e,t){i._addOperator(null,t,!0)})}return t.prototype.getByName=function(e){var t=this.getByNameInt(e);return t?t.op:null},t.prototype.getByNameInt=function(e){return this._cache[(e||"").toLowerCase()]},t.prototype.getByDataType=function(e){var t=[],r;n.each(this._cache,function(r,i){var s=i.op;(!s.applicableTo||n.inArray(e,s.applicableTo)>=0)&&t.push(i)});switch(this._wijgrid.options.filterOperatorsSortMode.toLowerCase()){case"alphabetical":t.sort(this._sortAlpha);break;case"alphabeticalcustomfirst":t.sort(this._sortAlphaCustomFirst);break;case"alphabeticalembeddedFirst":t.sort(this._sortAlphaEmbeddedFirst);break;case"none":break;default:}return r=n.map(t,function(e,t){return e.op}),r},t.prototype._addOperator=function(e,t,n){typeof n=="undefined"&&(n=!1),e&&!t.name&&(t.name=e),e=(e||t.name).toLowerCase(),this._cache[e]||(this._cache[e]={op:t,isCustom:n===!0})},t.prototype._sortAlpha=function(e,t){var n=e.op.name.toLowerCase(),r=t.op.name.toLowerCase();if(n!==r){if(n==="nofilter")return-1;if(r==="nofilter")return 1}return n===r?0:n<r?-1:1},t.prototype._sortAlphaEmbeddedFirst=function(e,t){var n=e.op.name.toLowerCase(),r=t.op.name.toLowerCase();if(n!==r){if(n==="nofilter")return-1;if(r==="nofilter")return 1}if(e.isCustom!==t.isCustom){if(e.isCustom)return 1;if(t.isCustom)return-1}return n===r?0:n<r?-1:1},t.prototype._sortAlphaCustomFirst=function(e,t){var n=e.op.name.toLowerCase(),r=t.op.name.toLowerCase();if(n!==r){if(n==="nofilter")return-1;if(r==="nofilter")return 1}if(e.isCustom!==t.isCustom){if(e.isCustom)return-1;if(t.isCustom)return 1}return n===r?0:n<r?-1:1},t}();t.filterOperatorsCache=i;var s=function(){function t(){}return t.marker="_wijgrid",t.getSingleValue=function(t){return n.isArray(t)&&(t=t[0],n.isArray(t)&&(t=t[0])),t},t.getSingleOperatorName=function(t){return n.isArray(t)&&(t=t[0]),t.name||t||""},t.verify=function(r,i,s,o){if(r)if(n.isArray(r)){var u,a,f=[],l=[];n.isArray(i)||(i=[i]);for(u=0,a=r.length;u<a;u++)e.grid.filterHelper._verifySingleOp(r[u],i[u],s,o)&&(f.push({name:r[u].name||r[u],condition:r[u].condition||"or"}),l.push(i?i[u]:undefined));if(f.length)return{filterOperator:f,filterValue:l}}else if(e.grid.filterHelper._verifySingleOp(r,i,s,o))return{filterOperator:r,filterValue:i};return null},t._verifySingleOp=function(r,i,s,o){if(r&&(r=r.name||r)){var u;r=(r||"").toLowerCase();if((r!=="nofilter"||i!==undefined)&&(u=o.getByName(r)))if(u.applicableTo===null||n.inArray(s||"string",u.applicableTo)>=0)if(u.arity===1||u.arity>1&&e.grid.filterHelper.getSingleValue(i)!==undefined)return!0}return!1},t}();t.filterHelper=s})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function r(t,n){t&&!t.nodeType&&(t=t[0]);if(t)switch(n){case e.grid.rowScope.head:return t.tHead;case e.grid.rowScope.body:if(t.tBodies)return t.tBodies[0]||null;break;case e.grid.rowScope.foot:return t.tFoot;default:return t}return null}function i(e,t){var n;return e&&!e.nodeType&&(e=e[0]),e&&(n=this.getTableSection(e,t))?n.rows.length:0}function s(e,t,n){var r;return e&&!e.nodeType&&(e=e[0]),e&&(r=this.getTableSection(e,t))?r.rows[n]||null:null}function o(t,r,i){var s,o,u,a,f,l,c,h,p=[],d=function(e){return e=e.toLowerCase(),e==="rowspan"||e==="colspan"},v;t&&!t.nodeType&&(t=t[0]);if(t&&(v=this.getTableSection(t,r)))for(s=0,o=v.rows.length;s<o;s++){f=v.rows[s],l=[],i&&(c=e.data.Expando.getFrom(l,!0),h=c[e.grid.EXPANDO]={cellsAttributes:{},rowAttributes:e.grid.getAttributes(f)||{}});for(u=0,a=f.cells.length;u<a;u++)l[u]=n.trim(f.cells[u].innerHTML),i&&(h.cellsAttributes[u]=e.grid.getAttributes(f.cells[u],d)||{});p[s]=l}return p}var n=jQuery;t.getTableSection=r,t.getTableSectionLength=i,t.getTableSectionRow=s,t.readTableSection=o;var u=function(){function t(e,t,n,r){this._width=0,this._table=e,this._offsets=[],r&&this.ensureColGroup(),n&&this.ensureTBody(),t||this._buildOffsets()}return t.prototype.element=function(){return this._table},t.prototype.width=function(){return this._width},t.prototype.getCellIdx=function(e,t){return e<this._width?this._offsets[t][e].cellIdx:-1},t.prototype.getColumnIdx=function(e,t){if(typeof e!="number"){var n=e;e=n.cellIndex,t=n.parentNode.rowIndex}return e<this._width?this._offsets[t][e].colIdx:-1},t.prototype.clearSection=function(t){var n,r,i=e.grid.getTableSection(this._table,t);switch(t){case e.grid.rowScope.body:n=this.getSectionLength(e.grid.rowScope.table),r=n+this.getSectionLength(t)-1;break;case e.grid.rowScope.foot:n=this.getSectionLength(e.grid.rowScope.table)+this.getSectionLength(e.grid.rowScope.head),r=n+this.getSectionLength(t)-1;break;default:n=0,r=this.getSectionLength(t)-1}while(i.rows.length)i.deleteRow(0);this._offsets.splice(n,r-n+1)},t.prototype.getSectionLength=function(t){return e.grid.getTableSectionLength(this._table,t)},t.prototype.getSectionRow=function(t,n){return e.grid.getTableSectionRow(this._table,n,t)},t.prototype.forEachColumnCellNatural=function(e,t,n){var r,i,s,o;for(r=0,i=this._table.rows.length;r<i;r++){s=this._table.rows[r];if(e<s.cells.length){o=t(s.cells[e],r,n);if(o!==!0)return o}}return!0},t.prototype.forEachColumnCell=function(e,t,n){var r,i,s,o,u;for(r=0,i=this._offsets.length;r<i;r++){s=this._table.rows[r],o=this.getCellIdx(e,r);if(o>=0){u=t(s.cells[o],r,n);if(u!==!0)return u}}return!0},t.prototype.forEachRowCell=function(e,t,n){var r=this._table.rows[e],i,s,o;for(i=0,s=r.cells.length;i<s;i++){o=t(r.cells[i],i,n);if(o!==!0)return o}return!0},t.prototype.colGroupTag=function(){var e=this._table.getElementsByTagName("colgroup");return e&&e[0]||null},t.prototype.colTags=function(){var e=this.colGroupTag();return e&&e.getElementsByTagName("col")||[]},t.prototype.ensureTBody=function(){return this._table.tBodies&&this._table.tBodies[0]||this._table.appendChild(document.createElement("tbody"))},t.prototype.ensureTHead=function(){return this._table.tHead&&this._table.tHead[0]||this._table.createTHead()},t.prototype.ensureTFoot=function(){return this._table.tFoot&&this._table.tFoot[0]||this._table.createTFoot()},t.prototype.ensureColGroup=function(){var e=this._table.getElementsByTagName("colgroup");return e&&e[0]||this._table.appendChild(document.createElement("colgroup"))},t.prototype.appendCol=function(e){var t=this.ensureColGroup();return e&&t.appendChild(e)||t.appendChild(document.createElement("col"))},t.prototype.removeOffset=function(e){if(e>=0&&e<this._offsets.length){if(e<0||!e&&e!==0)e=this._offsets.length-1;this._offsets.splice(e,1)}},t.prototype.insertOffset=function(e){var t,n;if(this._width>0){t=[];for(n=0;n<this._width;n++)t.push({cellIdx:n,colIdx:n});if(e<0||!e&&e!==0)e=this._offsets.length;this._offsets.splice(e,0,t)}},t.prototype.rebuildOffsets=function(){this._offsets=[],this._width=0,this._buildOffsets()},t.prototype._buildOffsets=function(){var e=[],t,n,r,i,s,o,u,a,f,l;for(n=0,r=this._table.rows.length;n<r;n++){t=[],this._offsets[n]=t,i=this._table.rows[n];for(s=0,o=0,u=i.cells.length;s<u;s++,o++){a=i.cells[s];for(;e[o]>1;o++)e[o]--,t[o]={cellIdx:-1,colIdx:-1};e[o]>1||(e[o]=a.rowSpan),t[o]={cellIdx:s,colIdx:-1},t[s].colIdx=o,f=a.colSpan;for(;f>1;f--)t[++o]={cellIdx:-1,colIdx:-1}}l=e.length;for(;o<l;o++)e[o]--,t[o]={cellIdx:-1,colIdx:-1};this._width=Math.max(this._width,l)}},t}();t.htmlTableAccessor=u})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e,t,n,r){typeof n=="undefined"&&(n=null),typeof r=="undefined"&&(r=!1),this.__isEdit=!1,this._wijgrid=n,r?(this._cia=e,this._ria=t):(this._ci=e,this._ri=t)}return t.outsideValue=new t(-1,-1,null,!0),t.prototype.cellIndexAbs=function(e){if(arguments.length===0)return this._ensureCia(),this._cia;this._ci=undefined,this._cia=e},t.prototype.rowIndexAbs=function(e){if(arguments.length===0)return this._ensureRia(),this._ria;this._ri=undefined,this._ria=e},t.prototype.cellIndex=function(e){if(arguments.length===0)return this._ensureCi(),this._ci;this._cia=undefined,this._ci=e},t.prototype.column=function(){return this._wijgrid&&this._isValid()?this._wijgrid._field("visibleLeaves")[this.cellIndexAbs()]:null},t.prototype.container=function(){var e=this.tableCell(),t;if(e){t=n(e).children("div.wijmo-wijgrid-innercell");if(t)return t}return null},t.prototype.isEqual=function(e){return e&&e.rowIndex()===this.rowIndex()&&e.cellIndex()===this.cellIndex()},t.prototype.row=function(){var e=null,t=null;return this._wijgrid&&(e=this._wijgrid._view().rows().item(this.rowIndexAbs()),e&&e.length&&(t=this._wijgrid._view()._getRowInfo(e))),t},t.prototype.rowIndex=function(e){if(arguments.length===0)return this._ensureRi(),this._ri;this._ria=undefined,this._ri=e},t.prototype.tableCell=function(){return this._wijgrid&&this._isValid()?this._wijgrid._view().getCell(this.cellIndexAbs(),this.rowIndexAbs()):null},t.prototype.value=function(t){var n,r,i;if(this._wijgrid&&this._isValid()){r=this._wijgrid._view()._getRowInfo(this._wijgrid._rows().item(this.rowIndex()));if(r.type&e.grid.rowType.data){n=this.column();if(arguments.length===0)return i=this._wijgrid._dataViewWrapper.getValue(r.data,n.dataKey),this._wijgrid._parse(n,i);t=this._wijgrid._parse(n,t);if(t===null&&n.valueRequired||e.grid.getDataType(n)!=="string"&&isNaN(t))throw"invalid value";this._wijgrid._dataViewWrapper.setValue(r.dataItemIndex,n.dataKey,t)}}},t.prototype.toString=function(){return this.cellIndex()+":"+this.rowIndex()},t.prototype._clip=function(e,t){typeof t=="undefined"&&(t=!1);var n=!1,r;return t?(this.cellIndexAbs()<(r=e.topLeft().cellIndexAbs())&&(n=!0,this._cia=r,this._ci=undefined),this.cellIndexAbs()>(r=e.bottomRight().cellIndexAbs())&&(n=!0,this._cia=r,this._ci=undefined),this.rowIndexAbs()<(r=e.topLeft().rowIndexAbs())&&(n=!0,this._ria=r,this._ri=undefined),this.rowIndexAbs()>(r=e.bottomRight().rowIndexAbs())&&(n=!0,this._ria=r,this._ri=undefined)):(this.cellIndex()<(r=e.topLeft().cellIndex())&&(n=!0,this._ci=r,this._cia=undefined),this.cellIndex()>(r=e.bottomRight().cellIndex())&&(n=!0,this._ci=r,this._cia=undefined),this.rowIndex()<(r=e.topLeft().rowIndex())&&(n=!0,this._ri=r,this._ria=undefined),this.rowIndex()>(r=e.bottomRight().rowIndex())&&(n=!0,this._ri=r,this._ria=undefined)),n},t.prototype._clone=function(){return new e.grid.cellInfo(this.cellIndex(),this.rowIndex(),this._wijgrid)},t.prototype._isValid=function(){return this.cellIndex()>=0&&this.rowIndex()>=0},t.prototype._isEdit=function(e){if(!arguments.length)return this.__isEdit;this.__isEdit=e},t.prototype._setGridView=function(e){this._wijgrid=e},t.prototype._ensureCia=function(){if(this._cia===undefined){if(this._ci===null)throw"relative index value is undefined";if(this._ci>=0){if(!this._wijgrid)throw"wijgrid is null";this._cia=this._ci+this._wijgrid._getDataToAbsOffset().x}else this._cia=this._ci;this._cia<0&&(this._cia=-1)}},t.prototype._ensureRia=function(){if(this._ria===undefined){if(this._ri===undefined)throw"relative index value is undefined";if(this._ri>=0){if(!this._wijgrid)throw"wijgrid is null";this._ria=this._ri+this._wijgrid._getDataToAbsOffset().y}else this._ria=this._ri;this._ria<0&&(this._ria=-1)}},t.prototype._ensureCi=function(){if(this._ci===undefined){if(this._cia===undefined)throw"absolute index value is undefined";if(this._cia>=0){if(!this._wijgrid)throw"wijgrid is null";this._ci=this._cia-this._wijgrid._getDataToAbsOffset().x}else this._ci=this._cia;this._ci<0&&(this._ci=-1)}},t.prototype._ensureRi=function(){if(this._ri===undefined){if(this._ria===undefined)throw"relative index value is undefined";if(this._ria>=0){if(!this._wijgrid)throw"wijgrid is null";this._ri=this._ria-this._wijgrid._getDataToAbsOffset().y}else this._ri=this._ria;this._ri<0&&(this._ri=-1)}},t}();t.cellInfo=r;var i=function(){function t(e,t){if(!e||!t)throw"invalid arguments";this._topLeft=e._clone(),this._bottomRight=t._clone()}return t.prototype.bottomRight=function(){return this._bottomRight},t.prototype.isEqual=function(e){return e&&this._topLeft.isEqual(e.topLeft())&&this._bottomRight.isEqual(e.bottomRight())},t.prototype.topLeft=function(){return this._topLeft},t.prototype.toString=function(){return this._topLeft.toString()+" - "+this._bottomRight.toString()},t.prototype._isIntersect=function(e){var t,n,r,i;if(e){t=e.bottomRight().rowIndex()-e.topLeft().rowIndex()+1,n=this._bottomRight.rowIndex()-this._topLeft.rowIndex()+1;if(e.topLeft().rowIndex()+t-this._topLeft.rowIndex()<t+n)return r=e.bottomRight().cellIndex()-e.topLeft().cellIndex()+1,i=this._bottomRight.cellIndex()-this._topLeft.cellIndex()+1,e.topLeft().cellIndex()+r-this._topLeft.cellIndex()<r+i}return!1},t.prototype._isValid=function(){return this._topLeft._isValid()&&this._bottomRight._isValid()},t.prototype._clip=function(e,t){return typeof t=="undefined"&&(t=!1),this._topLeft._clip(e,t)||this._bottomRight._clip(e,t)},t.prototype._clone=function(){return new t(this._topLeft._clone(),this._bottomRight._clone())},t.prototype._containsCellInfo=function(e){return e&&e.cellIndex()>=this._topLeft.cellIndex()&&e.cellIndex()<=this._bottomRight.cellIndex()&&e.rowIndex()>=this._topLeft.rowIndex()&&e.rowIndex()<=this._bottomRight.rowIndex()},t.prototype._containsCellRange=function(e){return e&&this._containsCellInfo(e.topLeft())&&this._containsCellInfo(e.bottomRight())},t.prototype._extend=function(t,n){return t===e.grid.cellRangeExtendMode.toColumn?(this._topLeft.rowIndex(n.topLeft().rowIndex()),this._bottomRight.rowIndex(n.bottomRight().rowIndex())):t===e.grid.cellRangeExtendMode.toRow&&(this._topLeft.cellIndex(n.topLeft().cellIndex()),this._bottomRight.cellIndex(n.bottomRight().cellIndex())),this},t.prototype._normalize=function(){var e=this._topLeft.cellIndex(),t=this._topLeft.rowIndex(),n=this._bottomRight.cellIndex(),r=this._bottomRight.rowIndex();this._topLeft.cellIndex(Math.min(e,n)),this._topLeft.rowIndex(Math.min(t,r)),this._bottomRight.cellIndex(Math.max(e,n)),this._bottomRight.rowIndex(Math.max(t,r))},t}();t.cellInfoRange=i,n.extend(n.wijmo.wijgrid,{cellInfo:e.grid.cellInfo,cellInfoRange:e.grid.cellInfoRange})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e,t){this._rowHeaderSize=22;if(!e)throw"'wijgrid' must be specified";this._wijgrid=e,this._bounds=t,this._wijgrid.element.addClass("wijmo-wijgrid-table")}return t.prototype.dispose=function(){this.toggleDOMSelection(!0),this._wijgrid.element.removeClass("wijmo-wijgrid-table")},t.prototype.ensureDisabledState=function(){var e="wijmo-wijgrid-disabled "+this._wijgrid.options.wijCSS.stateDisabled,t=this._wijgrid.options.disabled,r=this;n.each(this.subTables(),function(i,s){if(s){var o=n(s.element());t?(o.addClass(e),r._wijgrid._setAttr(o,"aria-disabled",!0)):(o.removeClass(e),r._wijgrid._setAttr(o,"aria-disabled",!1))}})},t.prototype.ensureWidth=function(e,t,n){this._setColumnWidth(e,t)},t.prototype.ensureHeight=function(e){},t.prototype.getScrollValue=function(){return null},t.prototype.getVisibleAreaBounds=function(){throw"not implemented"},t.prototype.getFixedAreaVisibleBounds=function(){throw"not implemented"},t.prototype.render=function(){this._ensureRenderBounds(),this._preRender(),this._renderContent(),this._postRender()},t.prototype.toggleDOMSelection=function(t){n.each(this.subTables(),function(n,r){(new e.grid.domSelection(r.element())).toggleSelection(t)}),(new e.grid.domSelection(this._wijgrid.outerDiv)).toggleSelection(t)},t.prototype.updateSplits=function(e){throw"not implemented"},t.prototype.bodyRows=function(){return this._bodyRowsAccessor||(this._bodyRowsAccessor=new e.grid.rowAccessor(this,e.grid.rowScope.body,0,0)),this._bodyRowsAccessor},t.prototype.filterRow=function(){if(this._wijgrid.options.showFilter){var t=new e.grid.rowAccessor(this,e.grid.rowScope.head,0,0);return t.item(t.length()-1)}return null},t.prototype.headerRows=function(){var t;return this._headerRowsAccessor||(t=this._wijgrid.options.showFilter?1:0,this._headerRowsAccessor=new e.grid.rowAccessor(this,e.grid.rowScope.head,0,t)),this._headerRowsAccessor},t.prototype.rows=function(){return this._rowsAccessor||(this._rowsAccessor=new e.grid.rowAccessor(this,e.grid.rowScope.table,0,0)),this._rowsAccessor},t.prototype.focusableElement=function(){throw"not implemented"},t.prototype.forEachColumnCell=function(e,t,n){throw"not implemented"},t.prototype.forEachRowCell=function(e,t,n){throw"not implemented"},t.prototype.getAbsoluteCellInfo=function(e){throw"not implemented"},t.prototype.getAbsoluteRowIndex=function(e){throw"not implemented"},t.prototype.getCell=function(e,t){throw"not implemented"},t.prototype.getColumnIndex=function(e){throw"not implemented"},t.prototype.getHeaderCell=function(e){throw"not implemented"},t.prototype.getJoinedCols=function(e){throw"not implemented"},t.prototype.getJoinedRows=function(e,t){throw"not implemented"},t.prototype.getJoinedTables=function(e,t){throw"not implemented"},t.prototype.subTables=function(){throw"not implemented"},t.prototype._getMappedScrollMode=function(){var e=this._wijgrid.options.scrollMode,t="auto",n="auto";switch(e){case"horizontal":t="hidden",n="visible";break;case"vertical":t="visible",n="hidden";break;case"both":t="visible",n="visible"}return{vScrollBarVisibility:t,hScrollBarVisibility:n}},t.prototype._postRender=function(){this.ensureDisabledState()},t.prototype._preRender=function(){throw"not implemented"},t.prototype._ensureRenderBounds=function(){var e=this._wijgrid._getDataCellsRange();this._bounds.start=0,this._bounds.end=e.bottomRight().rowIndex()},t.prototype._renderContent=function(){this._renderCOLS(),this._renderHeader(),this._wijgrid.options.showFilter&&this._renderFilter(),this._renderBody(),this._wijgrid.options.showFooter&&this._renderFooter()},t.prototype._renderCOLS=function(){var e=this._wijgrid._field("visibleLeaves"),t,n,r,i;for(r=0,i=e.length;r<i;r++)t=e[r],n=this._createCol(t,r),this._appendCol(n,t,r)},t.prototype._renderHeader=function(){var t=e.grid.rowType,n=this._wijgrid._columnsHeadersTable(),r,i,s;if(n&&(i=n.length))for(r=0;r<i;r++)s=this._insertEmptyRow(t.header,r,-1,-1,-1),this._renderRow(s,null,n[r])},t.prototype._renderFilter=function(){var t=this._insertEmptyRow(e.grid.rowType.filter,-1,-1,-1,-1);this._renderRow(t,this._wijgrid._field("visibleLeaves"),null)},t.prototype._renderBody=function(){var t=e.grid.rowType,n=this._wijgrid._field("visibleLeaves"),r=this._wijgrid.sketchTable,i=-1,s=0,o=0,u,a,f,l,c=this._wijgrid._dataOffset;if(this._bounds.start>=0)for(u=this._bounds.start;u<=this._bounds.end;u++)f=r[u-c],l=(f.rowType&t.data)!==0,a=this._insertEmptyRow(f.rowType,o++,l?++i:-1,l?f.originalRowIndex:-1,l?s+f.originalRowIndex:-1),this._renderRow(a,n,f)},t.prototype._renderFooter=function(){var t=this._insertEmptyRow(e.grid.rowType.footer,-1,-1,-1,-1);this._renderRow(t,this._wijgrid._field("visibleLeaves"),null)},t.prototype._insertEmptyRow=function(t,n,r,i,s){var o=this._wijgrid._onViewInsertEmptyRow.apply(this._wijgrid,arguments),u=this._insertRow(t,n,o);return this._createRowInfo(u,t,e.grid.renderState.rendering,n,r,i,s)},t.prototype._createEmptyCell=function(t,n,r){var i=e.grid.rowType,s=this._wijgrid._onViewCreateEmptyCell.apply(this._wijgrid,arguments);return this._createCell(t.type,s)},t.prototype._insertRow=function(e,t,n){throw"not implemented"},t.prototype._createCell=function(t,r){var i=e.grid.rowType,s;r||(t===i.header?r=document.createElement("th"):r=document.createElement("td"));if(t!==i.filter){s=document.createElement("div"),s.className="wijmo-wijgrid-innercell";if(r.firstChild)while(r.firstChild)s.appendChild(r.firstChild);r.appendChild(s)}return n(r)},t.prototype._appendCell=function(e,t,n){throw"not implemented"},t.prototype._createCol=function(e,t){throw"not implemented"},t.prototype._appendCol=function(e,t,n){throw"not implemented"},t.prototype._renderRow=function(t,n,r){var i=e.grid.rowType,s,o;switch(t.type){case i.filter:this._renderFilterRow(t,n);break;case i.footer:this._renderFooterRow(t,n);break;case i.header:this._renderHeaderRow(t,r);break;case i.data:case i.data|i.dataAlt:this._renderDataRow(t,n,r),s=r.__attr,o=r.__style;break;case i.emptyDataRow:case i.groupHeader:case i.groupFooter:this._renderSpannedRow(t,n,r),s=r.__attr,o=r.__style;break;default:throw"unknown rowType"}this._rowRendered(t,s,o)},t.prototype._renderCell=function(t,r,i,s,o,u,a){var f=this._createEmptyCell(t,o.dataIndex,o),l=t.type===e.grid.rowType.filter?f:n(f[0].firstChild);this._appendCell(t,r,f),s?l.html(i):this._wijgrid.cellFormatter.format(l,o,i,t),this._cellRendered(t,f,r,o,u,a)},t.prototype._renderDataRow=function(e,t,n){var r,i,s,o,u,a,f,l=!1;for(r=0,i=t.length;r<i;r++){s=t[r],o=s.dataIndex,u=null;if(o>=0&&(!n[o]||n[o].visible===!1))continue;u=o>=0?this._wijgrid._toStr(s,n[o].value):null,a=o>=0?n[o].__attr:null,f=o>=0?n[o].__style:null,this._renderCell(e,r,u,l,s,a,f)}},t.prototype._renderFilterRow=function(t,n){var r,i,s;for(r=0,i=n.length;r<i;r++)s=n[r],this._renderCell(t,r,e.grid.filterHelper.getSingleValue(s.filterValue),!1,s)},t.prototype._renderFooterRow=function(e,t){var n,r;for(n=0,r=t.length;n<r;n++)this._renderCell(e,n,"",!1,t[n])},t.prototype._renderHeaderRow=function(e,t){var n,r,i=0,s;for(n=0,r=t.length;n<r;n++)s=t[n],s.column&&s.column.parentVis&&(s.column.thX=i++,s.column.thY=e.sectionRowIndex,this._renderCell(e,n,s.column.headerText,!1,s.column,{colSpan:s.colSpan,rowSpan:s.rowSpan}))},t.prototype._renderSpannedRow=function(e,t,n){var r,i,s=Math.min(t.length,n.length);for(r=0;r<s;r++)this._renderCell(e,r,n[r].html,!0,t[r],n[r].__attr,n[r].__style)},t.prototype._cellRendered=function(t,n,r,i,s,o){this._wijgrid.cellStyleFormatter.format(n,r,i,t,e.grid.renderState.rendering,s,o),this._changeCellRenderState(n,e.grid.renderState.rendering,!1),this._wijgrid._onViewCellRendered(t,n,r,i)},t.prototype._rowRendered=function(t,n,r){this._wijgrid.rowStyleFormatter.format(t,n,r),t.state&=~e.grid.renderState.rendering,this._setRowInfo(t.$rows,t),this._wijgrid._onViewRowRendered(t)},t.prototype._isBodyRow=function(t){var n=e.grid.rowType,r=t.type;return r&n.data||r===n.groupHeader||r===n.groupFooter||r===n.emptyDataRow},t.prototype._changeRowRenderState=function(e,t,n){n?e.state|=t:e.state&=~t,this._setRowInfo(e.$rows,e)},t.prototype._changeCellRenderState=function(t,n,r){var i=e.grid.dataPrefix,s=this._wijgrid._data$prefix,o=i(t,s,"renderState");return r?(n=o|n,i(t,s,"renderState",n)):(n=o&~n,i(t,s,"renderState",n)),n},t.prototype._adjustWidthArray=function(e,t,r,i,s){var o=this._sumWidthArray(e),u=this._sumWidthArray(t),a=[],f,l=0,c,h,p=!0;if(o<=r){n.extend(!0,a,e);if(o===r||i)return a;f=r-o}else{n.extend(!0,a,t);if(u>=r)return a;f=r-u}n.each(a,function(e,t){t.real||l++});if(l!==0){if(s!==undefined&&s>-1&&s<a.length&&!a[s].real)return a[s].width+=f,a;c=Math.floor(f/l),h=f-c*l,n.each(a,function(e,t){t.real||(t.width+=c,p&&(t.width+=h,p=!1))})}return a},t.prototype._getColumnWidth=function(e,t){var r,i,s,o,u,a,f,l,c,h,p,d;if(t){r=this._wijgrid._field("visibleLeaves")[e];if(r._realWidth!==undefined)i={width:r._realWidth,real:!0};else if(r.isRowHeader)i={width:this._rowHeaderSize,real:!0};else{s=0,o=this.getJoinedTables(!0,e),u=o[2];for(a=0;a<2;a++){f=o[a];if(f!==null){l=f.element().rows;if(d=l.length){for(p=d-1,h=null;p>=0;p--)if(l[p].cells.length===f.width()){h=l[p];break}h&&(c=h.cells[u],s=Math.max(s,n(c).outerWidth()))}}}i={width:s,real:!1}}t.push(i)}},t.prototype._setColumnWidth=function(e,t){var r=this.getHeaderCell(e),i=this.getJoinedCols(e);t&&(n(r).setOutWidth(t),n.each(i,function(e,r){n(r).setOutWidth(t)}))},t.prototype._setTableWidth=function(e,t,r,i){var s,o;n.each(e,function(e,n){n.css("table-layout","fixed").setOutWidth(t)}),s=e[0].outerWidth(),o=s-t,o!==0&&this._setColumnWidth(i,r-o)},t.prototype._sumWidthArray=function(e,t,r){var i=0;return n.each(e,function(e,n){if(t!==undefined&&r!==undefined&&(e<t||e>r))return!0;i+=n.width}),i},t.prototype._clearBody=function(){n.each(this.subTables(),function(e,t){t.clearSection(2)})},t.prototype._rebuildOffsets=function(){n.each(this.subTables(),function(e,t){t.rebuildOffsets()})},t.prototype._removeBodyRow=function(t,n){var r=e.grid.rowType,i=this._wijgrid._rows(),s,o,u,a,f,l,c;if(t>=0&&t<(o=i.length())){if(n)for(s=0;s<o;s++)u=this._getRowInfo(i.item(s)),f=u.sectionRowIndex-t,u.sectionRowIndex>t&&(u.sectionRowIndex--,u.type&r.data&&(u.type&r.dataAlt?u.type&=~r.dataAlt:u.type|=r.dataAlt,u.dataItemIndex--,u.dataRowIndex--,u.virtualDataItemIndex--),this._setRowInfo(u.$rows,u));u=this._getRowInfo(i.item(t)),l=this.getAbsoluteRowIndex(u.$rows[0]),u.$rows.remove(),c=this.getJoinedTables(!1,l),c[0]&&c[0].removeOffset(c[2]),c[1]&&c[1].removeOffset(c[2])}},t.prototype._insertBodyRow=function(t,n,r,i){var s=this._wijgrid._field("visibleLeaves"),o=e.grid.rowType,u=this._wijgrid._view(),a=this._wijgrid._rows(),f=a.length(),l=(t.rowType&o.data)!==0,c,h,p;if(n<0||n>=f||!n&&n!==0)n=f;return c=this._insertEmptyRow(t.rowType,n,-1,r,i),this._renderRow(c,s,t),h=this.getAbsoluteRowIndex(c.$rows[0]),p=this.getJoinedTables(!1,h),p[0]&&p[0].insertOffset(h),p[1]&&p[1].insertOffset(h),c},t.prototype._findRowInfo=function(e){var t=this.bodyRows(),r=0,i=t.length(),s;if(n.isFunction(e))for(r=0;r<i;r++){s=this._getRowInfo(t.item(r));if(e(s)===!0)return s}return null},t.prototype._setRowInfo=function(t,n){var r="$rows"in n,i="data"in n,s,o;r&&(s=n.$rows,delete n.$rows),i&&(o=n.data,delete n.data),e.grid.dataPrefix(t,this._wijgrid._data$prefix,"rowInfo",n),r&&(n.$rows=s),i&&(n.data=o)},t.prototype._getRowInfo=function(t){var r=this._wijgrid,i=t[1]?n(t):n(t[0]),s=e.grid.dataPrefix(i,r._data$prefix,"rowInfo"),o;return s.$rows=i,s.dataItemIndex>=0&&s.type&e.grid.rowType.data&&(s.data=r._getDataItem(s.dataItemIndex)),s},t.prototype._createRowInfo=function(t,r,i,s,o,u,a){var f,l={type:r,state:i,sectionRowIndex:s,dataRowIndex:o,dataItemIndex:u,virtualDataItemIndex:a,$rows:n(t)};return u>=0&&r&e.grid.rowType.data&&(l.data=this._wijgrid._getDataItem(u)),l},t}();t.baseView=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(e,n){t.call(this,e,n),this._dataTable=null,this._contentArea=null}return __extends(r,t),r.prototype.dispose=function(){this._wijgrid.outerDiv.unbind("scroll",this._onScroll),t.prototype.dispose.call(this)},r.prototype.ensureWidth=function(e,r,i){var s=n(this._dataTable.element()),o=s.width()+r-i;t.prototype.ensureWidth.call(this,e,r,i),this._setTableWidth([s],o,r,e)},r.prototype.getVisibleAreaBounds=function(){var t=e.grid.bounds(this._dataTable.element()),n;return this._wijgrid.options.scrollMode==="none"?t:(n=e.grid.bounds(this._wijgrid.outerDiv.find(".wijmo-wijgrid-split-area-se:first")[0]),{top:t.top,left:t.left,width:Math.min(n.width,t.width),height:Math.min(n.height,t.height)})},r.prototype.updateSplits=function(e){var t=this,r=this._wijgrid,i=r.options,s=r.element,o=[],u=[],a=[],f=r._field("visibleLeaves"),l=r.outerDiv,c,h;s.css({"table-layout":"",width:""}),n.each(f,function(e,n){var r,s=n.width;if(s||s===0){r=typeof s=="string"&&s.length>1&&s[s.length-1]==="%",r?s=l.width()*parseFloat(s)/100:s=parseFloat(s);if(n.ensurePxWidth||n.ensurePxWidth===undefined&&i.ensureColumnsPxWidth)n._realWidth=s;t._setColumnWidth(e,s)}}),n.each(f,function(e,n){t._getColumnWidth(e,o)}),s.css("width","1px"),n.each(f,function(e,n){t._getColumnWidth(e,u)}),c=l.width(),a=this._adjustWidthArray(o,u,c,i.ensureColumnsPxWidth,i.autoExpandColumnIndex),n.each(a,function(e,n){var r=f[e];if(r._realWidth!==undefined){delete r._realWidth;return}t._setColumnWidth(e,n.width)}),h=a.length-1,h!==-1&&this._setTableWidth([s],this._sumWidthArray(a,0,h),a[h].width,h)},r.prototype.focusableElement=function(){return n(this._dataTable.element())},r.prototype.forEachColumnCell=function(e,t,n){return this._dataTable.forEachColumnCell(e,t,n)},r.prototype.forEachRowCell=function(e,t,n){return this._dataTable.forEachRowCell(e,t,n)},r.prototype.getAbsoluteCellInfo=function(t){return new e.grid.cellInfo(this.getColumnIndex(t),t.parentNode.rowIndex,this._wijgrid,!0)},r.prototype.getAbsoluteRowIndex=function(e){return e.rowIndex},r.prototype.getCell=function(e,t){var n=this._dataTable.getCellIdx(e,t),r;if(n>=0){r=this.getJoinedRows(t,0);if(r[0])return r[0].cells[n]}return null},r.prototype.getColumnIndex=function(e){return this._dataTable.getColumnIdx(e)},r.prototype.getHeaderCell=function(t){var n=this._wijgrid._field("visibleLeaves")[t],r;return n&&(r=this._wijgrid._headerRows())?e.grid.rowAccessor.getCell(r.item(n.thY),n.thX):null},r.prototype.getJoinedCols=function(e){var t=n(this._dataTable.element()).find("> colgroup");return t.length&&e<t[0].childNodes.length?[t[0].childNodes[e],null]:[null,null]},r.prototype.getJoinedRows=function(e,t){return[this._dataTable.getSectionRow(e,t),null]},r.prototype.getJoinedTables=function(e,t){return[this._dataTable,null,t]},r.prototype.subTables=function(){return[this._dataTable]},r.prototype._preRender=function(){this._dataTable=new e.grid.htmlTableAccessor(this._wijgrid.element[0],!0,!0,!0)},r.prototype._postRender=function(){this._wijgrid.element.find("> tbody").addClass(this._wijgrid.options.wijCSS.content+" wijmo-wijgrid-data"),this._dataTable=new e.grid.htmlTableAccessor(this._wijgrid.element[0]),this._wijgrid._setAttr(this._wijgrid.element,{role:"grid",cellpadding:"0",border:"0",cellspacing:"0"}),this._wijgrid.element.css("border-collapse","separate"),this._wijgrid.outerDiv.bind("scroll",{wijgrid:this._wijgrid},n.proxy(this._onScroll,this)),t.prototype._postRender.call(this)},r.prototype._insertRow=function(t,n,r){var i=e.grid.rowType,s;switch(t){case i.header:case i.filter:s=this._dataTable.ensureTHead();break;case i.footer:s=this._dataTable.ensureTFoot();break;default:s=this._dataTable.ensureTBody()}return r?[s.appendChild(r)]:(n>s.rows.length&&(n=-1),[s.insertRow(n)])},r.prototype._rowRendered=function(e,n,r){var i=e.$rows[0];!i.cells.length&&this._isBodyRow(e)?i.parentNode.removeChild(i):t.prototype._rowRendered.call(this,e,n,r)},r.prototype._appendCell=function(e,t,n){e.$rows[0].appendChild(n[0])},r.prototype._createCol=function(e,t){return[document.createElement("col")]},r.prototype._appendCol=function(e,t,n){this._dataTable.appendCol(e[0])},r.prototype._onScroll=function(e){e.data.wijgrid.$superPanelHeader&&e.data.wijgrid.$superPanelHeader.css("left",e.target.scrollLeft),e.data.wijgrid.$bottomPagerDiv&&e.data.wijgrid.$bottomPagerDiv.css("left",e.target.scrollLeft)},r}(t.baseView);t.flatView=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(e,r){t.call(this,e,r),this._verScrollBarSize=18,this._viewTables={},this._splitAreas={},this.element=e.element,this._allowVirtualScrolling=e._allowVirtualScrolling(),this._staticDataRowIndex=e._getStaticIndex(!0),this._staticRowIndex=e._getRealStaticRowIndex(),this._staticColumnIndex=e._getRealStaticColumnIndex(),this._staticAllColumnIndex=this._staticColumnIndex===-1?-1:e._field("visibleLeaves")[this._staticColumnIndex].leavesIdx,this._mouseWheelHandler=n.proxy(this._onMouseWheel,this)}return __extends(r,t),r.prototype.dispose=function(){t.prototype.dispose.call(this),this._wijgrid.outerDiv.unbind("mousewheel",this._mouseWheelHandler)},r.prototype.ensureWidth=function(e,r,i){var s=this._wijgrid,o=s.options,u=this._staticColumnIndex,a=e<=u,f=n(this._viewTables.nw.element()),l=n(this._viewTables.ne.element()),c=n(this._viewTables.sw.element()),h=n(this._viewTables.se.element()),p=a?[f,c]:[l,h],d=(a?f.width():l.width())+r-i,v=s._field("frozener"),m=this.getScrollValue();this._destroySuperPanel(),t.prototype.ensureWidth.call(this,e,r,i),this._setTableWidth(p,d,r,e);try{u>=0?o.splitDistanceX=f[0].offsetWidth:o.splitDistanceX=0}catch(g){}this._updateSplitAreaBounds(0),this._adjustRowsHeights();try{this._staticRowIndex>=0?o.splitDistanceY=Math.max(f[0].offsetHeight,l[0].offsetHeight):o.splitDistanceY=0}catch(g){}this._updateSplitAreaBounds(1),this.refreshPanel(m),v.refresh()},r.prototype.ensureHeight=function(e){var t,r=this._wijgrid,i=r.options,s=n(this._viewTables.nw.element()),o=n(this._viewTables.ne.element()),u=n(this._viewTables.sw.element()),a=n(this._viewTables.se.element()),f=r._field("frozener"),l=this.getScrollValue(),c;this._destroySuperPanel(),arguments.length>0&&(t=this.getJoinedRows(e,2),this._setRowHeight(t,this._getRowHeight(t))),a.css("height",""),u.css("height",""),c=Math.max(a.height(),u.height()),a.height(c),u.height(c);try{this._staticRowIndex>=0?i.splitDistanceY=Math.max(s[0].offsetHeight,o[0].offsetHeight):i.splitDistanceY=0}catch(h){}this._updateSplitAreaBounds(1),this.refreshPanel(l),f.refresh()},r.prototype.getScrollValue=function(){var e=this._getSuperPanel();return e?{x:e.options.hScroller.scrollValue,y:e.options.vScroller.scrollValue}:null},r.prototype.getVisibleAreaBounds=function(){var t=e.grid.bounds(this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-contentwrapper:first"));return t||(t=e.grid.bounds(this._wijgrid.outerDiv)),t},r.prototype.getFixedAreaVisibleBounds=function(){var t=this.getVisibleAreaBounds(),n=e.grid.bounds(this._splitAreas.ne),r=e.grid.bounds(this._splitAreas.nw),i=null,s=null;if(n.height||r.height)i={left:t.left,top:t.top,width:t.width,height:Math.min(n.height||r.height,t.height)};return r.width&&(s={left:t.left,top:t.top,width:Math.min(r.width,t.width),height:t.height}),[i,s]},r.prototype.refreshPanel=function(t){var r=this,i=this._wijgrid,s=i.options,o=this._getGridWidth(s.scrollMode),u=this._getMappedScrollMode(),a=this._testNeedVBar(i.outerDiv,i.element,n(this._viewTables.ne.element()),s.scrollMode,i._autoHeight),f=t?t.x:null,l=t?t.y:null;this._scroller.width(o),this._splitAreas.ne.width(o-s.splitDistanceX-(a?this._verScrollBarSize:0)),this._scroller.data("wijmo-wijsuperpanel")?this._scroller.wijsuperpanel("paintPanel"):(this._allowVirtualScrolling&&(this.vsUI=new e.grid.uiVirtualScroller(i,this._splitAreas.se,s.splitDistanceY)),this._scroller.wijsuperpanel({disabled:i.options.disabled,scroll:n.proxy(this._onScroll,this),bubbleScrollingEvent:!0,customScrolling:this._allowVirtualScrolling,vScroller:{scrollBarVisibility:u.vScrollBarVisibility,scrollValue:t?t.y:null},hScroller:{scrollBarVisibility:u.hScrollBarVisibility,scrollValue:t?t.x:null},hScrollerActivating:function(e,t){var n;if(i._autoHeight){n=i.element.height()+s.splitDistanceY-t.contentLength;if(n>0)return r._scroller.height(r._scroller.height()+n),r._scroller.wijsuperpanel("paintPanel"),!1}r._splitAreas.sw.height(t.contentLength-s.splitDistanceY)}}),this._scroller.find(".wijmo-wijsuperpanel-contentwrapper:first").scroll(function(e){e.target.scrollLeft&&(e.target.scrollLeft=0),e.target.scrollTop&&(e.target.scrollTop=0),e.preventDefault()}),this._allowVirtualScrolling&&this.vsUI.attach(this._scroller)),this._scroller.find(".wijmo-wijsuperpanel-hbarcontainer, .wijmo-wijsuperpanel-vbarcontainer").css("zIndex",5)},r.prototype.scrollTo=function(e){if(!e.tableCell())return;var t=this._wijgrid,r=t.options,i=this._getSuperPanel(),s=e.tableCell(),o=s.nodeType?n(s):s,u,a,f,l,c,h,p,d,v,m,g,y=null,b=null,w,E,S,x;i&&o.is(":visible")&&(u=i.getContentElement(),a=u.parent(),f=parseInt((u.css("left")+"").replace("px",""),10)*-1,l=parseInt((u.css("top")+"").replace("px",""),10)*-1,c=a.outerWidth()-r.splitDistanceX,h=a.outerHeight()-r.splitDistanceY,p=o.position(),d=p.left,v=p.top,m=o.outerWidth(),g=o.outerHeight(),w=t._getStaticIndex(!0),E=t._getStaticIndex(!1),S=e.rowIndex(),x=e.cellIndex(),S<=w?x<=E?(y=0,b=0):(d+=f,d+m>f+c&&(f=y=d+m-c),d<f&&(y=d),b=0):x<=E?(v+=l,v+g>l+h&&(l=b=v+g-h),v<l&&(b=v),y=0):(d-=r.splitDistanceX,v+g>l+h&&(l=b=v+g-h),d+m>f+c&&(f=y=d+m-c),v<l&&(b=v),d<f&&(y=d)),y!==null&&i.hScrollTo(y),b!==null&&(this._allowVirtualScrolling||i.vScrollTo(b)))},r.prototype.updateSplits=function(e){var t=this._wijgrid,r=t.options,i,s=this,o=[],u=[],a=[],f=this._staticColumnIndex,l,c=r.scrollMode,h=t._field("visibleLeaves"),p=n(this._viewTables.se.element()),d=n(this._viewTables.ne.element()),v=n(this._viewTables.sw.element()),m=n(this._viewTables.nw.element()),g=t.outerDiv,y,b,w;this._destroySuperPanel(),g.unbind("mousewheel",this._mouseWheelHandler);if((y=s._viewTables.se.element().tBodies)&&(y=y[0])){w=!1;for(b=0;b<y.rows.length;b++)if(!n(y.rows[b]).hasClass("wijmo-wijgrid-groupheaderrow")){w=!0;break}w||t.element.css("width","100%")}n.each([p,d,v,m],function(e,t){t.css({"table-layout":"",width:""})}),n.each(h,function(e,t){var n,i=t.width;if(i||i===0){n=typeof i=="string"&&i.length>1&&i[i.length-1]==="%",n?i=g.width()*parseFloat(i)/100:i=parseFloat(i);if(t.ensurePxWidth||t.ensurePxWidth===undefined&&r.ensureColumnsPxWidth)t._realWidth=i;s._setColumnWidth(e,i)}}),n.each(h,function(e,t){s._getColumnWidth(e,a)}),n.each([m,d,v,p],function(e,t){t.css({width:"1px"})}),n.each(h,function(e,t){s._getColumnWidth(e,u)}),i=g.width(),o=this._adjustWidthArray(a,u,i,r.ensureColumnsPxWidth,r.autoExpandColumnIndex),n.each(o,function(e,t){var n=h[e];if(n._realWidth!==undefined){delete n._realWidth;return}s._setColumnWidth(e,t.width)}),f>=0&&(l=f,this._setTableWidth([m,v],this._sumWidthArray(o,0,l),o[l].width,l));try{f>=0?r.splitDistanceX=m[0].offsetWidth:r.splitDistanceX=0}catch(E){}this._updateSplitAreaBounds(0),r.ensureColumnsPxWidth||d.parent().width(i-r.splitDistanceX),l=o.length-1,l!==-1&&this._setTableWidth([d,p],this._sumWidthArray(o,f+1,l),o[l].width,l),this._adjustRowsHeights();try{this._staticRowIndex>=0?r.splitDistanceY=Math.max(m[0].offsetHeight,d[0].offsetHeight):r.splitDistanceY=0}catch(E){}this._updateSplitAreaBounds(1);if(!r.ensureColumnsPxWidth&&this._testNeedVBar(t.outerDiv,p,d,c,t._autoHeight)){i-=this._verScrollBarSize,o=this._adjustWidthArray(a,u,i,r.ensureColumnsPxWidth,r.autoExpandColumnIndex),n.each(o,function(e,t){t.real||s._setColumnWidth(e,t.width)}),f>=0&&(l=f,this._setTableWidth([m,v],this._sumWidthArray(o,0,l),o[l].width,l));try{f>=0?r.splitDistanceX=m[0].offsetWidth:r.splitDistanceX=0}catch(E){}this._updateSplitAreaBounds(0),d.parent().width(i-r.splitDistanceX),l=o.length-1,l!==-1&&this._setTableWidth([d,p],this._sumWidthArray(o,f+1,l),o[l].width,l),this._adjustRowsHeights();try{this._staticRowIndex>=0?r.splitDistanceY=Math.max(m[0].offsetHeight,d[0].offsetHeight):r.splitDistanceY=0}catch(E){}this._updateSplitAreaBounds(1)}this.refreshPanel(e),g.bind("mousewheel",n.proxy(this._mouseWheelHandler,this))},r.prototype._clearBody=function(){t.prototype._clearBody.call(this)},r.prototype.bodyRows=function(){var e=t.prototype.bodyRows.call(this);return e},r.prototype.focusableElement=function(){return this._wijgrid.outerDiv},r.prototype.forEachColumnCell=function(e,t,n){var r=this.getJoinedTables(!0,e),i,s;if(r[0]!==null){i=r[2],s=r[0].forEachColumnCell(i,t,n);if(s!==!0)return s;if(r[1]!==null){s=r[1].forEachColumnCell(i,t,n);if(s!==!0)return s}}return!0},r.prototype.forEachRowCell=function(e,t,n){var r=this.getJoinedTables(!1,e),i=r[0],s=r[1],o,u;if(i!==null){o=r[2];if(o<i.element().rows.length){u=i.forEachRowCell(o,t,n);if(u!==!0)return u}if(s!==null&&o<s.element().rows.length){u=s.forEachRowCell(o,t,n);if(u!==!0)return u}}return HTMLTableCellElement,!0},r.prototype.getAbsoluteCellInfo=function(t){return new e.grid.cellInfo(this.getColumnIndex(t),this.getAbsoluteRowIndex(t.parentNode),this._wijgrid,!0)},r.prototype.getAbsoluteRowIndex=function(e){var t=e.rowIndex,n=e.parentNode;while(n.tagName.toLowerCase()!=="table")n=n.parentNode;return n===this._viewTables.nw.element()||n===this._viewTables.ne.element()?t:t+this._staticRowIndex+1},r.prototype.getCell=function(e,t){var n=this.getJoinedTables(!1,t),r,i,s,o,u;if(n[0]!==null){r=this.getJoinedTables(!0,e);if(r[0]!==null){i=n[2],s=r[2],o=null,n[1]!==null?o=e===s?n[0]:n[1]:o=n[0],u=o.getCellIdx(s,i);if(u>=0)return o.element().rows[i].cells[u]}}return null},r.prototype.getColumnIndex=function(e){var t=null,n=null,r=!1,i;for(t=e.parentNode;t.tagName.toLowerCase()!=="table";t=t.parentNode);if(t!==null){t===this._viewTables.nw.element()?n=this._viewTables.nw:t===this._viewTables.ne.element()?(n=this._viewTables.ne,r=!0):t===this._viewTables.sw.element()?n=this._viewTables.sw:t===this._viewTables.se.element()&&(n=this._viewTables.se,r=!0);if(n!==null)return i=n.getColumnIdx(e),r&&(i+=this._staticColumnIndex+1),i}return-1},r.prototype.getHeaderCell=function(t){var n=this._wijgrid._field("visibleLeaves")[t],r;return n&&(r=this._wijgrid._headerRows())?e.grid.rowAccessor.getCell(r.item(n.thY),n.thX):null},r.prototype.getJoinedCols=function(e){var t=[],r=this.getJoinedTables(!0,e),i=r[2];return r.splice(r.length-1,1),n.each(r,function(e,r){t.push(r?n(r.element()).find("col")[i]:null)}),t},r.prototype.getJoinedRows=function(e,t){var n=null,r=null,i=null,s=null,o=this._staticRowIndex,u=this._staticColumnIndex,a=this._wijgrid._field("visibleLeaves").length-1,f=this._rowsCountRaw()-1,l=o===f,c=o<0,h=!l&&!c,p=0;if(l||h)u>=0&&u<a?(i=this._viewTables.nw,s=this._viewTables.ne):i=u<0?this._viewTables.ne:this._viewTables.nw,p=i.getSectionLength(t),e<p&&(n=i.getSectionRow(e,t),s!==null&&(r=s.getSectionRow(e,t)));if(c||h&&n===null)c||(e-=p),u>=0&&u<a?(i=this._viewTables.sw,s=this._viewTables.se):i=u<0?this._viewTables.se:this._viewTables.sw,n=i.getSectionRow(e,t),s!==null&&(r=s.getSectionRow(e,t));return n===null&&r===null?null:[n,r]},r.prototype.getJoinedTables=function(e,t){var n=null,r=null,i=t,s=this._wijgrid,o=this._staticRowIndex,u=this._staticColumnIndex;return e?(t<=u?(n=this._viewTables.nw,r=this._viewTables.sw):(n=this._viewTables.ne,r=this._viewTables.se,i-=u+1),o<0&&(n=null),o===this._rowsCountRaw()-1&&(r=null)):(t<=o?(n=this._viewTables.nw,r=this._viewTables.ne):(n=this._viewTables.sw,r=this._viewTables.se,i-=o+1),u<0&&(n=null),u===s._field("leaves").length-1&&(r=null)),n===null&&(n=r,r=null),[n,r,i]},r.prototype.subTables=function(){return[this._viewTables.nw,this._viewTables.ne,this._viewTables.sw,this._viewTables.se]},r.prototype._getGridWidth=function(e){var t=this._wijgrid,r=t.element.outerWidth(!0)+t.options.splitDistanceX,i=t.outerDiv.innerWidth();return this._testNeedVBar(t.outerDiv,t.element,n(this._viewTables.ne.element()),e,t._autoHeight)&&(r+=this._verScrollBarSize),r>i&&(r=i),r},r.prototype._getSuperPanel=function(){return this._scroller?this._scroller.data("wijmo-wijsuperpanel"):null},r.prototype._ensureRenderBounds=function(){this._wijgrid._allowVirtualScrolling()?(this._wijgrid._ensureRenderBounds(this._bounds),this._wijgrid._serverSideVirtualScrolling(),this._bounds.end=this._bounds.start+this._wijgrid.options.pageSize-1,this._wijgrid._ensureRenderBounds(this._bounds)):t.prototype._ensureRenderBounds.call(this)},r.prototype._renderContent=function(){t.prototype._renderContent.call(this)},r.prototype._preRender=function(){var t=document.createDocumentFragment(),r=e.grid.htmlTableAccessor;this._wijgrid.outerDiv.wrapInner('<div class="wijmo-wijgrid-fixedview"><div class="wijmo-wijgrid-scroller"><div class="wijmo-wijgrid-split-area-se wijmo-wijgrid-content-area"></div></div></div>'),this._scroller=this._wijgrid.outerDiv.find(".wijmo-wijgrid-scroller"),this._scroller.css("padding",0),this._scroller.after(this._splitAreas.nw=n('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-nw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._scroller.after(this._splitAreas.ne=n('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-ne" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._scroller.after(this._splitAreas.sw=n('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-sw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._splitAreas.se=this._scroller.find(".wijmo-wijgrid-split-area-se:first"),this._viewTables={nw:new r(t.appendChild(document.createElement("table")),!0,!0,!0),ne:new r(t.appendChild(document.createElement("table")),!0,!0,!0),sw:new r(t.appendChild(document.createElement("table")),!0,!0,!0),se:new r(t.appendChild(this._wijgrid.element[0]),!0,!0,!0)}},r.prototype._postRender=function(){var r,i,s,o,u=e.grid.htmlTableAccessor,a=this;this._viewTables={nw:new u(r=this._viewTables.nw.element()),ne:new u(i=this._viewTables.ne.element()),sw:new u(s=this._viewTables.sw.element()),se:new u(o=this._viewTables.se.element())},this._splitAreas.nw.empty().append(r),this._splitAreas.ne.empty().append(i),this._splitAreas.sw.empty().append(s),this._splitAreas.se.empty().append(o),n.each(this._viewTables,function(e,t){var r=n(t.element());a._wijgrid._setAttr(r,{role:"grid",border:"0",cellpadding:"0",cellspacing:"0"}),r.addClass("wijmo-wijgrid-table").css("border-collapse","separate").find("> tbody").addClass(a._wijgrid.options.wijCSS.content+" wijmo-wijgrid-data")}),t.prototype._postRender.call(this)},r.prototype._rowsCountRaw=function(){var e=this._viewTables.nw.element(),t=this._viewTables.ne.element(),n=this._viewTables.sw.element(),r=this._viewTables.se.element(),i;return i=Math.max(e.rows.length,t.rows.length)+Math.max(n.rows.length,r.rows.length),i},r.prototype._createCol=function(e,t){return[document.createElement("col"),document.createElement("col")]},r.prototype._appendCol=function(e,t,n){n<=this._staticColumnIndex?(this._viewTables.nw.appendCol(e[0]),this._viewTables.sw.appendCol(e[1])):(this._viewTables.ne.appendCol(e[0]),this._viewTables.se.appendCol(e[1]))},r.prototype._insertRow=function(t,n,r){var i=e.grid.rowType,s,o,u=this._viewTables;switch(t){case i.header:case i.filter:s=u.nw.ensureTHead(),o=u.ne.ensureTHead();break;case i.footer:s=u.sw.ensureTFoot(),o=u.se.ensureTFoot();break;default:n<=this._staticDataRowIndex?(s=u.nw.ensureTBody(),o=u.ne.ensureTBody()):(n-=this._staticDataRowIndex+1,s=u.sw.ensureTBody(),o=u.se.ensureTBody())}return r?[s.appendChild(r),o.appendChild(r.cloneNode(!1))]:[s.insertRow(n>s.rows.length?-1:n),o.insertRow(n>o.rows.length?-1:n)]},r.prototype._rowRendered=function(e,r,i){var s=e.$rows[0],o=e.$rows[1];!s.cells.length&&this._isBodyRow(e)&&(s.parentNode.removeChild(s),s=null),!o.cells.length&&this._isBodyRow(e)&&(o.parentNode.removeChild(o),o=null);if(s||o){if(!s||!o)e.$rows=s?n(s):n(o);t.prototype._rowRendered.call(this,e,r,i)}},r.prototype._appendCell=function(t,n,r){var i=t.type!==e.grid.rowType.header?this._staticColumnIndex:this._staticAllColumnIndex;n<=i?t.$rows[0].appendChild(r[0]):t.$rows[1].appendChild(r[0])},r.prototype._getRowHeight=function(e,t){if(e[0]&&e[1]){var r=e[0],i=e[1],s=n(r),o=n(i),u,a,f,l=function(e){var t,r=e[0],i;for(t=0;t<r.cells.length;t++){i=r.cells[t];if(!i.rowSpan||i.rowSpan===1)return n(i).outerHeight()}return e.height()};return(f=n.data(r,"customHeight"))?u=a=parseInt(f):(s.css("height",""),o.css("height",""),t?(u=l(s),a=l(o)):(u=s.height(),a=o.height())),Math.max(u,a)}return null},r.prototype._setRowHeight=function(e,t){if(e[0]&&e[1]){var r=[n(e[0]),n(e[1])],i;if(t===null)return;t+=1,n.each(r,function(e,n){n.height(t),i=t-n.height(),i&&n.height(t+i)})}},r.prototype._adjustRowHeight=function(){var e=this._wijgrid,t=this._staticColumnIndex,n=e._field("visibleLeaves").length-1,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b=[];if(t>-1&&t<n){r=this._staticRowIndex,i=this._rowsCountRaw()-1,s=this._viewTables;if(r>-1&&r<=i){o=s.ne.element(),u=o.parentNode,a=s.nw.element(),f=a.parentNode,g=a.rows,y=o.rows,d=g.length;for(v=0;v<d;v++)b.push(this._getRowHeight([g[v],y[v]],!0))}if(r>=-1&&r<i){l=s.se.element(),c=l.parentNode,h=s.sw.element(),p=h.parentNode,g=h.rows,y=l.rows,d=g.length;for(v=0;v<d;v++)b.push(this._getRowHeight([g[v],y[v]]))}r>-1&&r<=i&&(f.removeChild(a),u.removeChild(o)),r>=-1&&r<i&&(p.removeChild(h),c.removeChild(l));if(r>-1&&r<=i){g=a.rows,y=o.rows,d=g.length;for(v=0,m=0;v<d;v++)this._setRowHeight([g[v],y[v]],b[m++])}if(r>=-1&&r<i){g=h.rows,y=l.rows,d=g.length;for(v=0;v<d;v++)this._setRowHeight([g[v],y[v]],b[m++])}r>-1&&r<=i&&(f.appendChild(a),u.appendChild(o)),r>=-1&&r<i&&(p.appendChild(h),c.appendChild(l))}},r.prototype._adjustRowsHeights=function(){var e=n(this._viewTables.sw.element()),t=n(this._viewTables.se.element()),r;t.css("height",""),e.css("height",""),this._adjustRowHeight(),r=Math.max(t.height(),e.height()),e.height(r),t.height(r)},r.prototype._destroySuperPanel=function(){this._scroller.data("wijmo-wijsuperpanel")&&(this.vsUI&&this.vsUI.dispose(),this._scroller.wijsuperpanel("destroy"))},r.prototype._onScroll=function(e,t){var n=this._getSuperPanel();this._allowVirtualScrolling?t.dir==="h"&&(this._setFixedAreaPosition(n.getContentElement(),t.dir,t.position,t.animationOptions,!1),this._setFixedAreaPosition(this._splitAreas.ne,t.dir,t.position,t.animationOptions,!0)):this._setFixedAreaPosition(t.dir==="h"?this._splitAreas.ne:this._splitAreas.sw,t.dir,t.position,t.animationOptions,!0),this._wijgrid._trackScrollingPosition(n.options.hScroller.scrollValue,n.options.vScroller.scrollValue)},r.prototype._onMouseWheel=function(t,r){var i,s=r>0?"top":"bottom",o=!1,u;this._wijgrid._canInteract()&&(i=this.getFixedAreaVisibleBounds(),n.each(i,function(n,r){if(r&&e.grid.isOver(t.pageY,t.pageX,r.top,r.left,r.height,r.width))return o=!0,!1}),o&&this._scroller.data("wijmo-wijsuperpanel")&&(u=this._scroller.wijsuperpanel("option","vScroller").scrollValue,this._scroller.wijsuperpanel("doScrolling",s),u!==this._scroller.wijsuperpanel("option","vScroller").scrollValue&&(t.stopPropagation(),t.preventDefault())))},r.prototype._setFixedAreaPosition=function(e,t,n,r,i){var s={},o;t==="h"?o=i?"scrollLeft":"left":o=i?"scrollTop":"top",i||(n=-n),r?(s[o]=n,e.animate(s,r)):i?e[0][o]=n:e.css(o,n)},r.prototype._testNeedVBar=function(e,t,n,r,i){var s,o=this._wijgrid,u=n.width()+o.options.splitDistanceX,a=t.height()+o.options.splitDistanceY,f=e.width(),l=e.height(),c,h=0,p=0;return this._allowVirtualScrolling&&o._totalRowsCount()>1?!0:(o.$superPanelHeader!==null&&(h=o.$superPanelHeader.outerHeight(!0)),o.$bottomPagerDiv!==null&&(p=o.$bottomPagerDiv.outerHeight(!0)),c=l-h-p,r==="both"||r==="vertical"?s=!0:s=r==="auto"&&(a>c||!i&&u>f&&a>c-this._verScrollBarSize),s)},r.prototype._updateSplitAreaBounds=function(e){var t=this._wijgrid,n=t.options,r,i,s=0,o=0;if(e===0||e===2)this._splitAreas.nw.width(n.splitDistanceX),this._splitAreas.sw.width(n.splitDistanceX),this._splitAreas.se.css("marginLeft",n.splitDistanceX),this._splitAreas.ne.css("marginLeft",n.splitDistanceX);if(e===1||e===2)this._scroller.css("height",""),this._splitAreas.se.css("marginTop",0),r=t.outerDiv.height(),t._autoHeight?this._scroller.height(r+n.splitDistanceY):this._scroller.height(r),this._splitAreas.nw.height(n.splitDistanceY),this._splitAreas.ne.height(n.splitDistanceY),t.$superPanelHeader!==null&&(s=t.$superPanelHeader.outerHeight(!0)),t.$bottomPagerDiv!==null&&(o=t.$bottomPagerDiv.outerHeight(!0)),i=r-s-o,t.$superPanelHeader!==null&&(this._splitAreas.nw.css("top",s+"px"),this._splitAreas.ne.css("top",s+"px")),t._autoHeight?this._splitAreas.sw.height(i):this._splitAreas.sw.height(i-n.splitDistanceY),this._splitAreas.sw.css("top",n.splitDistanceY+s),this._splitAreas.se.css("marginTop",n.splitDistanceY)},r}(t.baseView);t.fixedView=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e){this._updates=0,this._selectedColumns=null,this._selectedRows=null,this._extend_rules={singlecell:[0,0,0],singlecolumn:[1,1,1],singlerow:[2,2,2],singlerange:[0,1,2],multicolumn:[1,1,1],multirow:[2,2,2],multirange:[0,1,2]};if(!e)throw"invalid arguments";this._wijgrid=e,this._addedCells=new i(e),this._removedCells=new i(e),this._selectedCells=new i(e),this._addedDuringCurTransactionCells=new i(e)}return t.prototype.selectedCells=function(){return this._selectedCells},t.prototype.addColumns=function(e,t){!t&&t!==0&&(t=e),this.addRange(e,0,t,16777215)},t.prototype.addRange=function(t,n,r,i){if(!t&&arguments.length===1)throw"invalid argument";var s=arguments.length===4?new e.grid.cellInfoRange(new e.grid.cellInfo(t,n),new e.grid.cellInfo(r,i)):t._clone();s._normalize();if(!s._isValid())throw"invalid argument";this.beginUpdate(),this._startNewTransaction(this._wijgrid._field("currentCell")),this._selectRange(s,!1,!0,0,null),this.endUpdate()},t.prototype.addRows=function(e,t){!t&&t!==0&&(t=e),this.addRange(0,e,16777215,t)},t.prototype.removeRange=function(t,n,r,i){if(!t&&arguments.length===1)throw"invalid argument";var s=arguments.length===4?new e.grid.cellInfoRange(new e.grid.cellInfo(t,n),new e.grid.cellInfo(r,i)):t._clone();s._normalize();if(!s._isValid())throw"invalid argument";this.beginUpdate(),this._startNewTransaction(this._wijgrid._field("currentCell")),this._clearRange(s,0),this.endUpdate()},t.prototype.removeColumns=function(e,t){!t&&t!==0&&(t=e),this.removeRange(e,0,t,16777215)},t.prototype.removeRows=function(e,t){!t&&t!==0&&(t=e),this.removeRange(0,e,16777215,t)},t.prototype.clear=function(){this.beginUpdate(),this._removedCells._clear(),this._removedCells._addFrom(this._selectedCells),this.endUpdate()},t.prototype.selectAll=function(){this.beginUpdate(),this._selectRange(this._wijgrid._getDataCellsRange(),!1,!1,0,null),this.endUpdate()},t.prototype.beginUpdate=function(){this._updates++},t.prototype.endUpdate=function(){if(this._updates>0){this._updates--;if(this._updates===0){this.doSelection();if(this._addedCells.length()||this._removedCells.length())this._selectedColumns!==null&&this._selectedColumns.UnderlyingDataChanged(),this._selectedRows!==null&&this._selectedRows.UnderlyingDataChanged(),this._wijgrid._trigger("selectionChanged",null,{addedCells:this._addedCells,removedCells:this._removedCells});this._addedCells=new e.grid.cellInfoOrderedCollection(this._wijgrid),this._removedCells._clear()}}},t.prototype._multipleRangesAllowed=function(){var e=this._wijgrid.options.selectionMode;return e&&((e=e.toLowerCase())==="multicolumn"||e==="multirow"||e==="multirange")},t.prototype._anchorCell=function(){return this.__anchorCell},t.prototype._startNewTransaction=function(t){t&&(this.__anchorCell=t._clone(),this._addedDuringCurTransactionCells=new e.grid.cellInfoOrderedCollection(this._wijgrid))},t.prototype._clearRange=function(e,t){var n=this._wijgrid.options.selectionMode.toLowerCase(),r,i,s,o,u,a,f,l,c,h=this._wijgrid._getDataCellsRange();if(e._isValid()&&n!=="none"&&this._selectedCells.length()>0){r=e._clone(),r._normalize(),r._clip(h);if(!e._isValid())return;r._extend(this._extend_rules[n][t],h),this.beginUpdate();for(f=0,l=this._selectedCells.length();f<l;f++)c=this._selectedCells.item(f),r._containsCellInfo(c)&&this._removedCells._add(c);this.endUpdate()}},t.prototype._selectRange=function(t,n,r,i,s){var o=this._wijgrid.options.selectionMode.toLowerCase(),u,a=this._wijgrid._getDataCellsRange();if(o!=="none"&&t._isValid()){u=t._clone(),u._normalize(),u._clip(a);if(!u._isValid())return;this.beginUpdate(),this._multipleRangesAllowed()?n||r?r&&(this._removedCells._clear(),this._removedCells._addFrom(this._addedDuringCurTransactionCells)):this.clear():this.clear();switch(o){case"singlecell":case"singlecolumn":case"singlerow":u=s===null?new e.grid.cellInfoRange(u.topLeft(),u.topLeft()):new e.grid.cellInfoRange(s,s)}u._extend(this._extend_rules[o][i],a),this.doRange(u,!0),this.endUpdate()}},t.prototype.doSelection=function(){var t=this._wijgrid._getDataToAbsOffset(),r=t.x,i=t.y,s=this._wijgrid._view(),o,u,a,f,l,c,h=e.grid.renderState,p,d,v=-1;for(o=0,u=this._removedCells.length();o<u;o++)a=this._removedCells.item(o),this._addedCells.indexOf(a)<0?(f=s.getCell(a.cellIndex()+r,a.rowIndex()+i),f&&(v!==a.rowIndex()&&(p=a.row(),v=a.rowIndex()),l=n(f),d=s._changeCellRenderState(l,h.selected,!1),this._wijgrid.cellStyleFormatter.format(l,a.cellIndex(),a.column(),p,d)),this._selectedCells._remove(a),this._addedDuringCurTransactionCells._remove(a)):(this._removedCells._removeAt(o),o--,u--);v=-1;for(o=0,u=this._addedCells.length();o<u;o++)a=this._addedCells.item(o),c=this._selectedCells.indexOf(a),c<0?(f=s.getCell(a.cellIndex()+r,a.rowIndex()+i),f&&(v!==a.rowIndex()&&(p=a.row(),v=a.rowIndex()),l=n(f),d=s._changeCellRenderState(l,h.selected,!0),this._wijgrid.cellStyleFormatter.format(l,a.cellIndex(),a.column(),p,d)),this._selectedCells._insertUnsafe(a,~c),this._addedDuringCurTransactionCells._add(a)):(this._addedCells._removeAt(o),o--,u--)},t.prototype.doRange=function(t,n){var r=t.topLeft().cellIndex(),i=t.topLeft().rowIndex(),s=t.bottomRight().cellIndex(),o=t.bottomRight().rowIndex(),u,a,f,l,c=this._wijgrid._view(),h,p;if(n){u=this._addedCells.length(),p=this._wijgrid._rows();for(a=i;a<=o;a++){h=c._getRowInfo(p.item(a));if(h.type&e.grid.rowType.data)for(f=r;f<=s;f++)l=new e.grid.cellInfo(f,a),u===0?this._addedCells._appendUnsafe(l):this._addedCells._add(l)}}else{u=this._removedCells.length();for(a=i;a<=o;a++)for(f=r;f<=s;f++)l=new e.grid.cellInfo(f,a),u===0?this._removedCells._appendUnsafe(l):this._removedCells._add(l)}},t}();t.selection=r;var i=function(){function t(e){this._clear=function(){this._list.length=0};if(!e)throw"invalid arguments";this._wijgrid=e,this._list=[]}return t.prototype.item=function(e){return this._list[e]},t.prototype.length=function(){return this._list.length},t.prototype.indexOf=function(e,t){arguments.length===1&&(t=e.rowIndex(),e=e.cellIndex());var n=0,r=this._list.length-1,i,s,o;while(n<=r){i=n+(r-n>>1),s=this._list[i],o=s.rowIndex()-t,o===0&&(o=s.cellIndex()-e);if(o<0)n=i+1;else{if(!(o>0))return i;r=i-1}}return~n},t.prototype.toString=function(){var e="",t,n;for(t=0,n=this._list.length;t<n;t++)e+=this._list[t].toString()+"\n";return e},t.prototype._add=function(e){var t=this.indexOf(e);return t<0?(this._list.splice(~t,0,e),e._setGridView(this._wijgrid),!0):!1},t.prototype._addFrom=function(e){if(e){var t=e.length(),n=this._list.length,r;if(n===0){this._list.length=t;for(r=0;r<t;r++)this._list[r]=e.item(r),this._list[r]._setGridView(this._wijgrid)}else for(r=0;r<t;r++)this._add(e.item(r))}},t.prototype._appendUnsafe=function(e){this._list[this._list.length]=e,e._setGridView(this._wijgrid)},t.prototype._insertUnsafe=function(e,t){this._list.splice(t,0,e)},t.prototype._remove=function(e){var t=this.indexOf(e);return t>=0?(this._list.splice(t,1),!0):!1},t.prototype._removeAt=function(e){this._list.splice(e,1)},t.prototype._getColumnsIndicies=function(){var e=[],t=this._list.length,n,r,i;if(t){n=[];for(r=0;r<t;r++)n[this._list[r].cellIndex()]=1;t=n.length,i=0;for(r=0;r<t;r++)n[r]&&(e[i++]=r)}return e},t.prototype._getSelectedRowsIndicies=function(){var e=[],t=this._list.length,n,r,i;if(t){n=[];for(r=0;r<t;r++)n[this._list[r].rowIndex()]=1;t=n.length,i=0;for(r=0;r<t;r++)n[r]&&(e[i++]=r)}return e},t.prototype._rectangulate=function(){var t=this._list.length,n=4294967295,r=4294967295,i=0,s=0,o,u;if(t){for(o=0;o<t;o++)u=this._list[o],n=Math.min(n,u.cellIndex()),r=Math.min(r,u.rowIndex()),i=Math.max(i,u.cellIndex()),s=Math.max(s,u.rowIndex());return new e.grid.cellInfoRange(new e.grid.cellInfo(n,r),new e.grid.cellInfo(i,s))}return null},t}();t.cellInfoOrderedCollection=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(t){this._gap_to_start=10,this._inProgress=!1,this._additionalEventsAttached=!1,this._wijgrid=t,this._evntFormat="{0}."+this._wijgrid.widgetName+".selectionui",this._addedCells=new e.grid.cellInfoOrderedCollection(this._wijgrid),this._view=this._wijgrid._view(),this._rootElement=this._view.focusableElement(),this._visLeavesLen=this._wijgrid._field("visibleLeaves").length,this._rootElement.bind(this._eventKey("mousedown"),n.proxy(this._onGridMouseDown,this))}return t.prototype.dispose=function(){this._rootElement.unbind(this._eventKey("mousedown"),this._onGridMouseDown),this._detachAdditionalEvents()},t.prototype._onGridMouseDown=function(e){if(!this._wijgrid._canInteract()||this._wijgrid.options.selectionMode.toLowerCase()==="none")return;var t=this._view.getVisibleAreaBounds(),r={x:e.pageX,y:e.pageY},i=e.target&&e.target.tagName!==undefined?e.target.tagName.toLowerCase():undefined,s=n(e.target);(!i||s.is("td.wijgridtd, th.wijgridtd, div.wijmo-wijgrid-innercell"))&&r.x>t.left&&r.x<t.left+t.width&&r.y>t.top&&r.y<t.top+t.height&&(this._attachAdditionalEvents(),this._startPos=r,this._startCellInfo=this._coordToDataCellInfo(this._startPos))},t.prototype._onDocumentMouseMove=function(t){if(!this._startCellInfo||!this._startCellInfo._isValid())return;var r={x:t.pageX,y:t.pageY},i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b=this._wijgrid._view(),w=this._wijgrid._rows(),E=e.grid.renderState;this._inProgress||(this._inProgress=Math.abs(this._startPos.x-r.x)>this._gap_to_start||Math.abs(this._startPos.y-r.y)>this._gap_to_start);if(this._inProgress){i=this._coordToDataCellInfo(r);if(!i._isValid())return;this._endCellInfo=i,o=new e.grid.cellInfoRange(this._startCellInfo,this._endCellInfo),o._normalize(),o._clip(this._wijgrid._getDataCellsRange());if(o._isValid()&&!o.isEqual(this._prevMouseMoveRange)){u=this._wijgrid._getDataToAbsOffset(),this._prevMouseMoveRange=o,a=new e.grid.cellInfoOrderedCollection(this._wijgrid),f=o.bottomRight().rowIndex(),l=o.bottomRight().cellIndex();for(c=o.topLeft().rowIndex();c<=f;c++){m=b._getRowInfo(w.item(c));if(m.type&e.grid.rowType.data)for(h=o.topLeft().cellIndex();h<=l;h++)a._appendUnsafe(new e.grid.cellInfo(h,c))}g=-1;for(p=0,d=this._addedCells.length();p<d;p++)s=this._addedCells.item(p),a.indexOf(s)<0&&(this._wijgrid.selection().selectedCells().indexOf(s)<0&&(h=this._view.getCell(s.cellIndex()+u.x,s.rowIndex()+u.y),h&&(g!==s.rowIndex()&&(m=s.row(),g=s.rowIndex()),v=n(h),y=b._changeCellRenderState(v,E.selected,!1),this._wijgrid.cellStyleFormatter.format(v,s.cellIndex(),s.column(),m,y))),this._addedCells._removeAt(p),p--,d--);g=-1;for(p=0,d=a.length();p<d;p++)s=a.item(p),this._addedCells.indexOf(s)<0&&this._wijgrid.selection().selectedCells().indexOf(s)<0&&this._addedCells._add(s)&&(h=this._view.getCell(s.cellIndex()+u.x,s.rowIndex()+u.y),h&&(g!==s.rowIndex()&&(m=s.row(),g=s.rowIndex()),v=n(h),y=b._changeCellRenderState(v,E.selected,!0),this._wijgrid.cellStyleFormatter.format(v,s.cellIndex(),s.column(),m,y)))}}},t.prototype._onDocumentMouseUp=function(t){this._detachAdditionalEvents();if(this._inProgress){this._inProgress=!1;if(this._prevMouseMoveRange&&this._prevMouseMoveRange._isValid()){this._wijgrid._changeCurrentCell(t,this._endCellInfo),(!t.shiftKey||!this._wijgrid.selection()._multipleRangesAllowed()&&this._wijgrid.options.selectionMode.toLowerCase()!=="singleRange")&&this._wijgrid.selection()._startNewTransaction(this._startCellInfo),this._wijgrid.selection().beginUpdate(),this._wijgrid.selection()._selectRange(this._prevMouseMoveRange,t.shiftKey,t.ctrlKey,0,this._endCellInfo),this._wijgrid.selection().endUpdate();var r=this._wijgrid._view(),i=this._wijgrid._getDataToAbsOffset(),s,o,u,a,f,l=-1,c,h,p=e.grid.renderState;for(s=0,o=this._addedCells.length();s<o;s++)u=this._addedCells.item(s),this._wijgrid.selection().selectedCells().indexOf(u)<0&&(a=r.getCell(u.cellIndex()+i.x,u.rowIndex()+i.y),a!==null&&(l!==u.rowIndex()&&(c=u.row(),l=u.rowIndex()),f=n(a),h=r._changeCellRenderState(f,p.selected,!1),this._wijgrid.cellStyleFormatter.format(f,u.cellIndex(),u.column(),c,h)));return this._addedCells._clear(),this._startCellInfo=this._endCellInfo=this._prevMouseMoveRange=null,!1}}},t.prototype._attachAdditionalEvents=function(){if(!this._additionalEventsAttached)try{this._view.toggleDOMSelection(!1),n(document).bind(this._eventKey("mousemove"),n.proxy(this._onDocumentMouseMove,this)).bind(this._eventKey("mouseup"),n.proxy(this._onDocumentMouseUp,this))}finally{this._additionalEventsAttached=!0}},t.prototype._detachAdditionalEvents=function(){if(this._additionalEventsAttached)try{this._view.toggleDOMSelection(!0),n(document).unbind(this._eventKey("mousemove"),this._onDocumentMouseMove).unbind(this._eventKey("mouseup"),this._onDocumentMouseUp)}finally{this._additionalEventsAttached=!1}},t.prototype._eventKey=function(t){return e.grid.stringFormat(this._evntFormat,t)},t.prototype._coordToDataCellInfo=function(t){var n=0,r=this._visLeavesLen-1,i=0,s=-1,o,u=new e.grid.rowAccessor(this._view,2,0,0),a,f,l,c;while(n<=r){i=(r-n>>1)+n,o=e.grid.bounds(this._view.getHeaderCell(i)),o||(f=u.item(0),o=e.grid.bounds(e.grid.rowAccessor.getCell(f,i)));if(!o)break;if(t.x<o.left)r=i-1;else{if(!(t.x>o.left+o.width)){s=i;break}n=i+1}}if(s===-1)return e.grid.cellInfo.outsideValue;u=new e.grid.rowAccessor(this._view,0,0,0),a=-1,n=0,r=u.length()-1,i=0;while(n<=r){i=(r-n>>1)+n,f=u.item(i),o=e.grid.bounds(e.grid.rowAccessor.getCell(f,0));if(t.y<o.top)r=i-1;else{if(!(t.y>o.top+o.height)){a=i;break}n=i+1}}return a===-1?e.grid.cellInfo.outsideValue:(l=this._wijgrid._getDataToAbsOffset(),c=new e.grid.cellInfo(s-l.x,a-l.y),c._clip(this._wijgrid._getDataCellsRange()),c)},t}();t.uiSelection=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){"use strict";var t=jQuery,n=function(){function e(e,t,n,r){this._view=e,this._scope=t,this._offsetBottom=r,this._offsetTop=n}return e.prototype.item=function(e){var t=this.length();return e<t?this._view.getJoinedRows(e+this._offsetTop,this._scope):null},e.prototype.length=function(){var e=this._view.getJoinedTables(!0,0),t=0,n;if(n=e[0])t=n.getSectionLength(this._scope);if(n=e[1])t+=n.getSectionLength(this._scope);return t-=this._offsetTop+this._offsetBottom,t<0&&(t=0),t},e.iterateCells=function(t,n,r){if(t&&n){var i=0,s,o,u,a,f,l;for(s=0,o=t.length;s<o;s++){u=t[s];if(u)for(a=0,f=u.cells.length;a<f;a++){l=n(u.cells[a],i++,r);if(l!==!0)return}}}},e.getCell=function(t,n){var r,i;if(t&&(r=t[0])){i=r.cells.length;if(n<i)return r.cells[n];n-=i;if(r=t[1]){i=r.cells.length;if(n<i)return r.cells[n]}}return null},e.cellsCount=function(t){var n=0,r;if(t&&(r=t[0])){n=r.cells.length;if(r=t[1])n+=r.cells.length}return n},e}();e.rowAccessor=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(){this._timeout=25}return t.prototype.currentCellEditStart=function(t,r){var i=!1,s=t.currentCell(),o=t._view(),u,a,f,l;if(s._isValid()&&!s._isEdit()&&s.column().dataIndex>=0){u=s.row();if(u){l=u.type;if(l&e.grid.rowType.data){a={cell:s,event:r,handled:!1};if(i=t._trigger("beforeCellEdit",null,a))a.handled||(i=this._defaultBeforeCellEdit(t,a));i&&(s._isEdit(!0),t.options.showRowHeader&&(f=n(u.$rows[0].cells[0]).children("div.wijmo-wijgrid-innercell"),f.length&&(f.empty(),f.append(n("<div>&nbsp;</div>").addClass(t.options.wijCSS.icon+" ui-icon-pencil")))))}}}return i},t.prototype.currentCellEditEnd=function(t,r){var i=t.currentCell(),s=!1,o=t._view(),u,a,f,l,c,h,p=e.grid.getKeyCodeEnum();if(!i._isValid()||!i._isEdit())return;u=i.row();if(u){a=u.type;if(!(a&e.grid.rowType.data))return s;f=r&&r.which===p.ESCAPE;if(!r||!f){var d={cell:i,value:undefined};if(s=t._trigger("beforeCellUpdate",null,d)){d.value===undefined&&(d.value=this._getCellValue(t,i)),l=d.value;try{d.value=t._parse(i.column(),d.value),l=d.value}catch(v){d.value=l}c=i.value(),e.grid.getDataType(d.cell.column())==="datetime"&&(l instanceof Date&&(l=l.getTime()),c instanceof Date&&(c=c.getTime()));if(l!==c){try{i.value(d.value)}catch(v){var m={cell:i,value:d.value};s=!1,t._trigger("invalidCellValue",null,m)}if(s){var g={cell:i};t._trigger("afterCellUpdate",null,g)}}}}else s=!0;if(s){var y={cell:i,event:r,handled:!1};t._trigger("afterCellEdit",null,y),y.handled||(s=this._defaultAfterCellEdit(t,y)),s&&i._isEdit(!1),t.options.showRowHeader&&n(u.$rows[0].cells[0]).children("div.wijmo-wijgrid-innercell").html("&nbsp;"),window.setTimeout(function(){t._destroyed||(i=t.currentCell(),(h=i.tableCell())?n(h).attr("tabIndex",0).focus():n(t._view().focusableElement()).focus())},this._timeout)}}return s},t.prototype._defaultBeforeCellEdit=function(t,r){var i=r.cell.column(),s=!1,o,u,a,f,l,c=e.grid.getKeyCodeEnum();if(i.dataIndex>=0){o=r.cell.value(),s=!0;try{u=r.cell.container();if(e.grid.getDataType(i)==="boolean")a=u.children("input"),a.focus(),r.event&&r.event.type==="keypress"&&a.one("keyup",function(e){e.which===c.SPACE&&(e.preventDefault(),a[0].checked=!o)});else{a=n("<input />").attr("type","text").addClass("wijgridinput wijmo-wijinput "+t.options.wijCSS.stateFocus).bind("keydown",t,n.proxy(this._checkBoxOrInputKeyDown,this)),a.bind(n.support.selectstart?"selectstart":"mousedown",function(e){e.stopPropagation()});if(r.event&&r.event.type==="keypress"&&r.event.which)a.val(String.fromCharCode(r.event.which));else switch(e.grid.getDataType(r.cell.column())){case"currency":case"number":if(o!==null){a.val(o);break};default:a.val(t._toStr(r.cell.column(),o))}u.empty().append(a),f=a.val().length,(new e.grid.domSelection(a[0])).setSelection({start:f,end:f}),a.focus(),setTimeout(function(){a.focus()},this._timeout*2)}}catch(h){alert(h.message),s=!1}}return s},t.prototype._defaultAfterCellEdit=function(t,n){var r=n.cell.column(),i=!1,s,o,u,a,f;if(r.dataIndex>=0){i=!0,f=t._view();try{s=n.cell.container(),o=t._toStr(r,n.cell.value()),a=f._getRowInfo(t._rows().item(n.cell.rowIndex())),e.grid.getDataType(r)==="boolean"?(u=s.children("input"),o==="true"?u.attr("checked","checked"):u.removeAttr("checked")):t.cellFormatter.format(s,r,o,a)}catch(l){alert("defaultAfterCellEdit: "+l.message),i=!1}}return i},t.prototype._checkBoxOrInputKeyDown=function(t){var n=e.grid.getKeyCodeEnum();if(t.which===n.ENTER){var r=t.data;if(r)return r._endEditInternal(t),!1}},t.prototype._getCellValue=function(e,t){var n=t.container().find(":input:first"),r=null;return n.length&&(r=n.attr("type")==="checkbox"?n[0].checked:n.val()),r},t}();t.cellEditorHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(){}return t._div=document.createElement("div"),t.prototype.format=function(t,r,i,s){s.type&e.grid.rowType.footer&&(r.aggregate&&r.aggregate!=="none"?i=e.grid.stringFormat(r.footerText||"{0}",r._totalsValue||""):i=r.footerText||r._footerTextDOM||"");var o=!0,u=null,a={$container:t,column:r,formattedValue:i,row:s,afterDefaultCallback:null},f;n.isFunction(r.cellFormatter)&&(o=!r.cellFormatter(a));if(o){switch(e.grid.getDataType(r)){case"boolean":u=this._boolFormatter;break;default:u=this._textFormatter}u&&(u.call(this,a),n.isFunction(f=a.afterDefaultCallback)&&f(a))}},t.prototype._textFormatter=function(t){var n;switch(t.row.type){case e.grid.rowType.filter:this._defFormatFilterCell(t);break;default:n=t.$container[0];if(n.firstChild)while(n.firstChild)n.removeChild(n.firstChild);e.grid.cellFormatterHelper._div.innerHTML=t.formattedValue||"&nbsp;";while(e.grid.cellFormatterHelper._div.firstChild)n.appendChild(e.grid.cellFormatterHelper._div.firstChild)}},t.prototype._boolFormatter=function(t){var n,r,i="disabled='disabled'",s,o,u=e.grid.rowType,a=e.grid.getKeyCodeEnum();switch(t.row.type){case u.data:case u.data|u.dataAlt:n=t.column.owner,r=n.options.allowEditing&&t.column.readOnly!==!0,r&&(i=""),n._parse(t.column,n._dataViewWrapper.getValue(t.row.data,t.column.dataKey))===!0?t.$container.html("<input class='wijgridinput' type='checkbox' checked='checked' "+i+" />"):t.$container.html("<input class='wijgridinput' type='checkbox' "+i+" />"),r&&t.$container.children("input").bind("mousedown",function(e){s=t.$container.parent()[0],o=n.currentCell(),o.tableCell()!==s&&n._onClick({target:s}),o._isEdit()||n.beginEdit()}).bind("keydown",function(e){if(e.which===a.ENTER)return n._endEditInternal(e),!1});break;default:this._textFormatter(t)}},t.prototype._defFormatFilterCell=function(e){var t=e.column.owner,n=t.options.wijCSS;e.$container.addClass(n.widget+" "+n.stateDefault),e.column.dataIndex>=0&&!e.column.isBand&&e.column.showFilter?e.$container.html('<div class="wijmo-wijgrid-filter '+n.cornerAll+'"><input type="text" class="wijmo-wijgrid-filter-input" style="width:100%" /><a class="wijmo-wijgrid-filter-trigger '+n.cornerRight+" "+n.stateDefault+'" href="#"><span class="'+n.icon+" "+n.iconArrowDown+'"></span></a></div>'):e.$container.html("&nbsp;")},t}();t.cellFormatterHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e){this._elements=[],this._gap=10,this._step=1,this._inProgress=!1,this._hoveredField=null,this._startLocation=null,this._lastLocation=null,this._proxy=null,this._wijgrid=e,this._evntFormat="{0}."+this._wijgrid.widgetName+".resizer"}return t.prototype.addElement=function(e){e&&e.element&&(e.element.bind(this._eventKey("mousemove"),n.proxy(this._onMouseMove,this)).bind(this._eventKey("mousedown"),n.proxy(this._onMouseDown,this)).bind(this._eventKey("mouseout"),n.proxy(this._onMouseOut,this)),this._elements.push(e))},t.prototype.dispose=function(){var e=this;n.each(this._elements,function(t,n){n.element.unbind(e._eventKey("mousemove"),e._onMouseMove).unbind(e._eventKey("mousedown"),e._onMouseDown).unbind(e._eventKey("mouseout"),e._onMouseOut)}),this._detachDocEvents()},t.prototype.inProgress=function(){return this._inProgress},t.prototype._onMouseMove=function(e){if(!this._inProgress){var t=this._getFieldByPos({x:e.pageX,y:e.pageY});t&&t._canSize()&&this._wijgrid._canInteract()?(t.element.css("cursor","e-resize"),this._hoveredField=t,e.stopPropagation()):this._onMouseOut(e)}},t.prototype._onMouseOut=function(e){this._inProgress||this._hoveredField&&(this._hoveredField.element.css("cursor",""),this._hoveredField=null)},t.prototype._onMouseDown=function(t){this._hoveredField=this._getFieldByPos({x:t.pageX,y:t.pageY});if(this._hoveredField&&this._hoveredField._canSize()&&this._wijgrid._canInteract())try{this._hoveredField.element.css("cursor",""),this._docCursor=document.body.style.cursor,document.body.style.cursor="e-resize",this._startLocation=this._lastLocation=e.grid.bounds(this._hoveredField.element),this._proxy=n('<div class="wijmo-wijgrid-resizehandle '+this._wijgrid.options.wijCSS.stateHightlight+'">&nbsp;</div>');var r=this._wijgrid._view().getVisibleAreaBounds();this._proxy.css({left:t.pageX,top:this._startLocation.top,height:r.height+r.top-this._startLocation.top}),n(document.body).append(this._proxy)}finally{this._attachDocEvents(),this._inProgress=!0,t.stopPropagation()}},t.prototype._onDocumentMouseMove=function(e){var t=this._step*Math.round((e.pageX-this._lastLocation.left)/this._step);this._lastLocation={left:this._lastLocation.left+t,top:e.pageY,width:undefined,height:undefined},this._proxy.css("left",this._lastLocation.left)},t.prototype._onDocumentMouseUp=function(e){try{document.body.style.cursor=this._docCursor,this._proxy.remove(),this._startLocation!==this._lastLocation&&this._wijgrid._fieldResized(this._hoveredField,this._startLocation.width,this._lastLocation.left-this._startLocation.left)}finally{this._hoveredField=null,this._proxy=null,this._detachDocEvents(),this._inProgress=!1}},t.prototype._onSelectStart=function(e){e.preventDefault()},t.prototype._attachDocEvents=function(){this._inProgress||(n(document).bind(this._eventKey("mousemove"),n.proxy(this._onDocumentMouseMove,this)).bind(this._eventKey("mouseup"),n.proxy(this._onDocumentMouseUp,this)),n.fn.disableSelection&&n(document.body).disableSelection(),"onselectstart"in document&&n(document.body).bind("selectstart",this._onSelectStart))},t.prototype._detachDocEvents=function(){this._inProgress&&(n(document).unbind(this._eventKey("mousemove"),this._onDocumentMouseMove).unbind(this._eventKey("mouseup"),this._onDocumentMouseUp),n.fn.enableSelection&&n(document.body).enableSelection(),"onselectstart"in document&&n(document.body).unbind("selectstart",this._onSelectStart))},t.prototype._getFieldByPos=function(t){var n,r,i,s,o;for(n=0,r=this._elements.length;n<r;n++){i=this._elements[n],s=e.grid.bounds(i.element),o=e.grid.isOver(t.y,t.x,s.top,s.left+s.width-this._gap,s.height,this._gap);if(o)return i}return null},t.prototype._eventKey=function(t){return e.grid.stringFormat(this._evntFormat,t)},t}();t.uiResizer=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(t){this._scope_guid="scope_"+e.grid.getUID(),this._dragEnd=!1,this._wijgrid=t,this._wijCSS=this._wijgrid.options.wijCSS,this._wrapHtml='<div class="'+this._wijCSS.widget+" wijmo-wijgrid "+this._wijCSS.content+" "+this._wijCSS.cornerAll+'">'+'<table class="wijmo-wijgrid-root wijmo-wijgrid-table">'+'<tr class="wijmo-wijgrid-headerrow">'+"</tr>"+"</table>"+"</div>"}return t.prototype.attachGroupArea=function(e){var t,r=this;if(!n.ui.droppable||!n.ui.draggable)return;e.droppable({scope:this._scope_guid,tolerance:"pointer",greedy:!0,accept:function(e){if(r._wijgrid.options.allowColMoving){t=r._getWijFieldInstance(e);if(t)return t instanceof n.wijmo.c1groupedfield&&t.options.groupedIndex===r._wijgrid._field("groupedColumns").length-1?!1:!t.options.isBand&&(t.options.groupedIndex===undefined||t instanceof n.wijmo.c1groupedfield)}return!1},drop:function(e,n){!r._isInElement(e,n.draggable)&&(t=r._getWijFieldInstance(n.draggable))&&(r._dragEnd=!0)},over:function(t,n){var i=r._wijgrid._field("groupedWidgets").length;r._dropTargetRedirected=i>0,r._droppableWijField=i>0?r._wijgrid._field("groupedWidgets")[i-1]:e,e.data("thisDroppableWijField",r._droppableWijField)},out:function(t,n){r._droppableWijField===e.data("thisDroppableWijField")&&(r._droppableWijField=null)}})},t.prototype.attach=function(t){var r,i,s=this;if(!n.ui.droppable||!n.ui.draggable)return;if(!t||!(r=t.element))return;r.draggable({helper:function(e){return t instanceof n.wijmo.c1groupedfield?r.clone().addClass("wijmo-wijgrid-dnd-helper"):r.clone().wrap(s._wrapHtml).width(r.width()).height(r.height()).closest(".wijmo-wijgrid").addClass("wijmo-wijgrid-dnd-helper")},appendTo:"body",scope:s._scope_guid,drag:function(e,n){s._hideArrows();if(s._droppableWijField&&!s._isInElement(e,r)){var i=s._droppableWijField.element;i||(i=s._droppableWijField),s._showArrows(i,s._getPosition(t,s._droppableWijField,e,n))}},start:function(r,i){if(s._wijgrid._canInteract()&&s._wijgrid.options.allowColMoving&&!s._wijgrid._field("resizer").inProgress()){var o=t.options,u=t.options.travIdx,a=t instanceof n.wijmo.c1groupedfield,f=a?"groupArea":"columns";a&&(o=e.grid.search(s._wijgrid.columns(),function(e){return e.options.travIdx===u}),o=o.found?o.found.options:e.grid.getColumnByTravIdx(s._wijgrid.options.columns,u).found);if(t._canDrag()&&s._wijgrid._trigger("columnDragging",null,{drag:o,dragSource:f}))return s._wijgrid._trigger("columnDragged",null,{drag:o,dragSource:f}),!0}return!1},stop:function(e,r){s._hideArrows();try{s._dragEnd&&(s._droppableWijField.element?s._wijgrid._handleDragnDrop(t.options.travIdx,s._droppableWijField.options.travIdx,s._getPosition(t,s._droppableWijField,e,r),t instanceof n.wijmo.c1groupedfield,s._droppableWijField instanceof n.wijmo.c1groupedfield):s._wijgrid._handleDragnDrop(t.options.travIdx,-1,"left",t instanceof n.wijmo.c1groupedfield,!0))}finally{s._droppableWijField=null,s._dragEnd=!1}}}).droppable({hoverClass:s._wijCSS.stateHover,scope:s._scope_guid,tolerance:"pointer",greedy:!0,accept:function(e){if(s._wijgrid.options.allowColMoving&&r[0]!==e[0]){i=s._getWijFieldInstance(e);if(i)return i._canDropTo(t)}return!1},drop:function(e,t){if(i=s._getWijFieldInstance(t.draggable))s._dragEnd=!0},over:function(e,n){s._dropTargetRedirected=!1,s._droppableWijField=t,r.data("thisDroppableWijField",s._droppableWijField)},out:function(e,n){s._droppableWijField===t.element.data("thisDroppableWijField")&&(s._droppableWijField=null)}})},t.prototype.detach=function(e){var t;e&&(t=e.element)&&(t.data("ui-draggable")&&t.draggable("destroy"),t.data("ui-droppable")&&t.droppable("destroy"))},t.prototype.dispose=function(){this._$topArrow&&(this._$topArrow.remove(),this._$topArrow=null),this._$bottomArrow&&(this._$bottomArrow.remove(),this._$bottomArrow=null)},t.prototype._getWijFieldInstance=function(t){var n=e.grid.widgetName(t);if(!n)throw"widgetName is undedined";return t.data(n)},t.prototype._showArrows=function(e,t){this._topArrow().show().position({my:"center",at:t+" top",of:e,collision:"none"}),this._bottomArrow().show().position({my:"center",at:t+" bottom",of:e,collision:"none"})},t.prototype._hideArrows=function(){this._topArrow().hide(),this._bottomArrow().hide()},t.prototype._topArrow=function(){return this._$topArrow||(this._$topArrow=n("<div />").addClass("wijmo-wijgrid-dnd-arrow-top").append(n("<span />").addClass(this._wijCSS.icon+" ui-icon-arrowthick-1-s")).hide().appendTo(document.body)),this._$topArrow},t.prototype._bottomArrow=function(){return this._$bottomArrow||(this._$bottomArrow=n("<div />").addClass("wijmo-wijgrid-dnd-arrow-bottom").append(n("<span />").addClass(this._wijCSS.icon+" ui-icon-arrowthick-1-n")).hide().appendTo(document.body)),this._$bottomArrow},t.prototype._isInElement=function(t,n){var r=e.grid.bounds(n,!1);return t.pageX>r.left&&t.pageX<r.left+r.width&&t.pageY>r.top&&t.pageY<r.top+r.height},t.prototype._getPosition=function(t,r,i,s){if(!r.element)return"left";if(this._dropTargetRedirected)return"right";var o=e.grid.bounds(r.element,!1),u=o.width/6,a=o.left+o.width/2,f="right",l;return i.pageX<a&&(f="left"),r instanceof n.wijmo.c1groupedfield?(t instanceof n.wijmo.c1groupedfield&&(l=r.options.groupedIndex-t.options.groupedIndex,Math.abs(l)===1&&(f=l<0?"left":"right")),f):(l=r.options.linearIdx-t.options.linearIdx,r.options.isBand&&t.options.parentIdx!==r.options.travIdx&&Math.abs(i.pageX-a)<u?"center":(t.options.parentIdx===r.options.parentIdx&&Math.abs(l)===1&&(f=l<0?"left":"right"),f))},t}();t.uiDragndrop=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e){if(!e)throw"invalid arguments";this._wijgrid=e}return t.prototype.format=function(t,r,i,s,o,u,a){var f=e.grid.renderState,l=e.grid.rowType,c=s.type,h,p=null;r===0&&this._wijgrid.options.showRowHeader&&(i=null);if(c===l.groupHeader||c===l.groupFooter)i=null,u&&(p=u.groupInfo)&&(i=this._wijgrid._field("leaves")[p.leafIndex],delete u.groupInfo);h={$cell:t,state:o,row:s,column:i,_cellIndex:r,_purpose:p?p.purpose:undefined},o===f.rendering?this._renderingStateFormatter(h,u,a):(this._currentStateFormatter(h,o&f.current),this._selectedStateFormatter(h,o&f.selected)),n.isFunction(this._wijgrid.options.cellStyleFormatter)&&this._wijgrid.options.cellStyleFormatter(h)},t.prototype._renderingStateFormatter=function(t,n,r){var i=e.grid.rowType,s,o,u=t.column,a=t.row.type;switch(a){case i.header:t.$cell.addClass("wijgridth");break;default:t.$cell.addClass("wijgridtd")}if(a&i.data&&u&&u.textAlignment)switch(u.textAlignment.toLowerCase()){case"left":t.$cell.addClass("wijalign-left");break;case"right":t.$cell.addClass("wijalign-right");break;case"center":t.$cell.addClass("wijalign-center")}if(n)for(s in n)if(n.hasOwnProperty(s)){o=n[s];if(!(s!=="colSpan"&&s!=="rowSpan"||o>1))continue;s==="class"?t.$cell.addClass(o):t.$cell.attr(s,o)}if(r)for(s in r)if(r.hasOwnProperty(s)){if(s==="paddingLeft"){t.$cell.children(".wijmo-wijgrid-innercell").css(s,r[s]);continue}t.$cell.css(s,r[s])}if(t._cellIndex===0&&this._wijgrid.options.showRowHeader)t.$cell.attr({role:"rowheader",scope:"row"}).addClass(this._wijgrid.options.wijCSS.stateDefault+" "+this._wijgrid.options.wijCSS.content+" wijmo-wijgrid-rowheader");else switch(a){case i.header:t.$cell.attr({role:"columnheader",scope:"col"});break;case i.footer:t.$cell.attr({role:"columnfooter",scope:"col"});break;default:t.$cell.attr("role","gridcell")}a&i.data&&t._cellIndex>=0&&u&&(t.$cell.attr("headers",window.escape(u.headerText)),u.readOnly&&t.$cell.attr("aria-readonly",!0),u.dataIndex>=0&&t.$cell.addClass("wijdata-type-"+e.grid.getDataType(u))),(a===i.groupHeader||a===i.groupFooter)&&u&&t._purpose===e.grid.groupRowCellPurpose.aggregateCell&&t.$cell.addClass("wijdata-type-"+e.grid.getDataType(u))},t.prototype._currentStateFormatter=function(t,n){var r=e.grid.rowType;n?(t.$cell.addClass(this._wijgrid.options.wijCSS.stateActive),t.row.type===r.header?t.$cell.addClass("wijmo-wijgrid-current-headercell"):t.$cell.addClass("wijmo-wijgrid-current-cell")):(t.$cell.removeClass(this._wijgrid.options.wijCSS.stateActive),t.row.type===r.header?t.$cell.removeClass("wijmo-wijgrid-current-headercell"):t.$cell.removeClass("wijmo-wijgrid-current-cell"))},t.prototype._hoveredStateFormatter=function(e,t){t},t.prototype._selectedStateFormatter=function(e,t){t?e.$cell.addClass(this._wijgrid.options.wijCSS.stateHightlight).attr("aria-selected","true"):e.$cell.removeClass(this._wijgrid.options.wijCSS.stateHightlight).removeAttr("aria-selected")},t}();t.cellStyleFormatterHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e){if(!e)throw"invalid arguments";this._wijgrid=e}return t.prototype.format=function(t,r,i){var s=e.grid.renderState,o=e.grid.rowType,u=t.state,a=t;u===s.rendering?this._renderingStateFormatter(a,r,i):(this._currentStateFormatter(a,(u&s.current)!==0),this._hoveredStateFormatter(a,(u&s.hovered)!==0),this._selectedStateFormatter(a,(u&s.selected)!==0)),n.isFunction(this._wijgrid.options.rowStyleFormatter)&&this._wijgrid.options.rowStyleFormatter(a)},t.prototype._renderingStateFormatter=function(t,r,i){var s="wijmo-wijgrid-row "+this._wijgrid.options.wijCSS.content,o="wijmo-wijgrid-row "+this._wijgrid.options.wijCSS.content,u=e.grid.rowType,a;t.$rows.attr("role","row");if(r)for(a in r)r.hasOwnProperty(a)&&(a==="class"?t.$rows.addClass(r[a]):(t.$rows.attr(a,r[a]),t.$rows[0].style.height&&t.$rows.each(function(){return n.data(this,"customHeight",this.style.height),!0})));if(i)for(a in i)i.hasOwnProperty(a)&&t.$rows.css(a,i[a]);switch(t.type&~u.dataAlt){case u.header:s="wijmo-wijgrid-headerrow";break;case u.data:s=o+" wijmo-wijgrid-datarow",t.type&u.dataAlt&&(s+=" wijmo-wijgrid-alternatingrow");break;case u.emptyDataRow:s=o+" wijmo-wijgrid-emptydatarow";break;case u.filter:s="wijmo-wijgrid-filterrow";break;case u.groupHeader:s=o+" wijmo-wijgrid-groupheaderrow";break;case u.groupFooter:s=o+" wijmo-wijgrid-groupfooterrow";break;case u.footer:s="wijmo-wijgrid-footerrow "+this._wijgrid.options.wijCSS.stateHightlight;break;default:throw e.grid.stringFormat("unknown rowType: {0}",t.type)}t.$rows.addClass(s)},t.prototype._currentStateFormatter=function(e,t){this._wijgrid.options.showRowHeader&&(t?n(e.$rows[0].cells[0]).addClass(this._wijgrid.options.wijCSS.stateActive+" wijmo-wijgrid-current-rowheadercell"):n(e.$rows[0].cells[0]).removeClass(this._wijgrid.options.wijCSS.stateActive+" wijmo-wijgrid-current-rowheadercell"))},t.prototype._hoveredStateFormatter=function(e,t){t?e.$rows.addClass(this._wijgrid.options.wijCSS.stateHover):e.$rows.removeClass(this._wijgrid.options.wijCSS.stateHover)},t.prototype._selectedStateFormatter=function(e,t){t},t}();t.rowStyleFormatterHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){"use strict";var t=jQuery,n=function(){function e(){this._sum=0,this._sum2=0,this._cntNumbers=0,this._cntStrings=0,this._cntDates=0,this._max=0,this._min=0,this._minDate=0,this._maxDate=0}return e.prototype.add=function(e){if(e===null||e==="")return;var t,n=e instanceof Date?"datetime":typeof e;t=e.toString(),this._cntStrings++===0&&(this._minString=this._maxString=t),t<this._minString&&(this._minString=t),t>this._maxString&&(this._maxString=t),n==="number"?(this._cntNumbers++===0&&(this._min=this._max=e),this._sum+=e,this._sum2+=e*e,e<this._min&&(this._min=e),e>this._max&&(this._max=e)):n==="datetime"&&(t=e.getTime(),this._cntDates++===0&&(this._minDate=this._maxDate=t),t<this._minDate&&(this._minDate=t),t>this._maxDate&&(this._maxDate=t))},e.prototype.getValueString=function(e){var t=e.owner;if(!this._cntNumbers||e.dataType!=="number"&&e.dataType!=="currency"){if(this._cntDates&&e.dataType==="datetime")switch(e.aggregate){case"max":return t._toStr(e,new Date(this._maxDate));case"min":return t._toStr(e,new Date(this._minDate));case"count":return this._cntStrings+""}if(this._cntStrings)switch(e.aggregate){case"max":return this._maxString;case"min":return this._minString;case"count":return this._cntStrings+""}return""}var n=this._getValue(e.aggregate);return t._toStr(e,n)},e.prototype._getValue=function(e){switch(e){case"average":return this._cntNumbers===0?0:this._sum/this._cntNumbers;case"count":return this._cntStrings;case"max":return this._max;case"min":return this._min;case"sum":return this._sum;case"std":if(this._cntNumbers<=1)return 0;return Math.sqrt(this._getValue("var"));case"stdPop":if(this._cntNumbers<=1)return 0;return Math.sqrt(this._getValue("varPop"));case"var":if(this._cntNumbers<=1)return 0;return this._getValue("varPop")*this._cntNumbers/(this._cntNumbers-1);case"vapPop":if(this._cntNumbers<=1)return 0;var t=this._sum/this._cntNumbers;return this._sum2/this._cntNumbers-t*t}return 0},e}();e.tally=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(t){this._docEventsUID="wijgridfrozener"+e.grid.getUID(),this._docEventsAttached=!1,this._newStaticIndex=-1,this._staticColumnIndex=-1,this._staticRowIndex=-1,this._staticOffsetH=0,this._staticOffsetV=0,this._inProgress=!1,this._wijgrid=t,this.refresh()}return t.prototype.inProgress=function(){return this._inProgress},t.prototype.refresh=function(){this.dispose(),this._$outerDiv=this._wijgrid.outerDiv.find(".wijmo-wijgrid-fixedview"),this._superPanel=this._wijgrid._view()._getSuperPanel(),this._staticOffsetH=this._wijgrid._getStaticOffsetIndex(!1),this._staticOffsetV=this._wijgrid._getStaticOffsetIndex(!0),this._staticColumnIndex=this._wijgrid._getStaticIndex(!1),this._staticRowIndex=this._wijgrid._getStaticIndex(!0),this._visibleBounds=this._wijgrid._view().getVisibleAreaBounds();var t=e.grid.bounds(this._$outerDiv.find(".wijmo-wijgrid-split-area-nw")),n=e.grid.bounds(this._$outerDiv);this._createVBar(this._visibleBounds,t,n),this._createHBar(this._visibleBounds,t,n)},t.prototype.dispose=function(){this._$hBar&&(this._$hBar.remove(),this._$hBar=null),this._$vBar&&(this._$vBar.remove(),this._$vBar=null),this._$proxy&&(this._$proxy.remove(),this._$proxy=null),this._$outerDiv=null,this._superPanel=null,this._detachDocEvents()},t.prototype._createVBar=function(e,t,r){var i=t.width+t.left,s=this;i<=e.left+e.width&&(this._$vBar=n("<div><div></div></div>").addClass("wijmo-wijgrid-frozener-v").css({left:i-r.left,top:t.top-r.top,height:e.height+e.top-t.top}).bind("mousedown",function(e){e.data=!0,s._onBarMouseDown.apply(s,arguments)}).appendTo(this._$outerDiv),this._$vBar.find("div").addClass(this._wijgrid.options.wijCSS.header).css({width:0,height:"100%"}))},t.prototype._createHBar=function(e,t,r){var i=t.top+t.height,s=this;i<=e.top+e.height&&(this._$hBar=n("<div><div></div></div>").addClass("wijmo-wijgrid-frozener-h").css({left:t.left-r.left,top:i-r.top,width:e.width+e.left-t.left}).bind("mousedown",function(e){e.data=!1,s._onBarMouseDown.apply(s,arguments)}).appendTo(this._$outerDiv),this._$hBar.find("div").addClass(this._wijgrid.options.wijCSS.header).css({width:"100%",height:0}))},t.prototype._onBarMouseDown=function(e){this._visibleBounds=this._wijgrid._view().getVisibleAreaBounds(),this._newStaticIndex=e.data?this._staticColumnIndex:this._staticRowIndex,this._$proxy=n('<div class="wijmo-wijgrid-resizehandle '+this._wijgrid.options.wijCSS.header+'"></div>').appendTo(document.body),this._attachDocEvents(e.data),this._inProgress=!0,e.stopPropagation()},t.prototype._onDocumentMouseMove=function(e){e.data&&this._superPanel.options.hScroller.scrollValue?this._superPanel.hScrollTo(0):!e.data&&this._superPanel.options.vScroller.scrollValue&&this._superPanel.vScrollTo(0),this._showPosition(e)},t.prototype._onDocumentMouseUp=function(e){try{this._$proxy&&this._$proxy.remove(),this._detachDocEvents(),e.data?this._newStaticIndex!==this._staticColumnIndex&&this._wijgrid.option("staticColumnIndex",this._newStaticIndex):this._newStaticIndex!==this._staticRowIndex&&this._wijgrid.option("staticRowIndex",this._newStaticIndex)}finally{this._$proxy=null,this._inProgress=!1}},t.prototype._attachDocEvents=function(e){if(!this._docEventsAttached)try{n.fn.disableSelection&&n(document.body).disableSelection(),this._wijgrid._view().toggleDOMSelection(!1),n(document).bind(this._docEventKey("mousemove"),e,n.proxy(this._onDocumentMouseMove,this)).bind(this._docEventKey("mouseup"),e,n.proxy(this._onDocumentMouseUp,this))}finally{this._docEventsAttached=!0}},t.prototype._detachDocEvents=function(){if(this._docEventsAttached)try{n.fn.enableSelection&&n(document.body).enableSelection(),this._wijgrid._view().toggleDOMSelection(!0),n(document).unbind("."+this._docEventsUID)}finally{this._docEventsAttached=!1}},t.prototype._docEventKey=function(t){return e.grid.stringFormat("{0}.{1}",t,this._docEventsUID)},t.prototype._showPosition=function(t){var n,r,i,s,o,u,a,f;if(t.data){f=e.grid.bounds(this._$vBar);if(Math.abs(t.pageX-(f.left+f.width/2))<f.width){this._$proxy.hide();return}if(n=this._getFieldByPos({x:t.pageX,y:t.pageY})){r=e.grid.bounds(n.element),i=r.left+r.width/2,s=n.options.visLeavesIdx-this._staticOffsetV,o=Math.max(s-1,-1),u=t.pageX<i?o!==this._staticColumnIndex:s===this._staticColumnIndex,a=u?r.left:r.left+r.width;if(!e.grid.isOverAxis(a,this._visibleBounds.left-1,this._visibleBounds.width+2))return;this._newStaticIndex=u?o:s,this._$proxy.show().css({left:a,top:r.top,width:3,height:this._visibleBounds.height+this._visibleBounds.top-r.top})}}else{f=e.grid.bounds(this._$hBar);if(Math.abs(t.pageY-(f.top+f.height/2))<f.height){this._$proxy.hide();return}if(n=this._getRowByPos({x:t.pageX,y:t.pageY})){r=e.grid.bounds(n),i=r.top+r.height/2,s=this._wijgrid._view().getAbsoluteRowIndex(n)-this._staticOffsetH,o=Math.max(s-1,-1),u=t.pageY<i?o!==this._staticRowIndex:s===this._staticRowIndex,a=u?r.top:r.top+r.height;if(!e.grid.isOverAxis(a,this._visibleBounds.top-1,this._visibleBounds.height+2))return;this._newStaticIndex=u?o:s,this._$proxy.show().css({left:r.left,top:a,width:this._visibleBounds.width+this._visibleBounds.left-r.left,height:3})}}},t.prototype._getFieldByPos=function(t){var n=this._wijgrid.columns(),r,i,s,o,u;for(r=0,i=n.length;r<i;r++){s=n[r],o=s.options;if(o.isLeaf){u=e.grid.bounds(s.element);if(e.grid.isOverAxis(t.x,u.left,u.width))return s}}return null},t.prototype._getRowByPos=function(t){var r=this._wijgrid._rows(),i,s,o,u;for(i=0,s=r.length();i<s;i++){o=r.item(i)[0],u=e.grid.bounds(n(o));if(e.grid.isOverAxis(t.y,u.top,u.height))return o}return null},t}();t.uiFrozener=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(){}return t.generate=function(r,i,s){switch(r){case"append":t._processAppendMode(i,s);break;case"merge":t._processMergeMode(i,s);break;case"none":break;default:throw e.grid.stringFormat('Unsupported value: "{0}"',r)}},t._processAppendMode=function(i,s){var o={};e.grid.traverse(s,function(t){t.dynamic&&e.grid.validDataKey(t.dataKey)&&(o[t.dataKey]=!0)}),n.each(i,function(e,n){if("name"in n&&!o[n.name]){var r=t._createAutoField(n);s.push(r)}})},t._processMergeMode=function(i,s){var o=[],u;e.grid.traverse(s,function(t){if(t.isLeaf&&!t.isBand){var n=t.dataKey;e.grid.validDataKey(n)?i[n]!==undefined&&delete i[n]:n!==null&&o.push(t)}}),o.length&&(u=0,n.each(i,function(e,t){var n=o[u++];n&&(n.dataKey=t.name,delete i[e])})),n.each(i,function(e,n){var r=t._createAutoField(n);s.push(r)})},t._createAutoField=function(n){return e.grid.createDynamicField({dataKey:n.name})},t}();t.columnsGenerator=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){"use strict";var t=jQuery,n=function(){function e(e,t,n){this._timer=0,this._timeout=50,this._ignoreScrollEvents=!1,this._wijgrid=e,this._fixedAreaHeight=n,this._view=this._wijgrid._view(),this._N=this._wijgrid._totalRowsCount();var r=20,i=this._wijgrid.outerDiv.height()+this._N*r;t.height(i-n-(this._N>0?r:0)),this._view._splitAreas.sw.height(i)}return e.prototype.attach=function(e){this._$scroller=e,this._panelInst=e.data("wijmo-wijsuperpanel");var n,r=e.find(".wijmo-wijsuperpanel-contentwrapper:first"),i=this._panelInst.getContentElement().height(),s=this._fixedAreaHeight+i,o=r.innerHeight(),u=101/(this._N-1)*((s-o)/s);n=this._panelInst.options.vScroller,n.scrollSmallChange=u,this._panelInst.option("vScroller",n),e.bind("wijsuperpanelscrolled.wijgrid",t.proxy(this._onSuperpanelScrolled,this)),e.bind("wijsuperpanelscrolling.wijgrid",t.proxy(this._onSuperpanelScrolling,this)),e.bind("wijsuperpanelscrolled.wijgrid",t.proxy(this._onSuperpanelPostScrolled,this))},e.prototype.dispose=function(){this._$scroller.unbind(".wijgrid"),this._clearTimer()},e.prototype._clearTimer=function(){window.clearTimeout(this._timer),this._timer=0},e.prototype._onSuperpanelScrolling=function(e,t){if(this._ignoreScrollEvents||t.dir!=="v")return;if(this._timer===-1)return!1},e.prototype._onSuperpanelScrolled=function(e,n){var r=this;if(this._ignoreScrollEvents||n.dir!=="v")return;this._timer>0&&this._clearTimer(),this._timer!==-1&&(this._timer=window.setTimeout(function(){r._timer=-1;var e=Math.round(n.newValue/r._panelInst.options.vScroller.scrollSmallChange),i=r._view._bounds.start;e<0&&(e=0),e>=r._N&&(e=r._N-1),e!==i?r._wijgrid._handleVirtualScrolling(e,t.proxy(r._scrollingCompleted,r)):(r._log(),r._clearTimer())},this._timeout))},e.prototype._scrollingCompleted=function(e){this._wijgrid._trackScrollingIndex(e),this._log(),this._clearTimer()},e.prototype._onSuperpanelPostScrolled=function(){t.isFunction(this._postScrolled)&&this._postScrolled.apply(this,arguments)},e.prototype._log=function(){},e}();e.uiVirtualScroller=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){function r(n,r,i,s){function u(t){return s.parser=s.parser||e.defaultParsers[t],!s.parser&&n!=null&&e.errors.noParser(t),s.parser}var o=n;s=t.extend({nullString:"",format:""},s),r=r||n!=null&&typeof n,i=i||r;if(!i)return n;if(i=="string")return u(r),s.parser?s.parser.toStr(n,s.culture,s.format,s.nullString,!0):n;u(i);if(!s.parser)return n;n=s.parser.parse(n,s.culture,s.format,s.nullString,!0);if(isNaN(n)&&n!=null&&e.util.isNumeric(n)){if(s.ignoreError)return o;e.errors.cantConvert(i,o)}return n}function i(t){return function(){return n||e.util.logError(e.errors.noGlobalize.create().message),t.apply(this,arguments)}}var t=jQuery,n=Globalize;e.convert=r,e.defaultParsers={string:{parse:function(e,t,n,r,i){switch(e){case null:return null;case r:if(i)return null;case undefined:case"&nbsp":return"";default:return""+e}},toStr:function(e,t,n,r,i){return e===null&&i?r:""+e}},number:{parse:function(e,t,r,i,s){var o=typeof e;return o==="number"?isNaN(e)?NaN:e:!e&&e!==0||e==="&nbsp;"||e===i&&s?null:n.parseFloat(e,10,t.name)},toStr:function(e,t,r,i,s){return e===null&&s?i:n.format(e,r?r:"n",t.name)}},currency:{parse:function(e,t,r,i,s){var o=typeof e;return o==="number"?isNaN(e)?NaN:e:!e&&e!==0||e==="&nbsp;"||e===i&&s?null:(o==="string"&&(e=e.replace(t.numberFormat.currency.symbol,"")),n.parseFloat(e,10,t.name))},toStr:function(e,t,r,i,s){return e===null&&s?i:n.format(e,r?r:"c",t.name)}},datetime:{parse:function(e,t,r,i,s){var o;if(e instanceof Date)return e;if(!e||e==="&nbsp;"||e===i&&s)return null;o=/^\/Date\((\d+)\)\/$/.exec(e);if(o)return new Date(parseInt(o[1],10));var u=n.parseDate(e,r,t.name);if(u==null||isNaN(u))u=Date.parse(e),u=isNaN(u)?NaN:new Date(u);return u},toStr:function(e,t,r,i,s){return e===null&&s?i:n.format(e,r?r:"d",t.name)}},"boolean":{parse:function(e,n,r,i,s){var o=typeof e;if(o==="number")return e!=0;if(o==="boolean")return e;o==="string"&&(e=t.trim(e));if(!e||e==="&nbsp;"||e===i&&s)return null;switch(e.toLowerCase()){case"true":return!0;case"false":return!1}return NaN},toStr:function(e,t,n,r,i){return e===null&&i?r:e?"true":"false"}}},t.each(e.defaultParsers,function(e,t){t.parse=t.parse&&i(t.parse),t.toStr=t.toStr&&i(t.toStr)})})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){(function(t){(function(n){function r(r){function i(r){var s=[];if(r.length===0)return s;var o=n.Connective.AND;return e.util.each(r,function(r,u){if(r==0&&e.util.isString(u)){var a=u.toLowerCase();if(a==n.Connective.AND||a==n.Connective.OR){o=a;return}}if($.isArray(u)){u=i(u);if(!u)return;if(u[0]===o||u.length==2){u.shift(),s=s.concat(u);return}}else{var f=t.normalizeCondition(u);if(!f)return;f.property=u.property,u=f}s.push(u)}),s.length==0?null:(s.unshift(o),s)}return i(r)}function i(t){if(!$.isArray(t))return null;var i={original:t,normalized:r(t),func:null};return i.normalized==null?i.func=function(e){return!0}:i.func=function(t){function r(i){var s=i[0]===n.Connective.AND,o=s?e.util.every:e.util.some;return o(i,function(n,i){if(i===0)return s;if($.isArray(n))return r(n);var o=e.util.getProperty(t,n.property);return n.op.apply(o,n.value)})}return r(i.normalized)},i}function s(t){return i(t)||e.filtering.compile(t)}n.Connective={AND:"and",OR:"or"},n.compile=s})(t.extended||(t.extended={}));var n=t.extended})(e.filtering||(e.filtering={}));var t=e.filtering})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=e.data,i=r.filtering.extended,s=function(){function e(e){this.real=e,this._updatingFilter=!1,this._overrideFilter(),this._makeMemberProxies()}return e.prototype._overrideFilter=function(){var e=this;this.filter=r.observable(this.real.filter()),this.filter.subscribe(function(t){e.real.filter()!==t&&!e._updatingFilter&&e.refresh({filter:t})}),this.real.filter.subscribe(function(t){t!==e._lastSetFilter&&e.filter(t)})},e.prototype.refresh=function(e,t){typeof t=="undefined"&&(t=!1),e=n.extend({},e);var r=e.filter;e.filter=this._coerceFilter(e.filter),this._lastSetFilter=e.filter,this._updatingFilter=!0;try{n.isFunction(e.filter)&&!n.isFunction(r)?this.filter(r):this.filter(e.filter)}finally{this._updatingFilter=!1}return this.real.refresh(e,t)},e.prototype._makeMemberProxies=function(){var e=this;r.util.each(this.real,function(t,r){if(!n.isFunction(r)||e[t]||t.charAt(0)==="_")return;e[t]=n.isFunction(r.subscribe)?r:function(){return r.apply(e.real,arguments)}})},e.create=function(n){return new e(n)},e.prototype._convertComplexPropertyFilterToExtendedFilterFormat=function(e){var t=[];return n.each(e,function(e,s){if(!n.isArray(s))s=[s];else{var o=r.util.isString(s[0])&&s[0].toLowerCase();if(o===i.Connective.AND||o===i.Connective.OR){t.push(s);return}}var u=[];n.each(s,function(t,n){var i=r.filtering.normalizeCondition(n);i&&(i.property=e,u.push(i))}),u.length>0&&t.push(u)}),t.length>0?t:null},e.prototype._coerceFilter=function(e){if(n.isArray(e))return i.compile(e).func;if(!n.isPlainObject(e))return e;e=n.extend(!0,{},e);var t={};n.each(e,function(i,s){n.isArray(s)||(s=[s]);if(t){var o=r.util.isString(s[0])&&s[0].toLowerCase();if(s.length==1||s.length==2&&(o==="and"||o==="or")){t[i]=s[s.length-1];return}}e[i]=s,t=null});if(t)return t;var s=this._convertComplexPropertyFilterToExtendedFilterFormat(e);return i.compile(s).func},e.prototype._unsafeReplace=function(e,t){this.real.sourceArray[e]=t,this.real.local[e]=t},e.prototype._unsafeSplice=function(e,t,n){arguments.length===2?(this.real.sourceArray.splice(e,t),this.real.local.splice(e,t)):(this.real.sourceArray.splice(e,t,n),this.real.local.splice(e,t,n))},e.prototype._unsafePush=function(e){this.real.sourceArray.push(e),this.real.local.push(e)},e}();t.GridDataView=s})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));